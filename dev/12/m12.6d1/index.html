<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d1 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li class="current"><a class="toctext" href>m12.6d1</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d1</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d1.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d1</span><a class="fa fa-bars" href="#"></a></div></header><div><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre></div><p>New col logpop, set log() for population data</p><div><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table></div><p>Define problem data structure</p><div><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre></div><p>Make the type callable with the parameters <em>as a single argument</em>.</p><div><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre></div><p>Instantiate the model with data and inits.</p><div><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d1.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre></div><p>Function convert from a single vector of parms to parks NamedTuple</p><div><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre></div><p>Define input parameter vector</p><div><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-4503.683062254508</code></pre></div><p>Maximum<em>a</em>posterior</p><div><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0694723537859547,0.26588218793421325, ...]
 * Minimum: -1.368163e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false
     |x - x&#39;| = 4.25e-10
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -8.61e-07 |f(x)|
   * |g(x)| ≤ 1.0e-08: false
     |g(x)| = 2.78e+05
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 862438102
 * Gradient Calls: 862438102</code></pre></div><p>Minimum gives MAP estimate:</p><div><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0694723537859547
  0.26588218793421325
  7.921831814325835e-14
 -1.6017823104568156e-14
  3.051967681997099e-14
 -1.8932854458000237e-13
 -1.1791380126427693e-14
  1.8022986472175003e-13
 -7.723119242300777e-14
  1.249742429732203e-13
 -1.8556782415118137e-13
  9.535034411197301e-13
  7.21844215781809e-5</code></pre></div><p>Write a function to return properly dimensioned transformation.</p><div><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre></div><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><div><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre></div><p>Tune and sample.</p><div><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">MCMC, adapting ϵ (75 steps)
0.0047 s/step ...done
MCMC, adapting ϵ (25 steps)
0.0054 s/step ...done
MCMC, adapting ϵ (50 steps)
0.0046 s/step ...done
MCMC, adapting ϵ (100 steps)
0.0027 s/step ...done
MCMC, adapting ϵ (200 steps)
0.0013 s/step ...done
MCMC, adapting ϵ (400 steps)
0.00079 s/step ...done
MCMC, adapting ϵ (50 steps)
0.0015 s/step ...done
MCMC (1000 steps)
0.00078 s/step ...done
(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.242462979076345, 0.23995896954766313, -0.12400843667385034, -0.0616515375621142, 0.005182634322909411, 0.1802098707491274, 0.03903790820539195, -0.39610317702829695, 0.07893514788117315, 0.007702275467071071, 0.24362720996752799, 0.03853379890669285, -0.43981898983250983], -38.30258422585719, 4, DynamicHMC.DoubledTurn, 0.8818759203748817, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5325395695602748, 0.20262837171380416, -0.027408886470120665, 0.08759057064204792, -0.15191804809192377, 0.35805166250955184, -0.14442509617856727, -0.10126524785163091, 0.19669874547717278, -0.3436111727476088, 0.3314640949746695, 0.15572274201438183, -0.4618182729156563], -39.186704118370194, 4, DynamicHMC.DoubledTurn, 0.9355212993627475, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3308443632336802, 0.2416477107712665, -0.5441222805443632, 0.05980145934910922, -0.2675050348235359, 0.14797356664057051, 0.08589322202670671, -0.2475591693220865, 0.0902134063693957, -0.11590625553391967, 0.1251736078714562, -0.19720392184869315, -0.4913430459986644], -40.416220188522615, 4, DynamicHMC.DoubledTurn, 0.9617518865541667, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9598739112140461, 0.25077699998445085, 0.22274396076567865, 0.01292178354846759, 0.07188138696539619, 0.6007449984090688, 0.07356054899960618, -0.1298112198864896, 0.2797938062124898, 0.02963303736495888, 0.5261582899430519, 0.23633782298007064, -0.5904247699788062], -43.29687743281427, 4, DynamicHMC.DoubledTurn, 0.989043348369876, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4083656269944405, 0.22996869998956637, -0.013923507772012206, 0.06059354001097555, -0.18517130507701304, 0.2558317133249177, 0.03674954034380416, -0.06766230927216833, 0.02038334931703021, 0.0398537786382655, 0.3145472891302072, -0.10640378095601334, -0.41889498084936677], -41.167047685439705, 4, DynamicHMC.DoubledTurn, 0.9838365696401162, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0072334587743341, 0.2714753106669664, -0.36674204006544997, -0.09065269910094108, 0.17780625581572185, 0.41028806218052344, -0.03314378640399506, -0.700222688500425, 0.2680330327605909, -0.2201692534668353, 0.36592491069350874, -0.10861321439826642, -0.6164139998281417], -43.71780490792576, 4, DynamicHMC.DoubledTurn, 0.9100004034827087, 15), NUTS_Transition{Array{Float64,1},Float64}([1.236234872063007, 0.24994374538417855, -0.43983200695795105, -0.08554288631677494, -0.16038825948484997, 0.6698936899150769, -0.22406828399968884, -0.5682184420578253, 0.26845658008152445, -0.24026515840065665, 0.23777593908198846, -0.009244061504004692, -0.5175463742088864], -47.01217545532208, 4, DynamicHMC.DoubledTurn, 0.9159970717893204, 15), NUTS_Transition{Array{Float64,1},Float64}([0.26577931649762865, 0.3539776803118061, -0.2170048388270338, -0.1541816386758758, -0.05424035521477827, 0.13821029307155605, 0.08773290987753593, -0.074220666927039, 0.35366410332116827, -0.16254117565846193, 0.23367948156147586, -0.4396537773695689, -0.49254339270791747], -45.65004156847908, 4, DynamicHMC.DoubledTurn, 0.9299974759394103, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6800319894596203, 0.1873243418114848, -0.21411014183596946, 0.5215858299470282, 0.17517281021825254, 0.6175993556033375, 0.06909207586434338, -0.3127936424326136, 0.006403159583005639, -0.1472215956715604, 0.38078254712700454, 0.27825937348293894, -0.6175402700161999], -47.16966316877809, 4, DynamicHMC.DoubledTurn, 0.9569436002232343, 15), NUTS_Transition{Array{Float64,1},Float64}([1.348454166050368, 0.23706032163038576, -0.03236403336815978, 0.052288161506705344, -0.16961666685645999, 0.024091560535202047, -0.18755088863000458, -0.3345131821988206, -0.01839545720641903, -0.33094106029043147, 0.15974516654081905, 0.06715212757675994, -0.4171763268141337], -48.904893424553805, 4, DynamicHMC.DoubledTurn, 0.9734257048931669, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.1594655447738684, 0.21351542713277422, -0.14782365643072415, 0.3900544097431491, -0.04098981437865213, 0.6878864170364519, 0.5246740977353076, -0.7236780573557102, 0.3821120193593339, 0.22164973028274948, 0.431971461835765, 0.5137041955452317, -0.7446614675031078], -57.41570255992156, 4, DynamicHMC.DoubledTurn, 0.9507075911492432, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5382700652507029, 0.20670087765498354, 0.22302330937411485, 0.04807525437006981, 0.10192045692820875, 0.3745921745423881, -0.1472864612588826, -0.055144125072685804, 0.5622332727671813, -0.16457829121359902, 0.6017558263962804, 0.11119517974093279, -0.5502770342639045], -55.43688450613193, 4, DynamicHMC.DoubledTurn, 0.9504966272967675, 15), NUTS_Transition{Array{Float64,1},Float64}([2.460536959408281, 0.12057248682076858, -0.4941478891626184, -0.17963575355541098, 0.1613377120465984, 0.128600741329701, 0.14054371563141252, -0.02002807617857015, 0.13526118117277897, -0.2345416707799515, 0.3409695594898146, 0.30282091797019495, -0.6609564392264993], -56.1021119973541, 4, DynamicHMC.AdjacentTurn, 0.9545453593179487, 31), NUTS_Transition{Array{Float64,1},Float64}([2.9923019566731255, 0.05573827369247577, -0.6345975816286065, -0.41599931628345715, -0.03153613754386751, 0.019638731891409744, 0.11833464776574301, -0.23263141560096495, 0.07093170978316893, -0.08445241652521884, 0.19029021818686803, 0.25443889091912386, -0.5820333603233888], -47.69789577219323, 4, DynamicHMC.DoubledTurn, 0.9910826060062696, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.2756816811100667, 0.4026718204357777, 0.09461806853969511, 0.36425897506997323, -0.06416601783479157, 0.5554674277930453, -0.07488264495310551, -0.4568899935869027, 0.2115163853427929, -0.27462228547640094, 0.3389819204246938, -0.29823390896402957, -0.5158723304174195], -44.96167999077315, 4, DynamicHMC.DoubledTurn, 0.9884234998861406, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5955288747009695, 0.2139178281123335, -0.23845182858013717, -0.07852528338004906, 0.09728684483005354, 0.48041262067029916, 0.24177935994026345, -0.45103156918124304, -0.08510522778125587, -0.2908065348708305, 0.2157099314901475, -0.056350622259159905, -0.5582820064616513], -45.91123770349929, 4, DynamicHMC.DoubledTurn, 0.9150663544137144, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2411763800430822, 0.2306436311368091, -0.14516894408983888, 0.21500553606632553, -0.27304249083690096, 0.21083314173789786, -0.1661942190126509, -0.20465969913345355, 0.43998486207277787, -0.07024423548799255, 0.44888653130369605, 0.18050085035629482, -0.4284804142962013], -42.68355600085588, 4, DynamicHMC.DoubledTurn, 0.8853266030979854, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0963095087607249, 0.24877366121719044, -0.020009909493031032, -0.3596792600287074, 0.07427134173305908, 0.45756906507799633, 0.11727444189964266, -0.07240299321615346, 0.1207515324982141, -0.15823216570221263, 0.4940604719689979, -0.03280601978346025, -0.5858837754948965], -46.88255931179001, 4, DynamicHMC.DoubledTurn, 0.9993136993854831, 15), NUTS_Transition{Array{Float64,1},Float64}([1.373940528490327, 0.23135791323154983, -0.10022027239443519, -0.40174824460219655, 0.003473297509139023, 0.3624748521822716, -0.015551628617484756, -0.1417176739958161, 0.13234233784056498, -0.13349312991288942, 0.4300274765906148, 0.1139264175004014, -0.6211986142582111], -43.83048950140615, 4, DynamicHMC.DoubledTurn, 0.9861727541048564, 15), NUTS_Transition{Array{Float64,1},Float64}([1.294150180478316, 0.2510606006378056, -0.5236572857624365, 0.19869819831110733, -0.12206594542639532, 0.2836808348115926, 0.12511639887051565, -0.6793990482171239, 0.2488214762114821, -0.31452786563247076, 0.15186832031296005, -0.08483503730117195, -0.6806179875568934], -46.675434987000315, 4, DynamicHMC.AdjacentTurn, 0.9884086409768724, 31)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.242
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.695182107206593, 0.0773463369911053, 0.21914033995431306, 0.204910342224753, 0.17796217366801267, 0.18480465265372534, 0.15948202912997703, 0.18034249690291948, 0.15381739633458966, 0.15096877530699976, 0.1603875450915347, 0.263189340750678, 0.10127882527126972]
)</code></pre></div><p>We use the transformation to obtain the posterior from the chain.</p><div><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.242462979076345, 0.23995896954766313, -0.12400843667385034, -0.0616515375621142, 0.005182634322909411, 0.1802098707491274, 0.03903790820539195, -0.39610317702829695, 0.07893514788117315, 0.007702275467071071, 0.24362720996752799, 0.03853379890669285, -0.43981898983250983]
 [1.5325395695602748, 0.20262837171380416, -0.027408886470120665, 0.08759057064204792, -0.15191804809192377, 0.35805166250955184, -0.14442509617856727, -0.10126524785163091, 0.19669874547717278, -0.3436111727476088, 0.3314640949746695, 0.15572274201438183, -0.4618182729156563]
 [1.3308443632336802, 0.2416477107712665, -0.5441222805443632, 0.05980145934910922, -0.2675050348235359, 0.14797356664057051, 0.08589322202670671, -0.2475591693220865, 0.0902134063693957, -0.11590625553391967, 0.1251736078714562, -0.19720392184869315, -0.4913430459986644]
 [0.9598739112140461, 0.25077699998445085, 0.22274396076567865, 0.01292178354846759, 0.07188138696539619, 0.6007449984090688, 0.07356054899960618, -0.1298112198864896, 0.2797938062124898, 0.02963303736495888, 0.5261582899430519, 0.23633782298007064, -0.5904247699788062]
 [1.4083656269944405, 0.22996869998956637, -0.013923507772012206, 0.06059354001097555, -0.18517130507701304, 0.2558317133249177, 0.03674954034380416, -0.06766230927216833, 0.02038334931703021, 0.0398537786382655, 0.3145472891302072, -0.10640378095601334, -0.41889498084936677]</code></pre></div><p>Extract the parameter posterior means.</p><div><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2756313801341251</code></pre></div><p>Effective sample sizes (of untransformed draws)</p><div><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 975.229  966.226  589.054  1000.0  …  615.024  848.593  922.032  432.423</code></pre></div><p>NUTS-specific statistics</p><div><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.93, min/25%/median/75%/max: 0.0 0.91 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 6% DoubledTurn =&gt; 94%
  depth: 2 =&gt; 0% 3 =&gt; 6% 4 =&gt; 93% 5 =&gt; 0%</code></pre></div><p>CmdStan result</p><div><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre></div><p>Show means</p><div><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.125324939722616, 0.2588141072771125]
  [-0.19587573921282955, 0.03343716681059556, -0.04997407408408561, 0.3043779722074072, 0.036202833718541744, -0.3103253843649015, 0.13679676085358497, -0.1692313919680519, 0.26020670620414954, -0.0900997789613935]
 0.2756313801341251</code></pre></div><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d/"><span class="direction">Previous</span><span class="title">m12.6d</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
