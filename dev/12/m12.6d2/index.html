<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-3116.974265922246</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0837555200603723,0.2644472124225001, ...]
 * Minimum: -1.521317e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 1.76e-12 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -6.33e-09 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 6.01e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 895392514
 * Gradient Calls: 895392514</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0837555200603723    
  0.2644472124225001    
  1.877849224016873e-14 
 -3.1026368139633903e-15
  7.904851383234347e-15 
 -4.25632567509203e-14  
 -1.3436534500350475e-15
  4.2939683907156465e-14
 -1.616881095590049e-14 
  3.0891626523538974e-14
 -3.9925862062594674e-14
  3.3558929536386556e-13
  3.363022369748269e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.3635618269063856, 0.2469590031077662, -0.28710803745954394, -0.17062443611434014, -0.25443746202566364, 0.5435782782824038, -0.06758280122223433, -0.5988140807513405, 0.28152215780433376, -0.17460942533077203, 0.2749082129864183, -0.23087332433753524, -0.6276736317996483], -47.02512336660945, 4, DynamicHMC.AdjacentTurn, 0.897626020970189, 31), NUTS_Transition{Array{Float64,1},Float64}([1.0502010077558879, 0.2554981383666795, -0.022188046694449445, 0.02890197786646067, 0.2863196780314338, 0.09088583190084007, 0.035989871246109174, -0.1592911625526131, -0.21247904386659047, -0.10549929109496975, 0.33833470855636383, 0.049486733708890215, -0.4258812308397897], -45.6878097589745, 4, DynamicHMC.DoubledTurn, 0.9987583739601235, 15), NUTS_Transition{Array{Float64,1},Float64}([0.337020042939908, 0.32632427394637625, 0.007934407445334975, 0.05540523808808552, -0.0708196767091339, 0.4032273525965682, 0.26025086477369874, -0.3267602345351101, 0.1856417450671258, -0.18539606824276203, 0.27690718399685643, -0.34682767521063107, -0.6663543824247563], -48.6574300625379, 4, DynamicHMC.DoubledTurn, 0.7741845062138163, 15), NUTS_Transition{Array{Float64,1},Float64}([1.220036311578114, 0.2670259127484721, -0.05732419080442483, 0.10884135877579644, -0.24434977316318107, 0.33893844419512204, 0.11501438866555122, -0.1670949003019887, 0.048994429411912135, -0.1544620900661586, 0.15738131551521428, -0.10665565517922208, -0.553548962752026], -44.472762511473505, 4, DynamicHMC.DoubledTurn, 0.9911574883354926, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4406819650625502, 0.23935647534823393, -0.1362940709977215, 0.13455704514205782, -0.42640910287639144, 0.29289738028197365, 0.04071915903023444, -0.41617814549843696, -0.040252136020630096, -0.2720757197713918, 0.08872079981271067, -0.1875755071807661, -0.5789777573646633], -47.49919290747683, 4, DynamicHMC.DoubledTurn, 0.9962685600472803, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1335122065972705, 0.2604897683358252, -0.3088577276574446, -0.0895477706673079, -0.1991747372939019, 0.06513713097257447, -0.012091252942687617, -0.353459598588532, 0.1613972227908287, -0.2515173250427317, 0.24306016568906133, -0.03803089406098331, -0.4345057593957169], -40.096485624305096, 4, DynamicHMC.DoubledTurn, 0.9709044346446546, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8873487945560781, 0.2893977726043618, -0.1837075892067539, -0.13130722634941, -0.16507330142160356, 0.3428912157686237, 0.15468558124301537, -0.29008293846749544, 0.13375539305471637, -0.38064727155055905, 0.2003480951040025, -0.10489978538968422, -0.5693769038016242], -43.30912427890745, 3, DynamicHMC.DoubledTurn, 0.8264191351104236, 7), NUTS_Transition{Array{Float64,1},Float64}([1.4623815192789722, 0.21671051254818843, -0.08949644990742799, 0.003997398316811385, -8.008569986113837e-5, 0.3807979588188436, -0.02203676404395903, -0.18217643767545755, 0.08435157260298153, 0.12049385598857036, 0.3856486097049034, -0.04226324099586303, -0.3835342293415293], -41.731024403389576, 4, DynamicHMC.DoubledTurn, 0.9216318010287138, 15), NUTS_Transition{Array{Float64,1},Float64}([1.371471894540131, 0.24706880360677486, -0.3328185552972788, 0.06979637602398676, -0.3832634416891467, 0.1530283736217118, 0.17570860035948133, -0.3575525760384054, 0.18494759864151716, -0.5521685157746989, 0.1738668185535569, -0.26195611801693375, -0.7196588056264841], -46.17682555193536, 4, DynamicHMC.DoubledTurn, 0.9135723074864102, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6615072899825658, 0.3357915333065055, -0.2720435983063296, 0.15721307104824814, -0.3884399070572955, 0.013034765142844913, -0.1192529631057605, -0.43559239931235666, -0.02542421163333294, -0.44840242297406707, 0.24611461258662898, -0.601613740279909, -0.4642010934321908], -46.71554796968658, 4, DynamicHMC.DoubledTurn, 0.9743256086227026, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.10170382625019056, 0.3805623039125784, -0.06915508302838581, 0.3788896292973074, 0.10062928929746028, 0.2587640937118041, 0.1711589382005453, -0.7108566126939934, 0.2137771250125725, -0.2980519043686242, 0.22641123607979408, -0.6271002697908854, -0.5156031948030032], -46.818312343104374, 5, DynamicHMC.DoubledTurn, 0.9558694499044436, 31), NUTS_Transition{Array{Float64,1},Float64}([0.4090817782449127, 0.33972146288191496, 0.11700102157952078, 0.2928045133939071, 0.04229874038128237, 0.35101025360184535, 0.14339944342166194, -0.8816168408904859, 0.12337090054926286, -0.2249897611827325, 0.217333504373121, -0.4959333252940269, -0.5476877026368595], -46.35750825345116, 4, DynamicHMC.AdjacentTurn, 0.9985042132364905, 31), NUTS_Transition{Array{Float64,1},Float64}([0.6331252624410436, 0.3309836078361474, 0.08241165677115342, 0.09564058498751357, -0.11518607121816891, 0.2567242898850066, 0.009273967687874241, -0.6972294102218605, 0.13272987354172108, -0.10834664366581509, -0.04133586628470155, -0.5169918433002425, -0.4656813443124788], -48.4465460362616, 4, DynamicHMC.AdjacentTurn, 0.9250109593772923, 31), NUTS_Transition{Array{Float64,1},Float64}([1.4178644325520922, 0.22194424833782797, -0.23145942900618846, 0.11123720748417533, -0.2924768572700362, 0.3159645543607036, 0.040795202964388724, 0.027838056386046084, 0.3660049024524824, -0.2598947152805671, 0.4996701209851001, 0.24493587309894804, -0.5311695621776228], -43.71014915729344, 4, DynamicHMC.DoubledTurn, 0.9718721074394713, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7614137602533613, 0.2015702704698369, -0.412663409267251, 0.08132127283226277, -0.1929819427995773, 0.2187039104939744, 0.04526991688434935, -0.3725386662083891, 0.31370857974418964, -0.3356461992576268, 0.32802219151340145, 0.1462831792518358, -0.5097423700732355], -42.97609611588606, 4, DynamicHMC.DoubledTurn, 0.9516077589438928, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8359836012645236, 0.291986868032691, -0.295555669530289, 0.07059047241505423, -0.006476287720348209, 0.33230036538991437, 0.013319648752435584, -0.5673811435727726, -0.11414227085005152, -0.2342218635383549, 0.20465927383370736, -0.39048433978839914, -0.5429829600717389], -42.543399518739136, 4, DynamicHMC.DoubledTurn, 0.9975619736685196, 15), NUTS_Transition{Array{Float64,1},Float64}([2.1859508001208825, 0.1686736074386239, -0.2429346423720943, -0.0329007686198014, -0.06340960623106846, 0.060888045531370866, -0.07127580876215667, -0.5021075511413498, 0.06971746238125762, -0.2185483224402726, -0.0076919866219885965, 0.12206790889387294, -0.40456535027315715], -45.90263139077843, 4, DynamicHMC.DoubledTurn, 0.9687737468196517, 15), NUTS_Transition{Array{Float64,1},Float64}([1.25898894726856, 0.24011104573495426, -0.13026660717890826, 0.1725540959330486, 0.11955820577018461, 0.3790417957162393, -0.0386876101222494, -0.30798181949908293, 0.009470473782036404, -0.2238781185049584, 0.2754733124944635, -0.0680318710461351, -0.44776903770608933], -50.072349014289045, 4, DynamicHMC.DoubledTurn, 0.9784727725738213, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0396592948761265, 0.27278999044153357, -0.11983494359174363, -0.13670641725386995, -0.21539336965880843, 0.11117292621181, 0.13468885642189657, -0.09851861302488694, 0.20200753642470207, -0.10485857918779516, 0.1535172142549696, -0.08210745017527679, -0.41718490320185186], -36.532149815638284, 4, DynamicHMC.DoubledTurn, 0.9989743382416202, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9313172728258552, 0.27429709802025204, -0.25620023981870277, -0.11455129784798733, 0.01956516203096225, 0.3054557022299118, 0.20707920532209825, -0.18123007750240358, 0.1783651065379828, -0.004947890853679877, 0.34748128179503457, -0.12383912291272736, -0.4117912090630616], -42.728663746228264, 4, DynamicHMC.DoubledTurn, 0.9214357410475464, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.201
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6913974926547577, 0.07606266684357045, 0.2189176586693921, 0.21851042668918186, 0.18169503164424458, 0.18116162084508114, 0.16453805986785816, 0.2082273764512627, 0.15812829394928665, 0.1997100359407351, 0.15837905576034184, 0.26016850779941597, 0.10689084129387534]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.3635618269063856, 0.2469590031077662, -0.28710803745954394, -0.17062443611434014, -0.25443746202566364, 0.5435782782824038, -0.06758280122223433, -0.5988140807513405, 0.28152215780433376, -0.17460942533077203, 0.2749082129864183, -0.23087332433753524, -0.6276736317996483] 
 [1.0502010077558879, 0.2554981383666795, -0.022188046694449445, 0.02890197786646067, 0.2863196780314338, 0.09088583190084007, 0.035989871246109174, -0.1592911625526131, -0.21247904386659047, -0.10549929109496975, 0.33833470855636383, 0.049486733708890215, -0.4258812308397897]
 [0.337020042939908, 0.32632427394637625, 0.007934407445334975, 0.05540523808808552, -0.0708196767091339, 0.4032273525965682, 0.26025086477369874, -0.3267602345351101, 0.1856417450671258, -0.18539606824276203, 0.27690718399685643, -0.34682767521063107, -0.6663543824247563]    
 [1.220036311578114, 0.2670259127484721, -0.05732419080442483, 0.10884135877579644, -0.24434977316318107, 0.33893844419512204, 0.11501438866555122, -0.1670949003019887, 0.048994429411912135, -0.1544620900661586, 0.15738131551521428, -0.10665565517922208, -0.553548962752026]   
 [1.4406819650625502, 0.23935647534823393, -0.1362940709977215, 0.13455704514205782, -0.42640910287639144, 0.29289738028197365, 0.04071915903023444, -0.41617814549843696, -0.040252136020630096, -0.2720757197713918, 0.08872079981271067, -0.1875755071807661, -0.5789777573646633]</code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2726582304428871</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 579.02  566.135  689.695  735.949  …  814.419  604.097  575.081  184.228</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.95, min/25%/median/75%/max: 0.54 0.94 0.98 0.99 1.0
  termination: AdjacentTurn =&gt; 15% DoubledTurn =&gt; 85%
  depth: 2 =&gt; 0% 3 =&gt; 5% 4 =&gt; 88% 5 =&gt; 7%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1242537769994052, 0.25850962232577923]                                                                                                                                                                            
  [-0.1826212408626519, 0.04692993285635929, -0.05004985848423112, 0.30477023115319496, 0.03813234251032429, -0.30278791809052363, 0.1432145258762379, -0.15694672064071863, 0.26013635315787026, -0.08218745867886165]
 0.2726582304428871                                                                                                                                                                                                    </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
