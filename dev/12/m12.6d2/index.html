<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-2738.9124575582136</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0875025839222758,0.2640726293287544, ...]
 * Minimum: -1.302558e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 2.17e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -3.44e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 1.99e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 652459158
 * Gradient Calls: 652459158</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0875025839222758    
  0.2640726293287544    
 -7.336428058959761e-14 
  1.163209721849211e-14 
 -3.1328734936015667e-14
  1.6469786849939424e-13
  4.238062758094678e-15 
 -1.6793424462730067e-13
  6.166199321289281e-14 
 -1.2169939634250706e-13
  1.5295892515670243e-13
 -1.4489232698190335e-12
  0.00010045550754704159</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.20377670788354, 0.2537491174149102, -0.4306556415155863, -0.46008416291895055, -0.2175942436302974, 0.03094064348731472, -0.02315015783919238, -0.5586045215469938, 0.5642934053176023, -0.09396653345650675, 0.4197142471143717, -0.4290746405924671, 0.6045909443048653], -52.79178230092313, 4, DynamicHMC.DoubledTurn, 0.9968518617424028, 15), NUTS_Transition{Array{Float64,1},Float64}([0.17246977396904886, 0.3578129215465899, -0.27237571850934184, 0.2776377061268023, 0.2081169492181817, 0.28659587586650603, 0.25821319885167915, 0.10897471560349034, 0.19230725047115815, -0.2119939936522291, 0.21546405341259575, -0.27654297488195523, 0.5764246012991868], -56.19632610643607, 4, DynamicHMC.DoubledTurn, 0.9958743544132372, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8577218999136407, 0.18879986481887442, 0.11319275980286209, -0.1799892799378639, -0.3030593382237829, 0.3195637831971947, 0.10055917570742116, -0.5814798316503523, 0.09493127740866356, -0.22948840038429513, 0.29045118374006235, 0.001817450898953743, 0.44490391737581697], -46.15261394562146, 4, DynamicHMC.DoubledTurn, 0.8875046836594119, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8755476041810888, 0.16158275776997674, -0.34880021411584144, 0.15364244322916248, -0.022976490322447557, 0.29782176571684305, 0.1676964829084657, -0.47586112943967734, 0.27955165368823476, -0.07708494340064301, 0.5511824609697903, 0.25247111877518524, 0.6182209570202964], -47.9285809385685, 3, DynamicHMC.DoubledTurn, 0.7096233840233682, 7), NUTS_Transition{Array{Float64,1},Float64}([1.9668364775173546, 0.1659074668024268, -0.15755104701595787, -0.22775301414679328, -0.0649071633169382, 0.2772452554030576, -0.1320167493598434, -0.38842389340910705, 0.2838538514927352, -0.17043140086956143, 0.09326294416440249, 0.23296471935293653, 0.4808873160256997], -41.684477308075685, 4, DynamicHMC.DoubledTurn, 0.7771153113391992, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.10700873200979315, 0.39011528049410066, -0.19233255675685051, 0.33444497404215273, -0.091714362007569, 0.36010225687187036, 0.2728478493915118, -0.4065351929239084, -0.10390335499795239, -0.12576814422918262, 0.4105778321393827, -0.5353970845005304, 0.5523472993993287], -43.67816970469888, 4, DynamicHMC.DoubledTurn, 0.9587785686388912, 15), NUTS_Transition{Array{Float64,1},Float64}([2.418587132993839, 0.10779014249696799, -0.6738829127329914, 0.1066858523896099, 0.051262219248720736, 0.25155443912463477, 0.0917732827009445, -0.3036570961127535, 0.16433064371454395, -0.17691647853697984, 0.5230830429430532, 0.6900177101834944, 0.7290625653492299], -49.45396979925023, 4, DynamicHMC.DoubledTurn, 0.856854113814471, 15), NUTS_Transition{Array{Float64,1},Float64}([2.3695643986013253, 0.10492649926684364, -0.8503235005631022, 0.22343702378787014, -0.013567771530180694, 0.23230872768230645, 0.13353227909034035, -0.2223076794944933, 0.04212154935057363, -0.2430215114355377, 0.4308345360553753, 0.6733483598878844, 0.6793638733119189], -48.60527903320208, 4, DynamicHMC.DoubledTurn, 0.9617829658668721, 15), NUTS_Transition{Array{Float64,1},Float64}([2.352384194045149, 0.11686555923816527, -0.4539945598057414, 0.06517447274288915, -0.21089277478947172, 0.19170899594904575, -0.024881359738926516, -0.28445130638380567, 0.15496756118957694, -0.151838933559734, 0.36565557115726993, 0.7362393528523958, 0.554090309234189], -51.50536963600673, 4, DynamicHMC.DoubledTurn, 0.8283567778732749, 15), NUTS_Transition{Array{Float64,1},Float64}([2.491738291631024, 0.10510183666516022, -0.7591733136952838, -0.32696040726108777, -0.1682034587543473, 0.15158676962686116, -0.10934657608335388, -0.36991995156160673, 0.14836681086398812, -0.39317946633817424, 0.548705600550459, 0.5445461137949692, 0.6559873723358848], -51.56689457411994, 4, DynamicHMC.DoubledTurn, 0.7655858151727192, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.3330899083918095, 0.25405869980395995, -0.38948681223052034, 0.04265110350248823, 0.15081419751180014, 0.4881086742481492, -0.200858375625201, -0.13034503101155875, -0.0688794563600332, -0.37177264530294046, 0.10219039833858243, -0.22613860570365493, 0.4880369748749245], -47.39574792843805, 4, DynamicHMC.DoubledTurn, 0.8224726564683031, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6358080191074402, 0.30383242691322865, -0.016910857829141784, 0.22838248160158903, -0.19757225732856962, 0.09965859419769325, 0.2226201545631597, -0.48904623656553475, 0.2611994801303971, -0.1896633283104288, 0.39508592125425707, 0.06486350296231991, 0.4729719048553989], -48.2379346440333, 4, DynamicHMC.DoubledTurn, 0.7365838568205495, 15), NUTS_Transition{Array{Float64,1},Float64}([1.014346835077932, 0.25863928674387016, -0.16983693609724804, 0.2896022754646426, -0.23289048159408002, 0.6192082490305613, 0.32235177986341085, -0.3889799836869494, 0.3649115659729841, 0.00016456056557203474, 0.36938745401002754, 0.02707346509883743, 0.7048202534780462], -45.0493958386847, 4, DynamicHMC.DoubledTurn, 0.9910448302030013, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9906546016999355, 0.2665926445261624, -0.1006267126019891, -0.12411381941263741, 0.22634707663274076, 0.18942406415765103, -0.051553466258653244, -0.10694995328491164, 0.06101487951315667, -0.10960755523064178, 0.2263663576378268, 0.00541219997100803, 0.3898272194897528], -41.9159215228391, 4, DynamicHMC.DoubledTurn, 0.9035367972514887, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5442238359728855, 0.32453699448434736, 0.04170110864025048, -0.17258843032711885, 0.08652068518916056, 0.0470727553204602, 0.09690044909281613, -0.1223261424500616, -0.024491034484998883, -0.09395813251291915, 0.09085749201314072, -0.13469567725634982, 0.33925310960652716], -45.161021497718, 3, DynamicHMC.DoubledTurn, 0.6611947355939929, 7), NUTS_Transition{Array{Float64,1},Float64}([0.5500018616754129, 0.31796439637580265, -0.1493501834261159, -0.04621880468439246, -0.09640652553772118, 0.048885948086438036, 0.09822752277798147, -0.25995628224511036, 0.04695659969912659, -0.06678618604939612, 0.1758657107968953, -0.10449916292731509, 0.3481114368220438], -38.40906328720116, 3, DynamicHMC.AdjacentTurn, 0.9659651203568108, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8827673169220431, 0.28427679566603387, -0.014175899606846627, 0.07023029731262312, -0.05797396854846133, 0.1851305014066499, 0.10339309757092334, -0.17655710907346397, 0.1573263905856674, -0.1748013238851433, 0.2966236005517508, -0.1533339865904661, 0.4503523872680108], -37.75556041747771, 4, DynamicHMC.DoubledTurn, 0.7529772730716697, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0194624220582635, 0.2715733700709531, -0.09548543681715838, -0.04069388756461245, 0.006854712208220579, 0.1717085317244331, -0.0407635593714676, -0.16010970064276542, 0.018292264728360763, -0.06047579366280127, -0.01909156553211227, -0.09563772414750052, 0.29442390597136475], -35.24353569975519, 4, DynamicHMC.DoubledTurn, 0.8974891648520696, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6169158431031287, 0.22029446761628965, 0.0031541148267959515, 0.038458184308316296, -0.0889043077228302, -0.09949765136027924, -0.02710161346517875, 0.007529900875093299, 0.0071390435008425734, -0.10089160257994415, 0.07260447634555206, -0.01951861321610527, 0.25326856916707136], -35.8934518397034, 4, DynamicHMC.DoubledTurn, 0.6079070679758589, 15), NUTS_Transition{Array{Float64,1},Float64}([1.677411910979019, 0.20952345355845858, -0.029467406728998793, -0.010112528398180755, 0.1294938676243732, 0.047979246760455035, 0.07271077728068957, -0.04120592432769675, 0.12619994852520758, -0.13083200593854602, 0.026403068739137225, 0.021858434281414506, 0.24298847226961157], -42.31873415587955, 3, DynamicHMC.DoubledTurn, 0.5634918929957303, 7)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.264
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6765124162682952, 0.07505272354600359, 0.2403093849349464, 0.22985099359688843, 0.1950155899723103, 0.18263851022080166, 0.17236802177626082, 0.1860558219034933, 0.16557369389801882, 0.1837857720350955, 0.17356603327344233, 0.25710115696204594, 0.10481319042502547]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.20377670788354, 0.2537491174149102, -0.4306556415155863, -0.46008416291895055, -0.2175942436302974, 0.03094064348731472, -0.02315015783919238, -0.5586045215469938, 0.5642934053176023, -0.09396653345650675, 0.4197142471143717, -0.4290746405924671, 0.6045909443048653]     
 [0.17246977396904886, 0.3578129215465899, -0.27237571850934184, 0.2776377061268023, 0.2081169492181817, 0.28659587586650603, 0.25821319885167915, 0.10897471560349034, 0.19230725047115815, -0.2119939936522291, 0.21546405341259575, -0.27654297488195523, 0.5764246012991868]   
 [1.8577218999136407, 0.18879986481887442, 0.11319275980286209, -0.1799892799378639, -0.3030593382237829, 0.3195637831971947, 0.10055917570742116, -0.5814798316503523, 0.09493127740866356, -0.22948840038429513, 0.29045118374006235, 0.001817450898953743, 0.44490391737581697] 
 [1.8755476041810888, 0.16158275776997674, -0.34880021411584144, 0.15364244322916248, -0.022976490322447557, 0.29782176571684305, 0.1676964829084657, -0.47586112943967734, 0.27955165368823476, -0.07708494340064301, 0.5511824609697903, 0.25247111877518524, 0.6182209570202964]
 [1.9668364775173546, 0.1659074668024268, -0.15755104701595787, -0.22775301414679328, -0.0649071633169382, 0.2772452554030576, -0.1320167493598434, -0.38842389340910705, 0.2838538514927352, -0.17043140086956143, 0.09326294416440249, 0.23296471935293653, 0.4808873160256997]  </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2778288029871584</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 956.299  793.391  1000.0  1000.0  …  1000.0  822.698  607.595  437.826</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.91, min/25%/median/75%/max: 0.08 0.87 0.95 0.99 1.0
  termination: AdjacentTurn =&gt; 7% DoubledTurn =&gt; 93%
  depth: 2 =&gt; 0% 3 =&gt; 13% 4 =&gt; 87% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1637737459573791, 0.25397384064141504]                                                                                                                                                                           
  [-0.2005047576567764, 0.028155458709741784, -0.05028002989182825, 0.32246372684983937, 0.040864951122495496, -0.305938129297717, 0.14613272287960755, -0.1607287029562448, 0.2737871602775477, -0.06595992226472376]
 0.2778288029871584                                                                                                                                                                                                   </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
