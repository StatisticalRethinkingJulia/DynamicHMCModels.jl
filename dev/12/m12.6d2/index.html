<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{CSV.Column{Int64,Int64},Array{Float64,2},Array{Int64,1}}([13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformTuple{NamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}}((β = TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), α = TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), s = TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-3795.1214625800258</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.06971021443738,0.26585751109547945, ...]
 * Minimum: -1.398549e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 3.17e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -3.99e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 7.06e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 890157079
 * Gradient Calls: 890157079</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.06971021443738      
  0.26585751109547945   
  5.619748489843536e-13 
 -1.1020043882114509e-13
  2.2206674100949719e-13
 -1.3283149945857013e-12
 -6.992829336063721e-14 
  1.2868598001955486e-12
 -5.284852983226107e-13 
  9.066146623895498e-13 
 -1.2754010197088091e-12
  1.0436966515672493e-11
  6.201206865470974e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.9278623887329067, 0.28093682227244143, -0.2180330933995301, 0.12817781330870662, -0.0004725508969706735, 0.13965104050849175, -0.02326447507366451, -0.2503246125780218, -0.019619378041244112, -0.17451462498069548, 0.08944138834318413, -0.14761030810687498, -0.30314744137657484], -42.205920811357174, 4, DynamicHMC.DoubledTurn, 0.9897123449684263, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0977400171238347, 0.24256356324993517, -0.2007139104140609, -0.14619945915660776, -0.12459800442244026, 0.6242938505006018, 0.16744750315319107, -0.21861749747063466, 0.3791852587413891, -0.02793043433337849, 0.6373802819364738, 0.014337857324755432, -0.6528780784734171], -40.49484520625668, 4, DynamicHMC.DoubledTurn, 0.9973145666224227, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9390535379034011, 0.28688113458339826, -0.21168768975944993, 0.37364971317401463, 0.0188486857593423, 0.16026445841129602, -0.05649800625602755, -0.5126472961818317, 0.13760696821424312, -0.20039670868172715, 0.020905577581712582, -0.3256262330007576, -0.5910993213091078], -46.198073164806274, 4, DynamicHMC.DoubledTurn, 0.9924588902053105, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9531047992861215, 0.2734691063659261, -0.18895054515113713, -0.12450498420991431, -0.14818186000025294, 0.29169162416060607, -0.014073127200540506, -0.16154816035309771, 0.06376842588997804, -0.1813993404330599, 0.18948039404080977, -0.08738453994103706, -0.3755333276429999], -41.14340891036541, 4, DynamicHMC.DoubledTurn, 0.9221894496905191, 15), NUTS_Transition{Array{Float64,1},Float64}([0.36155789218347006, 0.336555509594911, -0.13850091950795615, 0.04686837135733926, 0.11483541859012336, 0.6057982022275137, 0.2163846651757711, -0.41820447548027256, 0.10762801764589483, 0.13557677788021813, 0.3752122169356583, -0.3064705190892816, -0.6632496959701054], -43.19366502287643, 4, DynamicHMC.DoubledTurn, 0.8309315705752264, 15), NUTS_Transition{Array{Float64,1},Float64}([2.054845754401817, 0.13610400890657237, -0.11329744139105012, 0.16005568326693298, 0.1814206352762708, 0.34920396628283784, 0.35814216634090884, -0.04761973495178391, 0.3455399987584634, 0.09579488652721634, 0.49924332198008425, 0.5543893133526264, -0.6075647668871572], -45.037599190256216, 4, DynamicHMC.DoubledTurn, 0.9315897728682223, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.04269967225174828, 0.3795191420710536, 0.102261682266268, 0.2159065053316357, -0.13090989282185345, 0.5785676918786848, -0.0023470616162874075, -0.21037324738081592, 0.10055559557938716, -0.18984105408287266, 0.2753569438321496, -0.5082510869184594, -0.5021604680315446], -43.003097915865425, 4, DynamicHMC.DoubledTurn, 0.9565056359595069, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5382610118233409, 0.21033350708713933, -0.5849578348402027, 0.1147855227367665, 0.1508037708050957, 0.19143154940656898, 0.04579979246702655, -0.5373280321431132, 0.28585491372467403, -0.1477507747159595, 0.21691773945373033, 0.22739277796509108, -0.561926838804597], -43.71895362398938, 4, DynamicHMC.DoubledTurn, 0.9928874908355876, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5329050457085294, 0.2029098906800534, -0.4036327137159925, -0.02621750024219996, 0.11980530909237434, 0.07033891359986902, 0.08697591842310942, -0.2499280511648678, 0.2749355902345787, -0.11084766224207483, 0.18239417631559682, 0.2487046207926308, -0.43656395312445145], -45.025451129620954, 4, DynamicHMC.DoubledTurn, 0.4798945571251456, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8270008833254716, 0.2888199611570509, -0.0478464156644243, 0.33328819763036904, -0.17144970597485104, 0.4018496130203961, 0.11559442707854019, -0.6106887361066156, -0.0002647547759973886, -0.44843697659614457, 0.2949897241085286, -0.25604033117875696, -0.5534256195902925], -41.89327852317469, 4, DynamicHMC.DoubledTurn, 0.9865797730990856, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.148751699754412, 0.26478414845239623, -0.3087516675384603, 0.028791073538247905, -0.04052680572513683, 0.021956002959705588, -0.12391246482832816, -0.29373777427524883, 0.014278700138908224, 0.0010264020034557939, 0.3605277576410381, -0.18722540985963254, -0.5228108863763062], -41.27936274721353, 4, DynamicHMC.DoubledTurn, 0.9855705818874108, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1779035166163676, 0.24659950115340373, -0.06278690278996182, 0.1336248968190431, -0.023734080949869382, 0.6227701721148234, 0.1258830651977888, -0.3185158089843755, 0.27127029634511896, -0.21654426849657277, 0.19277012254075487, -0.06185258078862664, -0.5184495514083942], -39.7175102053598, 4, DynamicHMC.DoubledTurn, 0.9965555346292464, 15), NUTS_Transition{Array{Float64,1},Float64}([0.29570385201986427, 0.37371740727006486, -0.02541659344431149, 0.12324886625085787, -0.14057946104440408, -0.020750711680212485, -0.11198447423342106, -0.45750448481152683, -0.11087238423801772, -0.23329396168849292, 0.17578875061788335, -0.5213184532375593, -0.5168494898108599], -42.227348860022694, 4, DynamicHMC.DoubledTurn, 0.7883143032427716, 15), NUTS_Transition{Array{Float64,1},Float64}([1.831082042092729, 0.19336868916266953, -0.36708940197011614, -0.11963247450993628, -0.10647758703706804, 0.18849318259660416, 0.07393878186275102, -0.428603874039063, -0.00615264576679557, -0.4218387643418817, 0.18591149547456015, 0.08848087755991327, -0.5442875142255119], -41.1021743638182, 4, DynamicHMC.DoubledTurn, 0.9997061068053074, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.6140659458468706, 0.47232762231714587, -0.18492394327965242, 0.21111633458805656, -0.07548060963695848, 0.26518103811863397, -0.10155350672506935, -0.26577162610363664, -0.12237779763273193, -0.17006207994302322, 0.04875311488229952, -0.9605333966309013, -0.7075600844081225], -43.74576624041049, 4, DynamicHMC.DoubledTurn, 0.7988421763022178, 15), NUTS_Transition{Array{Float64,1},Float64}([2.1314038739195027, 0.15212059602068423, -0.37186485274013187, -0.01303161489877041, 0.005144039650313424, 0.30329213436482905, 0.09469157444895047, -0.6169949218860161, 0.4252518370325814, -0.38348989552198287, 0.4160671233352356, 0.24683623547192438, -0.5396286524911369], -47.663537749571695, 4, DynamicHMC.AdjacentTurn, 0.9982297797878054, 31), NUTS_Transition{Array{Float64,1},Float64}([1.0285862954418574, 0.2527963831635926, -0.27810259203097387, 0.19258394098540213, -0.22504923373595914, 0.17750909048419639, 0.2400425736302981, -0.4814453645248222, 0.21814073176983287, 0.2284776421852681, 0.49939822267748446, 0.08765502155368733, -0.6010074022013279], -46.315103146894195, 4, DynamicHMC.DoubledTurn, 0.9938622283061839, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8857511767503106, 0.18380481637039892, -0.34129709163689625, -0.06315984884189434, -0.12293517437127578, 0.2339282325024418, -0.16612339913581195, -0.36878439577083044, 0.17013757385495615, -0.6942996546903348, 0.14574909771917238, -0.000995049740495163, -0.5259174193320186], -45.8764031914003, 4, DynamicHMC.DoubledTurn, 0.9793246310949638, 15), NUTS_Transition{Array{Float64,1},Float64}([1.602663871378472, 0.20621654236469408, -0.49192601936717095, -0.1068272988491226, 0.006578292619090546, 0.3720361462290842, 0.04497825943327705, -0.2912904424117494, 0.1363852324591575, -0.6013878419385601, 0.36850500743822273, 0.08972925979408927, -0.5870758823426311], -41.91534113215705, 3, DynamicHMC.AdjacentTurn, 0.9652675553058787, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.033385904177404, 0.3983561499767794, -0.26462751450215655, 0.3009436100966267, -0.129987473500275, 0.1564529552308822, -0.05038640419602567, -0.4540892802811355, -0.020308188376470877, -0.3897577183667985, 0.0751292494146899, -0.6127851829114184, -0.512946579946293], -41.03001621647978, 4, DynamicHMC.DoubledTurn, 0.9844439345803321, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.265
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6078145930260027, 0.07114183517721061, 0.2383952262037919, 0.2009026887628887, 0.17336415026624635, 0.16892503700013836, 0.17099114773828294, 0.1930710995379599, 0.17846188222472592, 0.18735116752424735, 0.17166289091106635, 0.27136972516247615, 0.10357807738270791]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.9278623887329067, 0.28093682227244143, -0.2180330933995301, 0.12817781330870662, -0.0004725508969706735, 0.13965104050849175, -0.02326447507366451, -0.2503246125780218, -0.019619378041244112, -0.17451462498069548, 0.08944138834318413, -0.14761030810687498, -0.30314744137657484]
 [1.0977400171238347, 0.24256356324993517, -0.2007139104140609, -0.14619945915660776, -0.12459800442244026, 0.6242938505006018, 0.16744750315319107, -0.21861749747063466, 0.3791852587413891, -0.02793043433337849, 0.6373802819364738, 0.014337857324755432, -0.6528780784734171]       
 [0.9390535379034011, 0.28688113458339826, -0.21168768975944993, 0.37364971317401463, 0.0188486857593423, 0.16026445841129602, -0.05649800625602755, -0.5126472961818317, 0.13760696821424312, -0.20039670868172715, 0.020905577581712582, -0.3256262330007576, -0.5910993213091078]      
 [0.9531047992861215, 0.2734691063659261, -0.18895054515113713, -0.12450498420991431, -0.14818186000025294, 0.29169162416060607, -0.014073127200540506, -0.16154816035309771, 0.06376842588997804, -0.1813993404330599, 0.18948039404080977, -0.08738453994103706, -0.3755333276429999]   
 [0.36155789218347006, 0.336555509594911, -0.13850091950795615, 0.04686837135733926, 0.11483541859012336, 0.6057982022275137, 0.2163846651757711, -0.41820447548027256, 0.10762801764589483, 0.13557677788021813, 0.3752122169356583, -0.3064705190892816, -0.6632496959701054]           </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2815490253529706</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 661.645  650.959  791.184  699.007  …  868.301  996.462  752.691  402.916</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.91, min/25%/median/75%/max: 0.25 0.88 0.96 0.99 1.0
  termination: AdjacentTurn =&gt; 6% DoubledTurn =&gt; 94%
  depth: 2 =&gt; 0% 3 =&gt; 10% 4 =&gt; 89% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1114859782561022, 0.25964872416174717]                                                                                                                                                                             
  [-0.19703940811035364, 0.04265672946740224, -0.04492250595262521, 0.31991175251892817, 0.04495559271415096, -0.30581469333038314, 0.14408933720821945, -0.16782731006190857, 0.27030222857526826, -0.0852858629937305]
 0.2815490253529706                                                                                                                                                                                                     </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
