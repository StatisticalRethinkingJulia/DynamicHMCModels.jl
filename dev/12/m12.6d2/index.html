<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-2315.9419619330947</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0943170963120266,0.26338967848193784, ...]
 * Minimum: -1.293060e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 3.89e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -5.43e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 1.90e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 801201996
 * Gradient Calls: 801201996</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0943170963120266    
  0.26338967848193784   
  2.922895433713394e-13 
 -1.1659902423975864e-13
  3.8911774136754457e-14
 -8.988819440926398e-13 
 -1.9631402088071527e-13
  5.953042113955775e-13 
 -4.944996551814345e-13 
  2.9359944020884966e-13
 -1.0575277133533646e-12
 -5.49492010279098e-12  
  0.0001054345164432261 </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.8703711439133237, 0.17843216971375425, -0.2636867894708707, 0.29761432703989177, -0.16404640143107588, -0.00304211671153716, 0.20463331956031433, -0.5884888165973103, 0.17658886980866184, -0.0377716870702222, 0.4712551135679052, 0.2752213496448996, 0.5810864398854961], -53.456411421781524, 4, DynamicHMC.AdjacentTurn, 0.9959809993870927, 31), NUTS_Transition{Array{Float64,1},Float64}([1.8323470783806801, 0.1632903017871395, -0.15699181806972923, -0.06001278181601362, -0.0793849649903223, 0.2935613819497874, 0.20231556735226675, -0.23858265061724027, 0.266397358863216, -0.3049301586892027, 0.5702738977593859, 0.23878693491865716, 0.8366878517533974], -50.947237906180334, 4, DynamicHMC.DoubledTurn, 0.9086218967448644, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9219671895893802, 0.17887730779824904, -0.1668882293097151, -0.08884488775891483, -0.14485834368002792, 0.24251339793264523, 0.10468809237065207, -0.11139907004354731, 0.2556587046053327, -0.2433210561642332, 0.4445222017852934, 0.14859832772341086, 0.6918798161778065], -44.59049128307454, 4, DynamicHMC.DoubledTurn, 0.8082342783970167, 15), NUTS_Transition{Array{Float64,1},Float64}([0.22960711849532994, 0.3491562755410966, -0.10661067942548126, 0.30467727488972646, 0.07802995676109789, 0.5163147513650472, 0.12392587476667595, -0.5588926309215676, 0.18971737058208227, -0.2864193688236996, 0.3131070363069286, -0.41337830844603485, 0.5967521373777521], -45.466723255259716, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([0.16922308420455887, 0.3539463757399593, -0.1426685647145419, 0.3267475898280251, 0.03268299486856678, 0.5533612478617554, 0.13961206787487734, -0.5967058613050982, 0.19980374852479993, -0.33408624683840527, 0.3169660763204032, -0.4422136338248997, 0.640860638490715], -38.70157658010373, 4, DynamicHMC.DoubledTurn, 0.9650020405036607, 15), NUTS_Transition{Array{Float64,1},Float64}([0.32146927608607856, 0.36503451395143727, 0.049241417696171706, 0.38481039720345417, 0.05830527524097995, 0.2922219653711421, 0.049777468120633966, -0.36618527105625415, -0.15363180197865633, -0.3689794099513568, 0.07945145294955074, -0.48108380922963445, 0.4425136571550598], -43.00511044141078, 4, DynamicHMC.DoubledTurn, 0.9605293819775458, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6795674919030972, 0.201413323562662, -0.500788921834041, -0.30376519049823225, -0.258261398992924, 0.3929961241773456, 0.035967494086613885, -0.34451399126462384, 0.4291389082419634, -0.057852122917995914, 0.4506865536465935, 0.11310512109528625, 0.6694558805301133], -43.410489928397205, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5713271046462833, 0.20560807926122893, -0.5299456833420811, -0.11012536764254202, 0.11930072816019346, 0.5425389977081866, 0.07169736034176916, -0.043512047440214946, 0.3594752913008196, -0.17012406002756505, 0.41270009056251233, 0.26412602226032744, 0.4525811097853224], -45.711269613729065, 4, DynamicHMC.DoubledTurn, 0.9852487651202223, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2051967791832614, 0.2507853034394838, -0.6106022307908412, 0.029416330282062683, -0.2062187060663367, 0.4068884553687916, 0.0692862178154544, -0.3715911408990886, 0.21299509462381652, -0.10060036977636022, 0.4234764638420845, 0.08973647071805871, 0.6346831715477047], -43.477425497711266, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([0.407140394959347, 0.3505786332779585, 0.04489328493498784, 0.10909749586436299, -0.0676644258168373, 0.5908048999307732, 0.08952323865112652, -0.28812994832079575, 0.19188162478197712, -0.3169822274665891, 0.10008042814221633, -0.39790056728341067, 0.6823937501700973], -46.16874306269937, 4, DynamicHMC.AdjacentTurn, 0.8865790510563897, 31)  …  NUTS_Transition{Array{Float64,1},Float64}([0.569220036451138, 0.33506677181168565, -0.24754470356367353, -0.16801741571517353, -0.19875518764636965, 0.2886812762208174, 0.08692760791225324, -0.5107691107726524, 0.14628710459270375, -0.18844307254744042, -0.10596813029413309, -0.24106539442947533, 0.5473350175651304], -47.15045849477612, 4, DynamicHMC.DoubledTurn, 0.8943267271604852, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8410909266690105, 0.16092384645363128, -0.2854521707130439, 0.28678145972827207, 0.1887737062346066, 0.2974605179015653, -0.09070626809771809, -0.2990876162395322, 0.22927086988159304, -0.16873302919675365, 0.5008500356161476, 0.22588451110043142, 0.5944904468170604], -47.08916323416141, 4, DynamicHMC.AdjacentTurn, 0.9097130468963102, 31), NUTS_Transition{Array{Float64,1},Float64}([2.8113306013792143, 0.07466129411394518, -0.8843461228826685, -0.27046997254046096, 0.04807073360548865, 0.012976925495306628, -0.32679456995965234, -0.3134085454692251, -0.04699818798450908, -0.20580058338182464, 0.38144205589765295, 0.3435562236408037, 0.5956649681101541], -48.58210850333738, 4, DynamicHMC.DoubledTurn, 0.9875148270211322, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9176469220992198, 0.16241351765173284, -0.8167643753396335, 0.04304289553069034, 0.23030583249659667, 0.3172558397062182, 0.17489173949208642, -0.3006567574553324, 0.1020320120223647, -0.09702605349416175, 0.6371891051199883, 0.28000907379895357, 0.7115513819141988], -48.56811449897781, 5, DynamicHMC.DoubledTurn, 0.9963902678027078, 31), NUTS_Transition{Array{Float64,1},Float64}([0.5911159414311586, 0.3101013950958502, 0.12682984024961774, 0.294171668035635, 0.06640213140129214, 0.8114369599600821, 0.13868918615091697, -0.17724808351200277, 0.06608879348131734, -0.16343465079480152, 0.27820280133684877, -0.37476863926694004, 0.6659287353466352], -50.06382311062325, 5, DynamicHMC.DoubledTurn, 0.9560418429968055, 31), NUTS_Transition{Array{Float64,1},Float64}([-0.983134679540925, 0.4864980208863044, -0.09610238874261608, 0.26219443488442995, 0.18007027219815325, 0.6677532499690129, -0.1567549738313023, -0.29349769610277165, 0.3925270083959613, -0.14311039574460846, 0.38760660797105484, -0.8293112161946691, 0.6984557882110002], -48.18890697883407, 4, DynamicHMC.AdjacentTurn, 0.9827755774082009, 31), NUTS_Transition{Array{Float64,1},Float64}([2.466681751754447, 0.12107504517791351, -0.6011367914914905, 0.06995954236582179, -0.34221585507747687, 0.3458602054917472, 0.1338031325440852, -0.6290570665098543, 0.05519370557139627, -0.487807623044113, 0.19801794452483196, 0.3753662362779583, 0.784573982805498], -49.748752420409645, 5, DynamicHMC.DoubledTurn, 0.9608448568728312, 31), NUTS_Transition{Array{Float64,1},Float64}([0.616753614834699, 0.3171205566739783, 0.2710014255764269, 0.06955549616220895, 0.15159084579154153, 0.2521611691129799, 0.12391234065512474, 0.12663462086635927, -0.026623774039508274, -0.2135615511795141, -0.04943260248705524, -0.17575385602683258, 0.3661365829712845], -52.219266563602766, 4, DynamicHMC.AdjacentTurn, 0.813966260496366, 31), NUTS_Transition{Array{Float64,1},Float64}([0.7133934283955784, 0.3104213195196921, 0.19495674533438462, -0.0023168656862499887, 0.18387632233881973, 0.2906101572584231, 0.1191457837520061, 0.11669453906511834, -0.0031977410445828136, -0.15997520740784857, -0.03520338757426997, -0.13957367548036087, 0.38223107793180955], -47.07508943596357, 4, DynamicHMC.AdjacentTurn, 0.9780337507602223, 31), NUTS_Transition{Array{Float64,1},Float64}([1.0752859030543316, 0.288105396558358, -0.29296518979112957, -0.010696732212402367, -0.09175725764391576, 0.16009300374741783, -0.048773452784899356, -0.6362123705690496, 0.07289366611984788, -0.23609035485211455, 0.0014529907442223516, -0.33882901620874034, 0.4193034686566154], -48.023158619865875, 4, DynamicHMC.DoubledTurn, 1.0, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.225
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6386155457242751, 0.07217206108042873, 0.22743242871468786, 0.19374196593939802, 0.17894213020412442, 0.19208077130048162, 0.1673253762340065, 0.2057512349724206, 0.16720611414242856, 0.18635873178452306, 0.17097129948335799, 0.23751533300000593, 0.1656875877755509]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.8703711439133237, 0.17843216971375425, -0.2636867894708707, 0.29761432703989177, -0.16404640143107588, -0.00304211671153716, 0.20463331956031433, -0.5884888165973103, 0.17658886980866184, -0.0377716870702222, 0.4712551135679052, 0.2752213496448996, 0.5810864398854961] 
 [1.8323470783806801, 0.1632903017871395, -0.15699181806972923, -0.06001278181601362, -0.0793849649903223, 0.2935613819497874, 0.20231556735226675, -0.23858265061724027, 0.266397358863216, -0.3049301586892027, 0.5702738977593859, 0.23878693491865716, 0.8366878517533974]   
 [1.9219671895893802, 0.17887730779824904, -0.1668882293097151, -0.08884488775891483, -0.14485834368002792, 0.24251339793264523, 0.10468809237065207, -0.11139907004354731, 0.2556587046053327, -0.2433210561642332, 0.4445222017852934, 0.14859832772341086, 0.6918798161778065]
 [0.22960711849532994, 0.3491562755410966, -0.10661067942548126, 0.30467727488972646, 0.07802995676109789, 0.5163147513650472, 0.12392587476667595, -0.5588926309215676, 0.18971737058208227, -0.2864193688236996, 0.3131070363069286, -0.41337830844603485, 0.5967521373777521] 
 [0.16922308420455887, 0.3539463757399593, -0.1426685647145419, 0.3267475898280251, 0.03268299486856678, 0.5533612478617554, 0.13961206787487734, -0.5967058613050982, 0.19980374852479993, -0.33408624683840527, 0.3169660763204032, -0.4422136338248997, 0.640860638490715]    </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.27101844939826186</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 1000.0  1000.0  1000.0  883.975  …  650.054  630.441  769.351  375.588</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.92, min/25%/median/75%/max: 0.0 0.9 0.96 0.99 1.0
  termination: AdjacentDivergent =&gt; 0% AdjacentTurn =&gt; 14% DoubledTurn =&gt; 86%
  depth: 2 =&gt; 0% 3 =&gt; 4% 4 =&gt; 89% 5 =&gt; 6%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.0789899372062552, 0.26411004731607957]                                                                                                                                                                              
  [-0.17804650122494653, 0.04712192192438702, -0.03787936107906151, 0.31080724800348813, 0.033382031829184665, -0.30463824216962776, 0.12677975231185917, -0.17335327651220328, 0.2493924972984337, -0.10969487064035796]
 0.27101844939826186                                                                                                                                                                                                     </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
