<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-3028.5472506838883</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.079649744642835,0.2648693422692122, ...]
 * Minimum: -1.317234e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 9.23e-12 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -2.15e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 2.15e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 678518123
 * Gradient Calls: 678518123</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.079649744642835     
  0.2648693422692122    
  6.327742601500288e-13 
 -9.893418673305598e-14 
  2.750954946085355e-13 
 -1.4135160934739226e-12
 -2.6874548303230538e-14
  1.458615098318953e-12 
 -5.203228807572e-13    
  1.0646928350554781e-12
 -1.3012856735451863e-12
  1.2858347861395575e-11
  9.325012009131363e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.263928372361922, 0.2587359180158187, -0.11065350065277538, 0.12136756567171679, -0.21749914296515221, 0.4031498162852568, -0.2525638532873917, -0.4610020066144791, -0.20902594368508776, -0.3865564104889678, 0.13047243269598732, -0.329566900596066, 0.565600670635295], -43.78114986946399, 4, DynamicHMC.DoubledTurn, 0.9902562724792119, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1792023196877757, 0.26683818296921163, -0.1230332965711919, 0.09317987463448946, -0.08305682299315878, 0.2584300427948248, -0.11241469455347458, -0.341455564112689, -0.04269469595141573, -0.3003326733676836, 0.25623016395753473, -0.20745125127046105, 0.4507023344782361], -39.83459302944995, 4, DynamicHMC.DoubledTurn, 0.9753831079701178, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1523628083869106, 0.25365891095256127, -0.27769346505753195, -0.15694298005524862, 0.2598640655545634, 0.11490468567175127, 0.17729276805591881, -0.24774247728717963, 0.19261627834623393, 0.04657294923334013, 0.311466115925025, 0.019744725035555882, 0.4152917552521444], -39.01320216198131, 4, DynamicHMC.DoubledTurn, 0.9917698084536326, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9000529064819647, 0.2770700858886352, -0.40281454259102517, -0.14177734901372502, 0.10685587417437506, 0.1858181440292229, 0.18604988525317548, -0.31815253184738546, 0.35797629616226345, -0.10632110229575678, 0.3473865619919927, -0.14481424306621177, 0.5071909807026632], -40.908253561249936, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9945864269991884, 0.16115667428634922, -0.4813612910934234, 0.027698678008096483, -0.021334776761522418, 0.33202837082321535, 0.0818194460632545, -0.19952122134666742, 0.17616713456196584, -0.041421761358390576, 0.27080130907542654, -0.061829476027656, 0.4811273057674653], -43.38137031886117, 4, DynamicHMC.DoubledTurn, 0.7312717588354921, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8769820247568356, 0.26730387038824255, -0.31310021740465654, 0.008629395080869334, 0.08961137882536231, 0.3602323736400637, 0.11050576939462066, -0.31609581725771835, 0.404119938268639, -0.27846836540586245, 0.3289345570574096, 0.1686822164142605, 0.49104317382009294], -42.88186860618385, 4, DynamicHMC.DoubledTurn, 0.9921989718552181, 15), NUTS_Transition{Array{Float64,1},Float64}([1.776936647132203, 0.19397010401112968, -0.08223794260923425, -0.0005871512429010519, -0.01119865457762315, 0.17448606112419554, 0.04966920777939061, -0.17343416138115103, 0.152616826764509, -0.2777049608883309, 0.008297102689889674, -0.004690571490279863, 0.3919418287482891], -43.52127751236695, 4, DynamicHMC.DoubledTurn, 0.982471226180927, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9197414617208657, 0.18118740567236105, -0.008155693287162244, -0.042606304537719304, 0.00788980120336229, 0.0312877837810796, 0.04412969520577171, -0.14560540349936021, 0.09879607630759517, -0.24872372871641427, 0.01588607357494109, -0.05787395502860486, 0.33236740112670343], -48.85351920575043, 4, DynamicHMC.DoubledTurn, 0.6903187296374842, 15), NUTS_Transition{Array{Float64,1},Float64}([2.0725549845243476, 0.15640800802257745, -0.015376171015911128, 0.04785306762929628, -0.03539348007197723, 0.17571359608609916, -0.03946762962036799, -0.11221482602428542, 0.14217555219179684, -0.07562047879549948, 0.21791054339762234, 0.17641637064053894, 0.3226534634225261], -37.28922032604603, 3, DynamicHMC.DoubledTurn, 0.9428950249528789, 7), NUTS_Transition{Array{Float64,1},Float64}([1.563966976674501, 0.2279695026252851, -0.2745826080741047, 0.037996801264674994, -0.0911976321560818, 0.25281458499004833, 0.0247531470995497, -0.22146360254772918, -0.20010611164268885, -0.1729743523103398, -0.0031917993332979747, -0.21077634790247077, 0.403053801495639], -41.399713331121866, 4, DynamicHMC.DoubledTurn, 0.629186321502078, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.4235509893905822, 0.24141566870871112, -0.7378410069803747, -0.557280735341177, -0.4752688247987682, 0.2441565496946522, -0.17058274218283265, -0.8155874152240221, 0.035655898679395046, -0.37079855339520185, -0.03311961935925449, -0.1359726889760427, 0.7410979856661353], -49.0775348166625, 4, DynamicHMC.DoubledTurn, 0.9190591419521803, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8035396101575765, 0.2052304974369684, -0.6982628560952899, -0.4300484139847818, -0.5693155046118865, 0.25440723834832685, -0.09292914013428102, -0.7127993197167584, 0.0026447376060099413, -0.3637168775091775, 0.051834700778121356, -0.01668817372358468, 0.6933570607874691], -48.671336472176826, 4, DynamicHMC.DoubledTurn, 0.9985586252431486, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8050945696810823, 0.19346239082791347, -0.6580853848582334, 0.03377464605939692, 0.03682008550143768, -0.01792004331507842, -0.2963546513296263, -0.4138110631686912, 0.07660317264588797, -0.4263121750310579, 0.2785165121540417, -0.07216449754451351, 0.6527102443009664], -47.639360159181535, 4, DynamicHMC.DoubledTurn, 0.9141313381967952, 15), NUTS_Transition{Array{Float64,1},Float64}([-1.0496178189219252, 0.4797709860945115, 0.4893233624226625, 0.5596438270105111, 0.18320041994662217, 0.5023412110039784, 0.15282077758510998, -0.33304012056717686, 0.5175729449444731, -0.19523359692957537, 0.33076756141539804, -0.8107899772139363, 0.6302442019062807], -46.816786817735185, 5, DynamicHMC.DoubledTurn, 0.9931106867193817, 31), NUTS_Transition{Array{Float64,1},Float64}([0.9080858392840215, 0.293663272099216, 0.3093605349062783, -0.13805181411842266, -0.20289478615083792, 0.5009236601266852, -0.05838180416054272, -0.3612608353391383, -0.17037282631605025, -0.24428198367625242, 0.32195530866317923, -0.30536606821529183, 0.6603191239844798], -53.20399610217977, 5, DynamicHMC.DoubledTurn, 0.726318606036297, 31), NUTS_Transition{Array{Float64,1},Float64}([-0.4659045304963652, 0.4474886113934835, -0.258776920587157, 0.2013338232434389, 0.0505209488080193, 0.2615906232144317, -0.09185670556844755, -0.8482985370174263, -0.03643385751519358, -0.33883039316914465, 0.006708920124959768, -0.7434545795700825, 0.6278562614763226], -50.02442952487107, 4, DynamicHMC.AdjacentTurn, 0.9934695871575451, 31), NUTS_Transition{Array{Float64,1},Float64}([1.5827585548041652, 0.200389841153509, -0.13106727461088577, -0.1043817994108538, -0.05664336920012881, 0.14141666057033617, 0.2614632855034638, -0.11571510378072128, 0.2040182154900404, 0.012295608388319721, 0.3521724419885596, 0.22171916350363227, 0.3850506011733642], -46.40651207023079, 4, DynamicHMC.AdjacentTurn, 0.9745402252390469, 31), NUTS_Transition{Array{Float64,1},Float64}([0.44280804418325065, 0.34304425729054067, 0.02993966948680167, 0.042006134286195033, -0.07691643496115547, 0.24407092080724063, -0.23861726748415588, -0.19825288336933986, 0.11785887630018652, -0.2557420477711565, 0.16006610015845785, -0.4428090315764876, 0.5082977858358253], -38.97067196736152, 4, DynamicHMC.DoubledTurn, 0.9957293611608781, 15), NUTS_Transition{Array{Float64,1},Float64}([1.657675426855569, 0.19663311157287452, -0.3034165086598399, -0.00924162273113677, 0.047585685359977314, 0.18736155383677258, 0.21721924777429533, -0.2289247473319655, 0.03707503308399832, -0.056062159878820295, 0.2323262986290906, 0.07359853140485419, 0.36929240647211325], -37.36218391226999, 4, DynamicHMC.DoubledTurn, 0.9788878654784624, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6946048578663967, 0.3120587088938812, -0.13991962116883466, 0.1621381130930171, -0.082277172265081, 0.3254775696918792, -0.34597593877563254, -0.23106843716436926, 0.12492476631968527, -0.3197447584575196, 0.3061554338972411, -0.22018108405302222, 0.5133338092607875], -42.15799512502146, 4, DynamicHMC.DoubledTurn, 0.9031602269471184, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.222
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6342376116828321, 0.07143755838563373, 0.1999108456061654, 0.18952999660294975, 0.17883780232732777, 0.18844723864415625, 0.15924474320076104, 0.19462913151096292, 0.17763277057663415, 0.1745883965313108, 0.1708057197212429, 0.25552538590400026, 0.11370254087337472]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.263928372361922, 0.2587359180158187, -0.11065350065277538, 0.12136756567171679, -0.21749914296515221, 0.4031498162852568, -0.2525638532873917, -0.4610020066144791, -0.20902594368508776, -0.3865564104889678, 0.13047243269598732, -0.329566900596066, 0.565600670635295]      
 [1.1792023196877757, 0.26683818296921163, -0.1230332965711919, 0.09317987463448946, -0.08305682299315878, 0.2584300427948248, -0.11241469455347458, -0.341455564112689, -0.04269469595141573, -0.3003326733676836, 0.25623016395753473, -0.20745125127046105, 0.4507023344782361]  
 [1.1523628083869106, 0.25365891095256127, -0.27769346505753195, -0.15694298005524862, 0.2598640655545634, 0.11490468567175127, 0.17729276805591881, -0.24774247728717963, 0.19261627834623393, 0.04657294923334013, 0.311466115925025, 0.019744725035555882, 0.4152917552521444]   
 [0.9000529064819647, 0.2770700858886352, -0.40281454259102517, -0.14177734901372502, 0.10685587417437506, 0.1858181440292229, 0.18604988525317548, -0.31815253184738546, 0.35797629616226345, -0.10632110229575678, 0.3473865619919927, -0.14481424306621177, 0.5071909807026632]  
 [1.9945864269991884, 0.16115667428634922, -0.4813612910934234, 0.027698678008096483, -0.021334776761522418, 0.33202837082321535, 0.0818194460632545, -0.19952122134666742, 0.17616713456196584, -0.041421761358390576, 0.27080130907542654, -0.061829476027656, 0.4811273057674653]</code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.27020042321135596</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 745.127  753.161  545.205  751.626  …  1000.0  873.456  850.989  351.841</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.94, min/25%/median/75%/max: 0.0 0.92 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 11% DoubledTurn =&gt; 89%
  depth: 2 =&gt; 0% 3 =&gt; 5% 4 =&gt; 92% 5 =&gt; 3%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1127526809299022, 0.26062447276357575]                                                                                                                                                                            
  [-0.20729521317458707, 0.039248469220253705, -0.04069357838476705, 0.3043143630006278, 0.03674658381881333, -0.2951186776715395, 0.12848258754649944, -0.17339752836957473, 0.2534648502900705, -0.09286146280636087]
 0.27020042321135596                                                                                                                                                                                                   </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
