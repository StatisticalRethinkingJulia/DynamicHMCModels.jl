<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-4515.94127533703</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language- 6d2">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language- 6d2">Optim.minimizer(res)</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([2.070707171776443, 0.1682553588649156, -0.6616800750108255, 0.024613788054086812, -0.0751341357171827, 0.23681266840471002, -0.12762906864332588, -0.0029951100036764017, 0.21909468570844207, -0.11971087782641956, 0.1582669209259538, 0.035103179972853685, 0.5596841600018507], -46.08818122532717, 4, DynamicHMC.DoubledTurn, 0.8230566617310409, 15), NUTS_Transition{Array{Float64,1},Float64}([0.453474586298494, 0.33004360424833895, 0.3239196176791432, 0.338776886156582, 0.11006912696860677, 0.5320838155410857, -0.07009964588886207, -0.5066900295463981, -0.013114542045658973, -0.1685528195828264, 0.28251794442550804, -0.06573235971794864, 0.48786502555196287], -46.90272906738582, 4, DynamicHMC.DoubledTurn, 0.9768816727175385, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1690816411628526, 0.27336846092836037, -0.48274122000594244, -0.38997087286576243, -0.1282619288423268, -0.06497935667125534, 0.16589834630427244, -0.2880426675052555, -0.0122673881492446, -0.17674468398522092, 0.135921882098303, -0.11555389331996668, 0.4577846587774956], -48.23632957600607, 4, DynamicHMC.DoubledTurn, 0.9833953507544648, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1965304824363778, 0.24285442443845415, -0.4831300276766882, -0.10602482639995037, -0.08674051945537538, 0.12507984128918542, 0.18739922954078406, -0.21674326576202668, 0.0708442760178628, -0.11158868963828832, 0.21689338905134484, -0.028007453131403494, 0.5039125106830918], -43.58899350854478, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3252842499279947, 0.25292527714212715, -0.005578670690323615, 0.17902126282878572, -0.09781536307681998, 0.31736295865148484, -0.04077182528782136, -0.41871247076768675, -0.002016013857228688, -0.15052672403321254, 0.34708013291490286, -0.227416007939154, 0.4949314702488576], -42.77037246981819, 4, DynamicHMC.DoubledTurn, 0.9965532312978295, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9362449548440552, 0.2868044993965183, -0.05182112027858336, -0.022446128797360354, -0.11151442355650894, 0.3031688169698578, -0.07150403123038276, -0.4033149828890912, 0.07524529408518071, -0.15970410589525208, 0.17123138472677252, -0.31416075386111225, 0.5360735003791163], -45.19212627314949, 3, DynamicHMC.AdjacentTurn, 0.9753416769812823, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2953917564487576, 0.23216678561905488, -0.22127106914615174, -0.0690582685863621, 0.06146779352071981, 0.2080016700707238, 0.16442852910751515, -0.16176847187773963, 0.14982060347606563, -0.05117725002414172, 0.366745947774196, 0.2018297940830966, 0.4695479420005566], -38.136222398574986, 4, DynamicHMC.DoubledTurn, 0.982962132062699, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5051477297208662, 0.22379445752839675, -0.1672727367111197, -0.00870220754035178, -0.15739557890377315, 0.5313274088947116, -0.010642180957729515, -0.386081190462481, 0.0968653935623342, -0.07848554204273447, -0.00644989558846804, -0.015117588400643645, 0.5465774229911315], -41.191626531350224, 4, DynamicHMC.DoubledTurn, 0.9534859631006662, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7383807896990771, 0.2957613531327234, 0.3091509875384153, 0.06945000040547325, 0.14142510629320906, 0.3453289470209913, 0.010872065534754689, -0.40650793272768193, 0.2534632461338189, 0.06742026364156363, 0.38524604658197165, -0.163057966734637, 0.571460897673643], -42.30035115307395, 4, DynamicHMC.DoubledTurn, 0.9829601094514463, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5900764230737623, 0.2163549691280825, -0.5147320758764702, 0.0018178785204038955, -0.1317206871934738, 0.28991683293470255, -0.05816170227604408, -0.1865827105153999, 0.12885378940902778, -0.4232645966201628, 0.18279218394813684, -0.011100713872109202, 0.4183589016635417], -41.81168279581522, 4, DynamicHMC.DoubledTurn, 0.9984932424281997, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.157926664813266, 0.25699009473030265, 0.1075735528232786, 0.17369713270096085, -0.1051119079083862, 0.29301509302186346, 0.027354683513584617, -0.11959297337857684, -0.033837502262285296, -0.10683343549926586, 0.36490217256724494, -0.04054392512873935, 0.38792073615823475], -40.64258775058609, 4, DynamicHMC.DoubledTurn, 0.7141199959061718, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9747028720557812, 0.29232115225308264, -0.2197675773882739, -0.163381934637589, -0.10893263401588284, -0.014974708163117707, -0.23507526376172427, -0.42620177373449253, -0.12975193311460864, -0.2789110287915919, 0.31349305949607853, -0.32240979442524603, 0.5159438295851386], -40.05047832165374, 4, DynamicHMC.DoubledTurn, 0.970306339827767, 15), NUTS_Transition{Array{Float64,1},Float64}([2.3815949104358833, 0.13227093625276315, -0.7961721778691508, -0.3156199810359327, -0.3058042869259507, 0.37356454570018455, 0.14198219162143985, -0.42608237123677284, 0.2093767688223978, -0.1454666247093447, 0.08372122517501349, 0.3179683329598171, 0.6636353194598086], -44.14706448258875, 4, DynamicHMC.DoubledTurn, 0.9485485028511341, 15), NUTS_Transition{Array{Float64,1},Float64}([0.4832755915433427, 0.31680805952941726, 0.07141270998197707, 0.07909658182602636, -0.20717972356313785, 0.4520605476807766, 0.039615135906960336, -0.23276762669951226, 0.16959638449673786, -0.0382489443440053, 0.4806190046005091, -0.23840197227622545, 0.4494969516788484], -45.661546605994104, 4, DynamicHMC.DoubledTurn, 0.9384994947155596, 15), NUTS_Transition{Array{Float64,1},Float64}([1.175664097028781, 0.25145807138477516, 0.03353881035078817, -0.05659884522937288, -0.39098110275534337, 0.41862097485963945, 0.03241288251673151, -0.2854194725227424, 0.08835441645400433, -0.10131656577571094, 0.4365978216473724, -0.08173380070451555, 0.47039418431950497], -41.56659251701883, 4, DynamicHMC.DoubledTurn, 0.9980060598960164, 15), NUTS_Transition{Array{Float64,1},Float64}([1.828719150073189, 0.1937451829582556, -0.5324563749014298, -0.08378906151425833, -0.39720843546087053, 0.2548701237030084, 0.1284462193319095, -0.4471658146167139, 0.06426734203900199, -0.023492791259370684, 0.12364834034479513, -0.08213774005230919, 0.5320112857637225], -41.06982509668806, 4, DynamicHMC.DoubledTurn, 0.9844193247953257, 15), NUTS_Transition{Array{Float64,1},Float64}([1.51070556355563, 0.20988454676783025, -0.1490980572590549, 0.036695127751093085, -0.03759947105399808, 0.25892172943194647, 0.10787670868201951, -0.13594783590714066, 0.17815733769861788, 0.0518718726827882, 0.2645718062441268, 0.10222958258935737, 0.5028891840881938], -41.2141563859358, 4, DynamicHMC.DoubledTurn, 0.9795581567826641, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9084350439726905, 0.29629294817853, -0.011994114436458831, -0.028179050955459597, 0.052358171331227034, 0.391308665550638, -0.11949113725981585, -0.14789028351956637, 0.09114758872723489, -0.19374130315358723, -0.06207871496063784, -0.3781860677752852, 0.3781381589344372], -41.69307601048935, 3, DynamicHMC.DoubledTurn, 0.9531724689161175, 7), NUTS_Transition{Array{Float64,1},Float64}([1.6907930202732546, 0.213262885890156, -0.4639619913381807, -0.19964145879848305, -0.2660726964229908, 0.28820743125259196, -0.05646716762194646, -0.6016810366906633, -0.039411540188371966, -0.024565786672231835, 0.34024891271599395, -0.11690168136057653, 0.6891759853180862], -43.82746884444024, 4, DynamicHMC.DoubledTurn, 0.9128771257482092, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2753393622206886, 0.24965552578901462, 0.022332935160754963, 0.11019999996368386, -0.15325984497475093, 0.18786892272226563, -0.03461989845290393, -0.12679353582304795, 0.03795778772146566, 0.12310168964918235, 0.15851620342067377, -0.12131247576485232, 0.30887665910228973], -40.79071512875511, 4, DynamicHMC.DoubledTurn, 0.9154567218998576, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.24
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.745752392462541, 0.08135901218940898, 0.236451868297422, 0.22784345942688905, 0.1719693117528127, 0.18072440657381436, 0.1703914161380285, 0.2039893814644857, 0.16534648805894, 0.1744412644483334, 0.17179813919441972, 0.2562932152287637, 0.10736678883362322]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [2.070707171776443, 0.1682553588649156, -0.6616800750108255, 0.024613788054086812, -0.0751341357171827, 0.23681266840471002, -0.12762906864332588, -0.0029951100036764017, 0.21909468570844207, -0.11971087782641956, 0.1582669209259538, 0.035103179972853685, 0.5596841600018507]   
 [0.453474586298494, 0.33004360424833895, 0.3239196176791432, 0.338776886156582, 0.11006912696860677, 0.5320838155410857, -0.07009964588886207, -0.5066900295463981, -0.013114542045658973, -0.1685528195828264, 0.28251794442550804, -0.06573235971794864, 0.48786502555196287]       
 [1.1690816411628526, 0.27336846092836037, -0.48274122000594244, -0.38997087286576243, -0.1282619288423268, -0.06497935667125534, 0.16589834630427244, -0.2880426675052555, -0.0122673881492446, -0.17674468398522092, 0.135921882098303, -0.11555389331996668, 0.4577846587774956]    
 [1.1965304824363778, 0.24285442443845415, -0.4831300276766882, -0.10602482639995037, -0.08674051945537538, 0.12507984128918542, 0.18739922954078406, -0.21674326576202668, 0.0708442760178628, -0.11158868963828832, 0.21689338905134484, -0.028007453131403494, 0.5039125106830918]  
 [1.3252842499279947, 0.25292527714212715, -0.005578670690323615, 0.17902126282878572, -0.09781536307681998, 0.31736295865148484, -0.04077182528782136, -0.41871247076768675, -0.002016013857228688, -0.15052672403321254, 0.34708013291490286, -0.227416007939154, 0.4949314702488576]</code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2761664761563101</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 766.494  721.185  658.611  1000.0  …  863.133  737.45  660.624  440.159</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.94, min/25%/median/75%/max: 0.15 0.92 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 6% DoubledTurn =&gt; 94%
  depth: 2 =&gt; 0% 3 =&gt; 6% 4 =&gt; 93% 5 =&gt; 1%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.156416801264502, 0.2547402018243936]                                                                                                                                                                                
  [-0.19394880333599893, 0.034583914951920335, -0.062467465287440765, 0.3167465265084868, 0.045415258586522705, -0.3052509150287578, 0.13688287614676972, -0.16473340501748215, 0.2703908675115515, -0.06864606767665762]
 0.2761664761563101                                                                                                                                                                                                      </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
