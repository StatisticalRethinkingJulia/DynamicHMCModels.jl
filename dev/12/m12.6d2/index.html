<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-2939.428698093382</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.09041991290868,0.26378246015662504, ...]
 * Minimum: -1.414457e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 2.74e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -3.65e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 8.09e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 611377304
 * Gradient Calls: 611377304</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.09041991290868      
  0.26378246015662504   
  4.657401521257147e-13 
 -6.512706397212409e-14 
  2.074271291355529e-13 
 -1.0175416260699677e-12
 -1.0186918838146618e-14
  1.0679514347611092e-12
 -3.6755293003778475e-13
  7.83803490428018e-13  
 -9.310377491111417e-13 
  8.80407511191485e-12  
  5.743210760766268e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.15674493152025787, 0.367138343212948, -0.06746489666667947, 0.21796564365518456, -0.02591989344283227, 0.4621877611629565, 0.2580607206930245, -0.1375687222263437, 0.12130358406442021, -0.028769084437256894, -0.10716443380973115, -0.49259658367838366, -0.5591016052292903], -47.08406904237126, 4, DynamicHMC.DoubledTurn, 0.8476913204441945, 15), NUTS_Transition{Array{Float64,1},Float64}([2.0408168005251333, 0.15327868601141928, -0.2945616970118442, -0.11031917040670876, 0.06682792921866301, 0.3004382667061548, 0.0233704755169943, -0.6662904647518931, 0.19490176027608722, -0.19556492515847926, 0.6518561791379229, 0.3438572053735627, -0.5208677307115624], -46.981991384624585, 4, DynamicHMC.DoubledTurn, 0.948794861836506, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5407017676736741, 0.31403668533826246, -0.3211091809743872, 0.13735239412133382, -0.1292734578549295, 0.4001814636916023, 0.43656936264259505, -0.4529518201978017, 0.21075815245940746, -0.3513903004599171, 0.34560756426616984, -0.17928949963778784, -0.5516221519334988], -45.90806833554594, 4, DynamicHMC.DoubledTurn, 0.9745291705832181, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6449900522549563, 0.225536153686227, -0.21395201139993744, -0.17750789400272748, -0.02236395751399662, 0.13342366995216154, -0.31907057429219715, -0.0055613277831631155, 0.10034922450511431, 0.012752906598789783, 0.13381828641235266, -0.07245748056381845, -0.460163655090165], -50.68737603461379, 4, DynamicHMC.DoubledTurn, 0.5755242400122316, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6888341393595128, 0.286910955312758, -0.15711686053036858, 0.29285879090750655, -0.07874357577231222, 0.4212798949262331, 0.20390904320016326, -0.37079388523806434, 0.1173969948974031, -0.308498673159207, 0.3452485520526712, -0.19661860551171656, -0.4629204769210305], -45.28518408583075, 4, DynamicHMC.DoubledTurn, 0.999891759619157, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1768945711130085, 0.24796386766145734, -0.21194495989824189, -0.3441168381380347, 0.21011734792094236, 0.19897679958533265, 0.1741277909045132, -0.13789981607361576, 0.2615319735393589, -0.012236789310341473, 0.13889157109826222, -0.13385074899191993, -0.47970750678346324], -44.44782667243474, 4, DynamicHMC.DoubledTurn, 0.9825275922417677, 15), NUTS_Transition{Array{Float64,1},Float64}([1.207706553803842, 0.260921443911807, -0.2174216498018278, -0.1625814170790077, 0.23530340682256815, 0.10910507581554921, 0.13552743505031387, -0.1379582029560707, 0.006897144747406464, -0.12307778028015424, 0.05725088009835897, -0.17804737818952096, -0.4718122398010087], -42.960827086050216, 4, DynamicHMC.DoubledTurn, 0.9647843569408643, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9949106593278162, 0.2611524593513159, -0.2093303442709857, 0.14630815555030274, -0.3512606984892413, 0.40345549822449356, 0.0987830374387492, -0.3502064621173563, 0.2654982782962559, -0.08400677690767933, 0.3636206349737966, 0.0499668401480023, -0.44980532785296024], -42.5228674543757, 4, DynamicHMC.DoubledTurn, 0.9930275975739329, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9686178070299973, 0.28897657294838414, -0.2045741598998719, 0.05693967141963661, 0.3551482216989071, 0.23268400671563266, -0.09034749911431142, -0.30594752276028625, 0.029498061467359733, -0.30538058188552886, 0.14822826138242856, -0.3621445210956279, -0.5290355310377909], -41.45969152740284, 4, DynamicHMC.DoubledTurn, 0.948822224467923, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7540459281295657, 0.31119947761919337, 0.24125968210856497, 0.015005630200517968, 0.008948956191026286, 0.20824297262011524, 0.01190214252861128, -0.27309378964976644, 0.07028911928726608, -0.27707546913675873, 0.051049329203224365, -0.3220442586537156, -0.46859615290979206], -41.43138162052844, 4, DynamicHMC.DoubledTurn, 0.999266706929581, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.42924545983686524, 0.32907288321699274, -0.17407837729999395, 0.12438511564016912, -0.11381309395282627, 0.4542619526690819, -0.14048934608317198, -0.43507380231544257, 0.20172003167984628, -0.30719778453560437, 0.41887225609858925, -0.1580376414156861, -0.5443488775484058], -43.33463243882631, 4, DynamicHMC.DoubledTurn, 0.8384317948151874, 15), NUTS_Transition{Array{Float64,1},Float64}([1.698195808132424, 0.21200937415481463, -0.14618778358185572, 0.015196350031172232, 0.1037775135806915, 0.21221114300159055, 0.020365271456365693, -0.24734925154641374, -0.1264619160934907, -0.11914743345251133, -0.0016265195625755902, -0.0596213071555064, -0.32551936150072397], -41.02201089279468, 4, DynamicHMC.DoubledTurn, 0.9135605311323135, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2220022005584559, 0.24507959652323552, -0.027619935272347414, 0.01084803935518658, -0.01552959795801221, 0.32590455112271194, -0.031045697159662565, -0.21564137651926296, 0.031254499740158134, -0.044869848618869765, 0.06526135282798426, -0.06985985983137108, -0.37719532783836673], -37.63229469644351, 3, DynamicHMC.DoubledTurn, 1.0, 7), NUTS_Transition{Array{Float64,1},Float64}([1.5753646378769295, 0.2242662424079573, -0.11957892602355102, -0.04407657438725275, -0.04642745004986736, 0.15613092054792904, -0.07407366041383832, -0.2200256219218933, 0.16524299058281078, -0.009903058243649617, 0.06992438785404312, -0.13538309521377828, -0.36361157932396565], -35.38192007910285, 4, DynamicHMC.DoubledTurn, 0.990032913976343, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0304158902522116, 0.27335539261847, -0.051667502648462496, 0.009728542138031468, -0.08070758263381403, 0.25710965104460487, -0.020385044526321394, -0.030978062011003553, 0.10913905667937279, -0.2058286834691762, 0.2307884000933356, -0.009222757461367309, -0.377608483977268], -34.959131652244494, 3, DynamicHMC.AdjacentTurn, 0.6499826529925581, 15), NUTS_Transition{Array{Float64,1},Float64}([0.46558990061750893, 0.32137310301266236, -0.02049412301686721, -0.07117099149999889, 0.07849727194700225, 0.2381431401407036, -0.0013534094315442568, -0.10574270975515604, 0.1276263109976183, -0.26361784803292815, 0.08626371829684377, -0.08689957296881985, -0.3568523117919587], -37.353239445752486, 3, DynamicHMC.AdjacentTurn, 0.9776564433087214, 15), NUTS_Transition{Array{Float64,1},Float64}([2.0469651788538568, 0.15911433620159673, -0.41114595636013257, 0.13444653496631756, -0.27353536088492186, 0.22822305976303603, 0.12067320534336053, -0.07995287967537726, -0.0004456442678824647, 0.06960280758079473, 0.4707640208363739, 0.09393700151595077, -0.5368488439848239], -43.68077208475826, 3, DynamicHMC.AdjacentTurn, 0.7881287622951115, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7514094647794183, 0.1811744649121535, -0.14218980916237534, 0.12065093615291875, -0.15197358367144762, 0.5587984662398722, 0.08664240193968038, -0.35689010815335587, 0.16912519461120648, -0.05252350924712062, 0.37709295547096255, 0.3021057630695294, -0.5524319166158137], -42.45297165740589, 4, DynamicHMC.DoubledTurn, 0.9992426209946778, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8543290230830277, 0.30644693418923974, -0.3357184044634619, 0.022021494875181735, -0.3785467410329996, 0.12173717319917107, -0.14993836184293755, -0.03251878947889193, -0.07330780941330234, -0.23444949452140615, -0.10363410326486804, -0.4579996734006207, -0.5095681759660534], -43.021550444153725, 4, DynamicHMC.DoubledTurn, 0.9645091218108836, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7703073260825234, 0.3077911163841414, -0.4089009314333994, -0.10024385949393029, -0.11962972179125915, 0.17024687036967534, 0.00971969810627503, -0.4795473165042067, -0.09889667272768496, -0.09648233962355392, 0.22558227211949816, -0.3113454537968055, -0.560354004182895], -44.27459545997976, 4, DynamicHMC.DoubledTurn, 1.0, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.25
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6724496838495895, 0.07500863735956068, 0.2260807861292864, 0.20998961042482203, 0.18978451937078952, 0.1938830561372419, 0.1636802353695794, 0.19786700181445854, 0.16503473071039532, 0.1799965487669012, 0.15330101317997658, 0.2442014903693117, 0.10469617271676172]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.15674493152025787, 0.367138343212948, -0.06746489666667947, 0.21796564365518456, -0.02591989344283227, 0.4621877611629565, 0.2580607206930245, -0.1375687222263437, 0.12130358406442021, -0.028769084437256894, -0.10716443380973115, -0.49259658367838366, -0.5591016052292903]   
 [2.0408168005251333, 0.15327868601141928, -0.2945616970118442, -0.11031917040670876, 0.06682792921866301, 0.3004382667061548, 0.0233704755169943, -0.6662904647518931, 0.19490176027608722, -0.19556492515847926, 0.6518561791379229, 0.3438572053735627, -0.5208677307115624]        
 [0.5407017676736741, 0.31403668533826246, -0.3211091809743872, 0.13735239412133382, -0.1292734578549295, 0.4001814636916023, 0.43656936264259505, -0.4529518201978017, 0.21075815245940746, -0.3513903004599171, 0.34560756426616984, -0.17928949963778784, -0.5516221519334988]      
 [1.6449900522549563, 0.225536153686227, -0.21395201139993744, -0.17750789400272748, -0.02236395751399662, 0.13342366995216154, -0.31907057429219715, -0.0055613277831631155, 0.10034922450511431, 0.012752906598789783, 0.13381828641235266, -0.07245748056381845, -0.460163655090165]
 [0.6888341393595128, 0.286910955312758, -0.15711686053036858, 0.29285879090750655, -0.07874357577231222, 0.4212798949262331, 0.20390904320016326, -0.37079388523806434, 0.1173969948974031, -0.308498673159207, 0.3452485520526712, -0.19661860551171656, -0.4629204769210305]        </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.26520091317331845</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 838.658  815.9  823.55  1000.0  …  723.359  651.953  600.127  287.117</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.91, min/25%/median/75%/max: 0.0 0.89 0.96 0.99 1.0
  termination: AdjacentDivergent =&gt; 0% AdjacentTurn =&gt; 6% DoubledTurn =&gt; 94%
  depth: 1 =&gt; 0% 2 =&gt; 0% 3 =&gt; 9% 4 =&gt; 90% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1030191917206749, 0.2613225895497186]                                                                                                                                                                              
  [-0.19505688007062255, 0.04785169721269586, -0.046571574377711866, 0.3016358977308746, 0.03220510466710948, -0.2949397068596643, 0.13288961899914742, -0.16871810182467786, 0.25048726844208685, -0.09363385511121668]
 0.26520091317331845                                                                                                                                                                                                    </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
