<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-1765.3345558132273</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.1131285773728636,0.2614826278664013, ...]
 * Minimum: -1.300838e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 1.79e-10 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -2.67e-07 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 1.97e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 840629389
 * Gradient Calls: 840629389</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.1131285773728636    
  0.2614826278664013    
 -4.236259554846081e-13 
  1.9196648242076584e-13
 -1.998781587701897e-14 
  1.3941687547020327e-12
  3.634743719315258e-13 
 -8.181048738712183e-13 
  8.242235774824736e-13 
 -3.295749849409801e-13 
  1.730364133123645e-12 
  1.0501324142474847e-11
  0.00010164812128615416</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.5779185518439883, 0.31345010904301707, -0.201695334405451, 0.1986304526671412, -0.12004649838726333, 0.21312125594020404, -0.05783680000743795, -0.2928181146687213, 0.1473544556984783, -0.1823123156172271, 0.20074466334341992, -0.14747229481489302, -0.374312326766327], -43.73385526426729, 3, DynamicHMC.AdjacentTurn, 0.9243586914039099, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3403613046302818, 0.23528314719440638, 0.0489262476419308, -0.06838416377135773, 0.0469213803694911, 0.2677690346298572, 0.09143045914292564, -0.0934447729791739, 0.04296610740978944, -0.10394295718404432, 0.2031641191790323, -0.10564621839948637, -0.40392820198496127], -37.42104982464615, 4, DynamicHMC.AdjacentTurn, 0.9518324915762979, 23), NUTS_Transition{Array{Float64,1},Float64}([1.4496583138141486, 0.23489685932469995, 0.1607215345615109, 0.12261062321741975, -0.08083883434044281, 0.25514127733928726, 0.026177591457035722, -0.004254493666936129, 0.11535100362126582, -0.1075977841340544, 0.15949403577795607, -0.05758385002710012, -0.3860053385400809], -40.83099179808913, 3, DynamicHMC.AdjacentTurn, 0.6158207325646179, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6582208870784245, 0.292106456011403, -0.4667224618015567, 0.1335313334312173, 0.1411952524833817, 0.536455745947053, 0.16840065226736736, -0.47093359710331095, 0.14966882359049416, -0.22335214264678174, 0.4217850562098696, 0.04384894432881552, -0.638543545196171], -45.11665798552267, 4, DynamicHMC.DoubledTurn, 0.9783248296770449, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2934240908709036, 0.254063333254877, -0.3876909483623232, 0.15960547123290647, -0.44926970426066953, 0.21144652122277022, -0.04491716183383145, -0.0017462327741459755, 0.05588400509790371, -0.082417889338827, 0.18660141693466584, -0.24716130810064704, -0.4660784643926063], -43.91615573579129, 4, DynamicHMC.DoubledTurn, 0.8908887011199373, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4769360878341045, 0.21452059095773524, -0.09214038458714927, -0.2004863927877234, 0.24584386783299128, 0.371101856817344, 0.11068353413585622, -0.3833005285777009, 0.0612049775859326, -0.1739621277117469, 0.38872351952338413, 0.09528768655428588, -0.48270570226481396], -42.82504436493865, 4, DynamicHMC.DoubledTurn, 0.9243212984022325, 15), NUTS_Transition{Array{Float64,1},Float64}([2.1757027492835683, 0.14826812389142752, -0.41846816958341654, -0.020967178352320308, -0.2882948141336452, 0.14383768854283974, -0.13672448911375273, -0.10012428131238067, 0.2111734330433272, -0.4812440754349553, 0.22821742419277, -0.060044801667395405, -0.502023407362478], -44.74823404763633, 4, DynamicHMC.DoubledTurn, 0.7701704576445518, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9216018362430218, 0.17287609322630543, -0.2749902645459481, -0.02734747648433354, -0.17282018661569096, 0.32189870564069334, -0.13823396446652483, -0.1590252748733963, 0.2000412592595193, -0.431289765828753, 0.25716655111588343, 0.10527664972717403, -0.5326543096472337], -47.58756533520183, 3, DynamicHMC.DoubledTurn, 0.8590732774342461, 7), NUTS_Transition{Array{Float64,1},Float64}([0.16431622871925583, 0.35438756958176215, -0.07226691186576391, 0.0732017079479639, -0.04152086636985293, 0.25937785227470794, 0.22686433740546744, -0.4068374342558367, 0.14534467763634276, 0.1244529374177136, 0.2791472454428821, -0.36616235491961463, -0.5067676130994374], -44.101759638488105, 4, DynamicHMC.DoubledTurn, 0.8241068785954162, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5597042943576194, 0.21268090075414645, -0.3047493413942385, 0.08817771800936455, -0.019329631778342234, 0.39891863410109996, -0.09580915854698174, 0.04021701285778421, -0.03307479115336512, -0.3166686264907007, 0.24332762195210272, 0.10285364235350405, -0.4204130181508278], -43.66051517695405, 4, DynamicHMC.DoubledTurn, 0.9694654800246033, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.9853737362773665, 0.2816371816934035, -0.48383353351975994, -0.1887798955168506, -0.3528993126876325, 0.15070221499458272, 0.2778672808651575, -0.18724676277921676, -0.04030740083899782, -0.32986455502149975, 0.1718316066075773, -0.34403928561254327, -0.5649143372242895], -44.47510617956609, 4, DynamicHMC.DoubledTurn, 0.9180719128092026, 15), NUTS_Transition{Array{Float64,1},Float64}([0.687495245217133, 0.3186982919934307, -0.3144795710768306, 0.3347465452154941, -0.3233719134922548, 0.20123273605955788, 0.17700538108628744, -0.436457312401593, -0.27071954769337414, -0.5583787485884075, 0.23064304516644019, -0.34952967960971937, -0.687560203289997], -48.5815373489332, 4, DynamicHMC.DoubledTurn, 0.9429745552182724, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.4107383683377497, 0.42545525908024495, 0.25395047707320917, 0.31373527476229607, 0.37104571501568784, 0.4068291269330991, 0.12704149490892974, -0.35123906560504903, 0.25229711108437186, -0.25063218571495294, 0.053769780484393404, -0.7653178939856595, -0.5996230621609847], -47.406526561538165, 4, DynamicHMC.DoubledTurn, 0.8345420966326447, 15), NUTS_Transition{Array{Float64,1},Float64}([6.477821414720979, -0.3286145203755112, -1.5280575979865685, -0.8719615246966376, -0.7783998426871063, 0.3217712996630985, -0.09978270151752065, -0.43044667841567563, 0.09679033429689671, -0.07322792704077691, 1.0264865642391658, 1.8031449161778905, -0.8470292250898876], -58.75798516845898, 4, DynamicHMC.AdjacentTurn, 0.7835004307462308, 23), NUTS_Transition{Array{Float64,1},Float64}([4.990470697599494, -0.14888614586901117, -1.426298257159606, -0.6843531288032684, -0.596213792678353, 0.12462303663105292, -0.31576183652700013, -0.5658713657310039, -0.13343410022082217, -0.11964865576488642, 0.774198490971825, 1.2302809694892058, -0.8306574017964161], -59.22547141407449, 4, DynamicHMC.DoubledTurn, 0.8763842586534125, 15), NUTS_Transition{Array{Float64,1},Float64}([3.6563207982169574, -0.015601528354017409, -0.9020032172933493, -0.6542728069653396, -0.43412792412736706, 0.14714913612891303, -0.06846353947937892, -0.5225692948670396, 0.2551059037787803, -0.3430962234940617, 0.2164472639769618, 0.7702007474419091, -0.7209165044103826], -51.06376367751338, 4, DynamicHMC.DoubledTurn, 0.9991777372185908, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8425212517474425, 0.18892147373131707, -0.48645234996174314, -0.0958658021619431, -0.19379770537303462, 0.39994966044341407, 0.058450053251733844, -0.2946879860669973, 0.15826290499644513, 0.16891670123161653, 0.39369530245917345, -0.07476005123551041, -0.5407806255503134], -48.111597390254424, 4, DynamicHMC.DoubledTurn, 0.9957164107029974, 15), NUTS_Transition{Array{Float64,1},Float64}([0.23879013778675828, 0.3574755351494435, -0.0013978108182425841, 0.17194373344567565, -0.08378449850465373, 0.22999248305896364, 0.03132322484933901, -0.26926331536051906, 0.19165598590754723, -0.4065190524851267, 0.1613567336535176, -0.243580186575545, -0.43527400790294096], -44.10095308413756, 4, DynamicHMC.DoubledTurn, 0.7438748001980583, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3657630378484087, 0.22686504022760373, -0.33289953422086227, -0.01937437372573434, -0.01957571992368149, 0.21246138920673124, 0.42904829496917324, -0.31970278246911327, 0.24421206077637295, -0.3855259946886378, 0.5474688259419327, -0.018634234987874143, -0.5093279969210739], -44.10053084410253, 4, DynamicHMC.DoubledTurn, 0.9494727831611705, 15), NUTS_Transition{Array{Float64,1},Float64}([0.44407818654129194, 0.3364773806231487, -0.09474673792016973, 0.15122074266800906, 0.09957451683704943, 0.6263464094765915, -0.3095209865694714, -0.4007817156197103, 0.14399792029467864, 0.028245610102220937, -0.07254013892965358, -0.3300531258777414, -0.5720072939366458], -46.3952860269712, 4, DynamicHMC.DoubledTurn, 0.9467939548157899, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.288
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6748742303188623, 0.07489180486438722, 0.22936420606381713, 0.20623962772535595, 0.17426242016066754, 0.18802306063037053, 0.16672391422180877, 0.20663062611670563, 0.17418246254377323, 0.16455386689660062, 0.16339391829723499, 0.23921193900549317, 0.11000617121510678]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.5779185518439883, 0.31345010904301707, -0.201695334405451, 0.1986304526671412, -0.12004649838726333, 0.21312125594020404, -0.05783680000743795, -0.2928181146687213, 0.1473544556984783, -0.1823123156172271, 0.20074466334341992, -0.14747229481489302, -0.374312326766327]     
 [1.3403613046302818, 0.23528314719440638, 0.0489262476419308, -0.06838416377135773, 0.0469213803694911, 0.2677690346298572, 0.09143045914292564, -0.0934447729791739, 0.04296610740978944, -0.10394295718404432, 0.2031641191790323, -0.10564621839948637, -0.40392820198496127]    
 [1.4496583138141486, 0.23489685932469995, 0.1607215345615109, 0.12261062321741975, -0.08083883434044281, 0.25514127733928726, 0.026177591457035722, -0.004254493666936129, 0.11535100362126582, -0.1075977841340544, 0.15949403577795607, -0.05758385002710012, -0.3860053385400809]
 [0.6582208870784245, 0.292106456011403, -0.4667224618015567, 0.1335313334312173, 0.1411952524833817, 0.536455745947053, 0.16840065226736736, -0.47093359710331095, 0.14966882359049416, -0.22335214264678174, 0.4217850562098696, 0.04384894432881552, -0.638543545196171]          
 [1.2934240908709036, 0.254063333254877, -0.3876909483623232, 0.15960547123290647, -0.44926970426066953, 0.21144652122277022, -0.04491716183383145, -0.0017462327741459755, 0.05588400509790371, -0.082417889338827, 0.18660141693466584, -0.24716130810064704, -0.4660784643926063] </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.27673877632672317</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 956.563  956.925  973.654  1000.0  …  689.699  708.668  874.686  352.145</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.9, min/25%/median/75%/max: 0.0 0.87 0.95 0.98 1.0
  termination: AdjacentTurn =&gt; 8% DoubledTurn =&gt; 92%
  depth: 2 =&gt; 1% 3 =&gt; 15% 4 =&gt; 83% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1351007141582599, 0.2577623367036967]                                                                                                                                                                             
  [-0.20062848503406475, 0.038578228419382674, -0.056330738859200494, 0.309460537537422, 0.02948014898528888, -0.3086441177873927, 0.12956249562525632, -0.16822599255135295, 0.2587549397539101, -0.08986685877365899]
 0.27673877632672317                                                                                                                                                                                                   </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
