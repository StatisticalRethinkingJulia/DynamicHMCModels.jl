<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-2161.184334486765</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.080129588281653,0.2648129260383246, ...]
 * Minimum: -1.285874e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 3.03e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -4.50e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 1.84e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 1012857118
 * Gradient Calls: 1012857118</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.080129588281653     
  0.2648129260383246    
  5.2365189910230485e-14
 -2.432144574837437e-14 
  3.585627591259729e-15 
 -1.722079971034326e-13 
 -4.215474250625094e-14 
  1.0544341135980156e-13
 -9.86701740185164e-14  
  4.678262603946223e-14 
 -2.0760738501110347e-13
 -1.361357887494371e-12 
  0.00010908750628298095</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.366421757439748, 0.25190626305185276, -0.6088475710472323, -0.1040691455033758, -0.2382328358913705, 0.21316918630470436, 0.0507922870333494, -0.4769994846014439, 0.09635028040409248, -0.17013649106257248, -0.1022771958812786, -0.2634492710143084, -0.6058645557050679], -43.45956897136242, 4, DynamicHMC.DoubledTurn, 0.8352843661496833, 15), NUTS_Transition{Array{Float64,1},Float64}([1.494981524951919, 0.22655738946418558, -0.25653666309475154, -0.28816299995196043, -0.4286543396639968, 0.18521541470862132, -0.3028968013726896, -0.25219089148326707, 0.10853171348708432, -0.1763523152692637, -0.011214796922428591, -0.018597243505576615, -0.48498758443716], -44.652600356368175, 4, DynamicHMC.DoubledTurn, 0.9474149192148308, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8362287350477041, 0.2954431590414605, -0.07185772042731806, 0.4829385151734703, 0.17005874484272004, 0.3357177474987272, 0.20656739362312582, -0.5174303515683164, 0.17040190665017457, -0.2948593563249239, 0.45629311615850393, -0.21519672559062394, -0.4966686260366252], -44.71078795837372, 4, DynamicHMC.DoubledTurn, 0.8777971471468325, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2927381243273965, 0.22560172699249886, -0.45498990886723445, 0.194485177640552, -0.13518254595508766, 0.4264922755610664, 0.16511363684068922, -0.3229046724608937, 0.43217208871032803, 0.025671185749084245, 0.6501854623010155, 0.1170658965166942, -0.5888482822250958], -45.417992932899566, 4, DynamicHMC.DoubledTurn, 0.9770614624961719, 15), NUTS_Transition{Array{Float64,1},Float64}([1.270899491537573, 0.22300574351701827, 0.1724186018122505, 0.03581612011257381, -0.07272271912222025, 0.4415069733890321, 0.3035999176714704, -0.09996646088729769, 0.1410581467818114, -0.09499285689178841, 0.5018776129601709, 0.22699408672102261, -0.4358330754309006], -44.087829758198495, 4, DynamicHMC.DoubledTurn, 0.9863251837780671, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5080269833008482, 0.3198059324293293, -0.23465447176009013, -0.08310380174532264, 0.19145641825900556, 0.6590389867315511, -0.019301351019201815, -0.40202510376906103, 0.22118544562194342, -0.41682327799486646, 0.23732351380116973, -0.3352805668049878, -0.6473748454049846], -45.35814125189019, 4, DynamicHMC.DoubledTurn, 0.946929626871118, 15), NUTS_Transition{Array{Float64,1},Float64}([0.12759194769240428, 0.38465599836147624, -0.39214774374795397, -0.057768988496655835, 0.00704590393518028, 0.2885049497178371, -0.0016886091713878082, -0.342587104328785, 0.05849251861213361, -0.5600066355578751, 0.0965056604714741, -0.4063348917472513, -0.5313501558860559], -45.42422804033714, 4, DynamicHMC.DoubledTurn, 0.9926439779604489, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9882190875074823, 0.17948970599139127, -0.5905231931327544, 0.1968794323078761, -0.5317839411445416, 0.20579453675757062, -0.2054473241371473, -0.520800475720258, 0.0029947883831493508, -0.060391385766243276, 0.16386256793509477, -0.06214517348975399, -0.5840330290727164], -48.240718041385044, 4, DynamicHMC.DoubledTurn, 0.7784308201056265, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9382138074052098, 0.1828848752538184, -0.188267510645037, 0.0004951773055068137, -0.31335819181423985, 0.34459340844355846, -0.2605627193393651, -0.5325324206492322, -0.011479716707991975, -0.11962674737479301, 0.15527653397784683, 0.045501134703235066, -0.5014439806197942], -43.958586238131225, 4, DynamicHMC.DoubledTurn, 0.9980893755105614, 15), NUTS_Transition{Array{Float64,1},Float64}([0.874120194098158, 0.28410555427912404, -0.07291912077312931, 0.08316278347540132, -0.009883200557883373, 0.27233614218137925, 0.24432860652061245, 0.01891343959762325, 0.23742556095368864, -0.16114508951739284, 0.3338734763847535, -0.1611720845058754, -0.46434068993179306], -42.36801573122648, 4, DynamicHMC.DoubledTurn, 0.7027878274900008, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.3273042448572951, 0.2525803021150719, -0.4325375983295997, 0.13947485943727914, -0.19931848577945585, 0.08962557271966301, 0.030597775983156314, -0.3435642342501254, 0.09216172093950709, -0.05794823739642178, 0.14307502032014374, -0.22833210858320022, -0.4634761802444933], -39.51568630969183, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5231869568197564, 0.2950635191726248, 0.04619023504229179, 0.09528700231547221, 0.4458515682202915, 0.5444511832517794, 0.2811660887838795, -0.46957873472712924, 0.26132524556090203, -0.20744144586959182, 0.5933717538845125, 0.13425185908959622, -0.6175183216228519], -44.97327573591245, 4, DynamicHMC.DoubledTurn, 0.9667277579635332, 15), NUTS_Transition{Array{Float64,1},Float64}([1.32546438152573, 0.25624516638626177, -0.10919146857806304, 0.016080683833040187, -0.2060472806670341, 0.013881751158058245, 0.006108669018440593, -0.13209814455051816, 0.23240398353948655, -0.09816590561190712, -0.08618827136256835, -0.3427206702792734, -0.40658347986761445], -46.63750926531262, 4, DynamicHMC.DoubledTurn, 0.9991023900207218, 15), NUTS_Transition{Array{Float64,1},Float64}([2.0501984082743183, 0.16026184534549784, -0.21649744562916057, -0.0379127707329245, -0.14149121069016213, 0.017197044186420082, 0.00794998582667341, -0.06560555203810634, 0.2357343979020169, 0.05702036404081009, -0.021474603848755554, -0.007140093627622829, -0.41236867848145575], -41.997298730581925, 3, DynamicHMC.DoubledTurn, 1.0, 7), NUTS_Transition{Array{Float64,1},Float64}([1.1634482910519963, 0.25040890653255005, -0.18421332140730304, -0.1189207288150381, -0.004318351224173001, 0.41075154111648815, 0.05951684900854465, -0.4345642361945558, -0.0740771509011004, -0.18804901348745973, 0.3900185334829202, 0.17758033872696727, -0.48798874089409694], -43.95478293100738, 4, DynamicHMC.DoubledTurn, 0.9847375549497015, 15), NUTS_Transition{Array{Float64,1},Float64}([0.3931881538766337, 0.34363344493094483, 0.0964187742918354, -0.07132728974745643, 0.022898171302672226, 0.26537848267450215, 0.16968604826131625, -0.1953601726471737, 0.1831071724563989, -0.30666738467255955, 0.23040617230152008, -0.27212972139631175, -0.4863634851002475], -42.40343985445646, 4, DynamicHMC.DoubledTurn, 0.9557872679756458, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9107244039688749, 0.16870706415469944, -0.32369283426073486, 0.165246669123542, -0.17773090214483261, 0.29114388430755894, -0.1667850319153601, -0.3219623105834318, 0.006497075035662759, 0.036479194664145446, 0.18486735602054097, 0.14483739509289276, -0.42062089788430373], -39.60656829916803, 4, DynamicHMC.DoubledTurn, 0.9748694345940715, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6144290168463619, 0.3292725862660392, -0.004487078169920049, -0.22750358509321203, 0.04409487485905805, 0.1350867117748114, 0.19907156015032273, -0.20150430869791291, 0.17604942005976149, -0.3532561744131073, 0.21257398879474687, -0.3206220050577686, -0.5070862658698753], -42.17058512543459, 4, DynamicHMC.DoubledTurn, 0.9265376455579636, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5546534510233446, 0.3117359475307649, 0.14130887726383987, 0.26683599878472175, 0.017762584177229868, 0.3323912196565302, 0.40502217327732054, -0.14341125213347575, 0.15597758716168666, -0.04758737150638483, 0.22309091209710277, -0.10791988057622914, -0.49727277219800825], -43.52631005672013, 4, DynamicHMC.DoubledTurn, 0.9761564098516704, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7787429324377135, 0.18754509022456828, -0.4963737276873542, -0.13403428507002244, -0.17655341682742304, 0.3565802181940508, -0.34515334964793487, -0.5201687256083142, 0.08981619009562052, -0.25354175031957454, 0.3908303177137903, -0.06528849133231536, -0.5541775896988578], -44.21680582077352, 4, DynamicHMC.DoubledTurn, 0.8386441890933074, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.237
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.7069756478149004, 0.07897131634488795, 0.22455539825683282, 0.20369342946006416, 0.17459302886631517, 0.1821516279000351, 0.16447121324206876, 0.190196767091643, 0.162887487073203, 0.16199975012060996, 0.15566104176506568, 0.2747628273837713, 0.10146089715651789]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.366421757439748, 0.25190626305185276, -0.6088475710472323, -0.1040691455033758, -0.2382328358913705, 0.21316918630470436, 0.0507922870333494, -0.4769994846014439, 0.09635028040409248, -0.17013649106257248, -0.1022771958812786, -0.2634492710143084, -0.6058645557050679]     
 [1.494981524951919, 0.22655738946418558, -0.25653666309475154, -0.28816299995196043, -0.4286543396639968, 0.18521541470862132, -0.3028968013726896, -0.25219089148326707, 0.10853171348708432, -0.1763523152692637, -0.011214796922428591, -0.018597243505576615, -0.48498758443716]
 [0.8362287350477041, 0.2954431590414605, -0.07185772042731806, 0.4829385151734703, 0.17005874484272004, 0.3357177474987272, 0.20656739362312582, -0.5174303515683164, 0.17040190665017457, -0.2948593563249239, 0.45629311615850393, -0.21519672559062394, -0.4966686260366252]     
 [1.2927381243273965, 0.22560172699249886, -0.45498990886723445, 0.194485177640552, -0.13518254595508766, 0.4264922755610664, 0.16511363684068922, -0.3229046724608937, 0.43217208871032803, 0.025671185749084245, 0.6501854623010155, 0.1170658965166942, -0.5888482822250958]      
 [1.270899491537573, 0.22300574351701827, 0.1724186018122505, 0.03581612011257381, -0.07272271912222025, 0.4415069733890321, 0.3035999176714704, -0.09996646088729769, 0.1410581467818114, -0.09499285689178841, 0.5018776129601709, 0.22699408672102261, -0.4358330754309006]       </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.27760922127518406</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 830.244  774.888  574.816  1000.0  …  839.033  495.272  622.206  220.016</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.93, min/25%/median/75%/max: 0.0 0.91 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 8% DoubledTurn =&gt; 92%
  depth: 2 =&gt; 0% 3 =&gt; 6% 4 =&gt; 93% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.0993052221623898, 0.2620150074250993]                                                                                                                                                                              
  [-0.1855924962733288, 0.03212244607437822, -0.045099761971900916, 0.31154938998853043, 0.039652627338493056, -0.3132224730297432, 0.13757202725895465, -0.16942710114212353, 0.25977742022357697, -0.1037782416776745]
 0.27760922127518406                                                                                                                                                                                                    </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
