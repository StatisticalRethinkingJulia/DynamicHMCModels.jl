<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-2549.517740370938</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0969110772650312,0.2631290224742766, ...]
 * Minimum: -1.298738e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 6.30e-09 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -9.47e-06 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 1.95e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 897402993
 * Gradient Calls: 897402993</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0969110772650312    
  0.2631290224742766    
 -1.1111818646521624e-13
  4.071502490532115e-14 
 -1.887310282667373e-14 
  3.295028586910536e-13 
  6.625303584810919e-14 
 -2.288853067108048e-13 
  1.7623810768871748e-13
 -1.1933335888653862e-13
  3.814798683462545e-13 
  2.2003329983123006e-12
  0.00010251756253017508</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.1640897228361176, 0.268258097259847, -0.43806076677420275, 0.06514008725874025, -0.09862002144704438, 0.09558029870555196, -0.047271730889807774, -0.4475330978973384, -0.1940562388880348, -0.24281020106277776, 0.05574629823798026, -0.2767796983580409, 0.4561611185802229], -40.482171018976146, 4, DynamicHMC.DoubledTurn, 0.9931062310997949, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7374670140229431, 0.2849089559906477, -0.057771417987507, 0.12339463829688513, -0.036172391737825466, 0.37988133097906507, 0.2590492029125035, -0.15385633791969963, 0.20184032120019363, 0.023837849484675065, 0.3855424796396233, -0.03274200442703563, 0.454007436828082], -37.409712262691, 4, DynamicHMC.DoubledTurn, 0.9918216237871854, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7180160637038931, 0.28749582503330423, 0.027181549566050893, 0.16653361726033844, 0.030667515705315406, 0.48550439645148036, 0.1974559173042548, -0.17541712828532946, 0.27874689234012756, 0.10017359897773793, 0.3945866340779012, -0.03286471371799739, 0.4380448871658696], -37.98661036144854, 3, DynamicHMC.AdjacentTurn, 0.8880051471711926, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0680336134818669, 0.26755304415787323, -0.3715466294666281, 0.24846574304250058, -0.19318800247030676, 0.24878215829068645, -0.043395316133530155, -0.20368195060042305, 0.20161911676832825, -0.3017610665845883, 0.10282175375902528, -0.2851729593431759, 0.5548346304655134], -38.977100766861625, 4, DynamicHMC.DoubledTurn, 0.9406650939646936, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7317531299301006, 0.3054267822613897, 0.11722402125963957, -0.09799915495930017, 0.05695017376589719, 0.11533307900113032, -0.0985403433452747, -0.27098015342586923, -0.08283640342499227, -0.153235250879412, 0.1493831574700109, -0.23850237410622024, 0.39643264714752013], -40.69139788124933, 4, DynamicHMC.DoubledTurn, 0.9935377190409447, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6487593771051585, 0.2001358675656717, -0.3689413288383743, 0.08150312359172625, -0.1366529690578646, 0.12428554350716015, 0.08334486192731747, -0.09548952499917354, 0.19212033391311686, -0.11938632505738865, 0.14640644959367644, 0.017335377223958094, 0.39019964955003306], -38.493495187004896, 4, DynamicHMC.DoubledTurn, 0.9790658703342828, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2426936639854862, 0.24068673341830457, -0.02029258532597299, -0.29027092504471486, -0.030059601467553067, 0.2831423773219044, -0.005860484615394331, -0.5663172283995583, -0.0513856408911038, -0.20077889241025323, 0.37296727043292177, 0.02544228510009912, 0.5252910153364322], -39.72020152678002, 4, DynamicHMC.DoubledTurn, 0.9315228464862343, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0470753853127202, 0.25610391030984847, -0.30552819771320017, 0.003090889474587924, 0.011487767942630539, 0.2662082829416112, 0.15920721399156118, 0.05677186444123912, 0.4002594685820742, -0.24219326197674956, 0.35758382447688497, -0.1540847096800321, 0.48895583810018606], -44.29858419349646, 4, DynamicHMC.DoubledTurn, 0.9945366195534889, 15), NUTS_Transition{Array{Float64,1},Float64}([1.294339069572731, 0.2452956593246159, -0.08802896084449707, -0.03367560420565133, -0.10733929764293723, 0.20528753408324696, -0.12242583014490373, -0.5447250528426365, -0.15214322257798069, -0.09917990609031167, 0.07852889498728834, 0.062199710673012984, 0.4155023664741997], -40.532667600062894, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6724899904223598, 0.28893338530767554, -0.29311395976493315, -0.01458698558206814, 0.026450948367817556, 0.4490149191879386, 0.24765680682623023, 0.170213675761806, 0.44123217311181007, -0.028967030095379542, 0.1850119042015906, -0.08554433937788969, 0.5206542616639958], -46.15351934661649, 4, DynamicHMC.DoubledTurn, 0.9714472960320869, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.8479770867432055, 0.16606910255547222, -0.41280811189681377, 0.07637341165423389, -0.08243448132784449, 0.3671746257400308, 0.2875517226553506, -0.3284403409989083, 0.20343296998867488, -0.061314724361789225, 0.4613872538098056, 0.28250400002868326, 0.5556610395059234], -39.06337684351828, 4, DynamicHMC.DoubledTurn, 0.9383208894343837, 15), NUTS_Transition{Array{Float64,1},Float64}([0.44347063318130797, 0.33441074304895524, 0.03746207946635492, -0.009977169486795601, -0.18190946208099593, 0.4230557712280605, -0.028048530912312068, -0.22362540813554455, -0.16659586517421712, -0.23189948794429033, 0.12761173917179386, -0.31290356297095734, 0.42432637184965005], -39.64779649784124, 4, DynamicHMC.DoubledTurn, 0.9873238613598339, 15), NUTS_Transition{Array{Float64,1},Float64}([0.18358404973825126, 0.3693634966248322, -0.04911530120341325, 0.10664938168773866, -0.26360396419640514, 0.4187610632857439, 0.07219012576216924, -0.3132505179299746, -0.12060373072906178, -0.22587254011667393, 0.17084694180664045, -0.3538276001805193, 0.4486658207342433], -42.18970868714141, 4, DynamicHMC.DoubledTurn, 0.9968039034149955, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7393430484110864, 0.3082114240932371, -0.07150613040522018, -0.013086548215042099, -0.22787038706110863, 0.26559588586913, -0.03538992885178393, -0.3868572504935878, -0.215846099813625, -0.17494019698233104, 0.1922683401505933, -0.3010557041026856, 0.46787161268932437], -39.82019382269999, 4, DynamicHMC.DoubledTurn, 0.9977365424176384, 15), NUTS_Transition{Array{Float64,1},Float64}([1.427409803273147, 0.21664354324644, -0.27605427594249526, 0.053742890125902304, 0.19324637044267287, 0.3702342292833797, -0.03674429798248491, -0.24800352792182728, 0.501824388197602, -0.12881086480226653, 0.22071050785571023, -0.012284738548934374, 0.4451419216760677], -42.10482621863803, 4, DynamicHMC.DoubledTurn, 0.9633968867707011, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6816181230910178, 0.3018059184215651, -0.2861751371475687, 0.35499498307092897, -0.25044114111207594, 0.29226251297763606, 0.096826782180955, -0.017067132929121338, 0.04358958153133366, 0.045458577707005246, 0.450329476770353, -0.03463755422566163, 0.5663665003971645], -43.65397864197657, 4, DynamicHMC.DoubledTurn, 0.9799328023576308, 15), NUTS_Transition{Array{Float64,1},Float64}([1.685551483877993, 0.21249803903361217, -0.12335394783808382, -0.2856177770605861, 0.04891116311965845, 0.242079389170728, -0.03074768116485033, -0.46999686917540995, 0.2037566823469425, -0.1574489530642137, 0.1395860640625003, -0.13449276135797744, 0.48342301999140336], -43.88799715459149, 4, DynamicHMC.DoubledTurn, 0.9860269329616105, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8748857421525691, 0.2881914397931828, -0.06440026934317897, 0.3416801813176311, -0.05765766646001494, 0.382451944905756, 0.08616704648128189, -0.1714389328215667, 0.26159057972812316, -0.23522980213329656, 0.048927050732389114, -0.07873437701907932, 0.4779721375470148], -41.55269402618291, 4, DynamicHMC.DoubledTurn, 0.9795632893928939, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9566280396175104, 0.2675169070601063, -0.39688010581686994, 0.18933147835909267, -0.0830360383288212, 0.39500846933032746, 0.3091565172365916, -0.5308219472629495, 0.4469716091803442, -0.36072192556002947, 0.197339314892277, -0.24760903294641143, 0.5208097933157073], -45.73382028350892, 4, DynamicHMC.DoubledTurn, 0.8393293479089535, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5289047958714854, 0.2229971464560793, -0.1113628159529419, -0.07483813441146589, 0.042351719597414, 0.16427351399904863, -0.2923890762918284, -0.1962039580747818, -0.09108195768061761, -0.11304171488458603, 0.13430919664048396, -0.062475764644390946, 0.44079059444285223], -46.08250444594012, 4, DynamicHMC.DoubledTurn, 1.0, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.23
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6444556522864354, 0.07356129601968668, 0.22907030546187548, 0.20028587922015847, 0.18308538826226844, 0.17062255154175815, 0.162847306452286, 0.19817199893906612, 0.16916667133807253, 0.18426104977645716, 0.1754141487410464, 0.2574218349929421, 0.11589149559085962]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.1640897228361176, 0.268258097259847, -0.43806076677420275, 0.06514008725874025, -0.09862002144704438, 0.09558029870555196, -0.047271730889807774, -0.4475330978973384, -0.1940562388880348, -0.24281020106277776, 0.05574629823798026, -0.2767796983580409, 0.4561611185802229] 
 [0.7374670140229431, 0.2849089559906477, -0.057771417987507, 0.12339463829688513, -0.036172391737825466, 0.37988133097906507, 0.2590492029125035, -0.15385633791969963, 0.20184032120019363, 0.023837849484675065, 0.3855424796396233, -0.03274200442703563, 0.454007436828082]    
 [0.7180160637038931, 0.28749582503330423, 0.027181549566050893, 0.16653361726033844, 0.030667515705315406, 0.48550439645148036, 0.1974559173042548, -0.17541712828532946, 0.27874689234012756, 0.10017359897773793, 0.3945866340779012, -0.03286471371799739, 0.4380448871658696]  
 [1.0680336134818669, 0.26755304415787323, -0.3715466294666281, 0.24846574304250058, -0.19318800247030676, 0.24878215829068645, -0.043395316133530155, -0.20368195060042305, 0.20161911676832825, -0.3017610665845883, 0.10282175375902528, -0.2851729593431759, 0.5548346304655134]
 [0.7317531299301006, 0.3054267822613897, 0.11722402125963957, -0.09799915495930017, 0.05695017376589719, 0.11533307900113032, -0.0985403433452747, -0.27098015342586923, -0.08283640342499227, -0.153235250879412, 0.1493831574700109, -0.23850237410622024, 0.39643264714752013]  </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.27248363440852746</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 489.63  471.753  718.242  1000.0  …  850.991  884.781  522.568  293.051</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.93, min/25%/median/75%/max: 0.02 0.91 0.97 0.99 1.0
  termination: AdjacentDivergent =&gt; 0% AdjacentTurn =&gt; 8% DoubledTurn =&gt; 92%
  depth: 2 =&gt; 0% 3 =&gt; 5% 4 =&gt; 94% 5 =&gt; 1%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1090806476596475, 0.2603522355236713]                                                                                                                                                                          
  [-0.18481769858822175, 0.03794071467463594, -0.04361270277405957, 0.3138364117251273, 0.04020349752018075, -0.3005569665895727, 0.13331706631184784, -0.1649699511116323, 0.2632380195515879, -0.0962299773405087]
 0.27248363440852746                                                                                                                                                                                                </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
