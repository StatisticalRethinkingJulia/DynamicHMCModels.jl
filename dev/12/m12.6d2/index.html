<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-1821.9872368436534</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.1099170951234005,0.2618123728253614, ...]
 * Minimum: -1.540616e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 3.33e-13 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -1.96e-09 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 6.61e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 684300259
 * Gradient Calls: 684300259</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.1099170951234005    
  0.2618123728253614    
  1.4008428058177816e-14
 -7.102725844780018e-15 
 -2.2033930875922876e-16
 -4.8598882694763634e-14
 -1.3820463086682007e-14
  2.6330979738498773e-14
 -2.973803451477446e-14 
  9.025704417257374e-15 
 -6.156813074133511e-14 
 -4.228014833871966e-13 
  3.0638043425410065e-5 </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.45746846109911843, 0.3164379308765803, 0.0632886575510025, 0.3240784663004544, -0.13540583134700696, 0.5346684916720377, 0.2410520053230055, -0.32339222874378365, 0.5307098389672537, -0.01867195571727269, 0.4936890369364493, -0.22505890499094916, -0.5515656309479953], -42.83587247705771, 4, DynamicHMC.DoubledTurn, 0.8721124505168544, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9241562968730342, 0.2823944504365753, 0.0028938566478407084, 0.2858208926331969, -0.21727994398379943, 0.44382082638829534, -0.01610465681014206, -0.6631336502654024, 0.2258036978805497, -0.2943311695062888, 0.42367727839411407, -0.2931996593025846, -0.574557677723828], -42.72679839357815, 4, DynamicHMC.DoubledTurn, 0.984675596019417, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.9479754885396527, 0.4740309483506141, 0.33591828372474775, 0.4419829596867388, 0.06262154275707693, 0.5077439537342601, 0.2803429290547902, -0.4363166600955839, 0.33338854589365313, -0.2960268289277932, 0.36331580070163044, -0.8028279481580387, -0.6957310317385097], -48.16949961713304, 4, DynamicHMC.DoubledTurn, 0.903241183342205, 15), NUTS_Transition{Array{Float64,1},Float64}([0.10224291204773628, 0.38217995790014586, 0.06537147647703807, 0.012673659382887045, 0.20986343077936748, 0.19618817025051213, -0.279397697049811, -0.6610139009650146, 0.19618476750323327, -0.5535403202292661, -0.030406311001941418, -0.7103469314610158, -0.6460970160257361], -48.151715791658646, 4, DynamicHMC.AdjacentTurn, 0.9435817686926102, 31), NUTS_Transition{Array{Float64,1},Float64}([1.8199117921028871, 0.18968359220228498, -0.548694376044441, -0.01939822317431721, -0.40952946634737414, 0.3625349596959859, -0.2716814405390069, -0.2278220674509228, 0.2475312559587354, -0.24546219399766897, 0.0695455457677246, 0.08216589367811883, -0.5694427585724877], -49.63566473589033, 4, DynamicHMC.DoubledTurn, 0.9935271478877585, 15), NUTS_Transition{Array{Float64,1},Float64}([1.666613393589171, 0.20054719716104846, -0.4542115435431856, -0.014443990409251109, -0.25115334482342927, 0.3583092246046622, -0.28132527663800416, -0.05113419379134379, 0.24759903991947052, -0.20249194951427302, 0.0893367378414914, 0.020067216006835704, -0.5029968643185849], -43.26780981059191, 4, DynamicHMC.DoubledTurn, 0.9684015036415767, 15), NUTS_Transition{Array{Float64,1},Float64}([1.135627498240531, 0.2630052708646091, -0.10880858680257192, -0.054628290677805, 0.11467380519782522, 0.24726536627805848, 0.3163630575187165, -0.5594589440181534, 0.10624098161042328, -0.2648489856638102, 0.2690083360977798, -0.21870267327017884, -0.5118264074377605], -42.74717225438899, 4, DynamicHMC.DoubledTurn, 0.9470762336496242, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5890799088604552, 0.20640249151795267, -0.16856162388066157, 0.07887715609949478, 0.11984152310282087, 0.4336783028946638, 0.20702078026487689, -0.33612065487367365, 0.105792119057108, -0.2693332082843684, 0.47410609040514606, -0.17714771377906502, -0.5380774425109237], -42.79690044933265, 4, DynamicHMC.DoubledTurn, 0.9972898822764331, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1146472307301045, 0.2593767535000676, -0.25566652571271653, -0.07108405672602457, -0.25711587174079675, 0.10937978759275495, -0.05012967517226307, -0.018229053065515595, 0.19094832088144165, -0.07888613705172737, 0.2220129925960193, -0.08494386793542943, -0.39804809169969996], -43.11800214758944, 4, DynamicHMC.DoubledTurn, 0.9166859844813705, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3042020037896869, 0.2352804721087576, -0.1674875552906036, 0.3280925812535269, 0.20350051506101105, 0.38274940974531363, 0.46055486931820067, -0.5318005305569438, 0.23466778816468564, -0.14035156051795003, 0.2195026451442402, -0.008249408301369165, -0.5964993796721305], -45.00934714052236, 4, DynamicHMC.DoubledTurn, 0.9358911867646188, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.9199071186158547, 0.2825342242727247, -0.08852714872537722, 0.002030436873741326, 0.03839212713865872, 0.36533637040371064, 0.19059414529942997, -0.16303906663705064, 0.25709511379611044, -0.42142117126010004, 0.20433287025430066, -0.0628281591950937, -0.4641396629870092], -44.92769900035911, 4, DynamicHMC.DoubledTurn, 0.9771946776988927, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9895665777908429, 0.2653067758927823, -0.1427548533368291, 0.12250929786908313, -0.06056281497383504, 0.4469695445423833, -0.08958067644331177, -0.37168184456862136, 0.014669852130688546, 0.03774986829313344, 0.2822835000930447, -0.09834437409106868, -0.42849037873344065], -38.199502333316325, 4, DynamicHMC.DoubledTurn, 0.9521454388265761, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7516023854155236, 0.19986396203453524, -0.09116149875832183, -0.22851485730721469, -0.10449137013910517, 0.17646958035743612, -0.1379420108034033, -0.3638059155198459, 0.3442606010905145, -0.2517438761222392, 0.20481875568821115, -0.0401392150638145, -0.5507119420352378], -40.97165106839338, 4, DynamicHMC.DoubledTurn, 0.9905527291408022, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8640549435170491, 0.2744687272232558, -0.08725711978627887, 0.269752594529499, 0.07964299909919284, 0.3207816475579249, 0.14079820975189156, -0.2913180581032506, -0.040673398775999944, -0.016716237886115995, 0.24890611080311922, -0.06881077512511383, -0.3617584932620895], -39.677158842310696, 4, DynamicHMC.DoubledTurn, 0.9279154280099339, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8149746770038696, 0.29228620840639213, -0.21829559530583015, 0.06167349370163912, -0.22861281568288477, 0.16765591074940778, -0.07811209598623842, -0.06226277440255666, 0.24863287196837108, -0.4015294754651758, 0.47408302731739294, -0.08364816345269518, -0.4941491826414163], -46.48044112940083, 4, DynamicHMC.DoubledTurn, 0.9726602826057859, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9287689033496016, 0.2696478084521703, -0.14366610191830093, 0.09066202695453972, -0.16797871936937792, 0.25434569251766453, -0.02923636454725644, -0.0480758303335695, 0.27492038626931975, -0.14970347579862775, 0.43457093820890563, 0.10435879634487527, -0.484458245891016], -42.023170879952644, 3, DynamicHMC.AdjacentTurn, 0.9221188032243257, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1138928387080271, 0.2579012298046663, -0.05897829121351705, 0.14422896220772163, 0.04259549157895621, 0.4204942058552864, 0.16554877938956256, -0.43473277349612555, 0.014070580890700124, -0.0987184106370381, 0.14385007913504816, -0.1804091000590836, -0.42564551681545276], -39.083645027729396, 4, DynamicHMC.DoubledTurn, 0.9235856043911274, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6707277066002495, 0.20533101269011175, -0.2837352396603808, 0.060128706334756324, -0.0882075628273658, 0.2443857171689638, -0.08163434472712058, -0.08478436831559229, 0.1543465336875775, -0.19557984271103515, 0.17657713823439924, 0.037636021046077585, -0.4306756105584455], -36.928773370409544, 4, DynamicHMC.DoubledTurn, 0.9720113974041664, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7462057691547825, 0.30297011354874015, 0.031198781498091098, 0.013778384389855774, 0.006099458300617916, 0.17044479052888092, 0.010352401925263903, -0.28608981449003673, 0.003216070561661904, -0.018253894076458332, 0.006655137771753776, -0.20750293415226753, -0.3371280750657844], -35.1809335685565, 4, DynamicHMC.DoubledTurn, 0.9845412530697041, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0648496568537056, 0.27814019868723777, -0.0749184421376377, 0.014420835396707991, 0.07066726055532016, 0.12231751544713049, 0.021589962815180733, -0.16551906553031115, 0.03154197731452193, -0.2716749004259008, 0.21270998571772712, -0.17607839287905708, -0.379538842181887], -36.40766945115257, 4, DynamicHMC.DoubledTurn, 0.9788697529860393, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.221
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.7181937198283143, 0.08171659283410083, 0.2349205218460932, 0.18351179098132628, 0.20825439642195132, 0.17819023512174897, 0.16905668789452802, 0.2313031347462536, 0.1740267681138409, 0.19427823225399196, 0.17869045964467886, 0.29254358834792477, 0.10443725556833529]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.45746846109911843, 0.3164379308765803, 0.0632886575510025, 0.3240784663004544, -0.13540583134700696, 0.5346684916720377, 0.2410520053230055, -0.32339222874378365, 0.5307098389672537, -0.01867195571727269, 0.4936890369364493, -0.22505890499094916, -0.5515656309479953]     
 [0.9241562968730342, 0.2823944504365753, 0.0028938566478407084, 0.2858208926331969, -0.21727994398379943, 0.44382082638829534, -0.01610465681014206, -0.6631336502654024, 0.2258036978805497, -0.2943311695062888, 0.42367727839411407, -0.2931996593025846, -0.574557677723828]   
 [-0.9479754885396527, 0.4740309483506141, 0.33591828372474775, 0.4419829596867388, 0.06262154275707693, 0.5077439537342601, 0.2803429290547902, -0.4363166600955839, 0.33338854589365313, -0.2960268289277932, 0.36331580070163044, -0.8028279481580387, -0.6957310317385097]      
 [0.10224291204773628, 0.38217995790014586, 0.06537147647703807, 0.012673659382887045, 0.20986343077936748, 0.19618817025051213, -0.279397697049811, -0.6610139009650146, 0.19618476750323327, -0.5535403202292661, -0.030406311001941418, -0.7103469314610158, -0.6460970160257361]
 [1.8199117921028871, 0.18968359220228498, -0.548694376044441, -0.01939822317431721, -0.40952946634737414, 0.3625349596959859, -0.2716814405390069, -0.2278220674509228, 0.2475312559587354, -0.24546219399766897, 0.0695455457677246, 0.08216589367811883, -0.5694427585724877]    </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.28137014633799823</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 318.48  314.48  295.691  433.983  …  948.599  867.16  310.05  248.814</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.94, min/25%/median/75%/max: 0.06 0.92 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 7% DoubledTurn =&gt; 93%
  depth: 3 =&gt; 5% 4 =&gt; 93% 5 =&gt; 2%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.142834034994483, 0.257608897093421]                                                                                                                                                                                 
  [-0.19262501458551917, 0.034197254807234276, -0.053365313720232864, 0.3058207998122156, 0.026451096631776715, -0.31005989019404184, 0.13188880424203492, -0.16892091851082866, 0.2627500760802227, -0.0937347639278057]
 0.28137014633799823                                                                                                                                                                                                     </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
