<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-5288.735823566134</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.066348565266543,0.2688925737714058, ...]
 * Minimum: -1.309493e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 1.49e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -2.60e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 2.08e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 965284130
 * Gradient Calls: 965284130</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.066348565266543     
  0.2688925737714058    
  2.5263915401829664e-13
 -4.661774407457108e-14 
  1.0363365106358263e-13
 -5.925610108768818e-13 
 -2.6314349274937504e-14
  5.859354475989871e-13 
 -2.3321800073435377e-13
  4.1638136089460335e-13
 -5.739902437421999e-13 
  4.236302841451106e-12 
  9.615708105991363e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.1021238887971343, 0.2599452482122999, -0.32887313702079635, -0.008320456957493314, -0.07664821988377377, 0.2702575014844522, -0.013330452732407204, -0.48328518165138157, 0.28934931821333537, -0.014460462695395412, 0.27229976607819817, -0.19349233821561684, 0.5611796724377639], -38.299511406192615, 4, DynamicHMC.DoubledTurn, 0.7592236489851527, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9098202219399074, 0.2910909519421912, -0.059292876215534765, 0.003842971342495713, -0.03544477219456155, 0.10312559021094692, 0.013668658879441301, -0.012737384354346083, -0.01309289043128608, -0.19257936520569624, 0.09379842590311413, -0.09040030644602134, 0.26466605767144136], -40.367520481912806, 4, DynamicHMC.DoubledTurn, 0.8879877569459322, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0601925085553987, 0.261874931447267, -0.03816523235578875, 0.24554285761069627, -0.05324936837750912, 0.6187675307641406, 0.061493122287866055, -0.5703536013153717, 0.23595320434705783, 0.20569673583377274, 0.3245006227528086, -0.02668203607112696, 0.7341567031850408], -44.6389322726995, 4, DynamicHMC.DoubledTurn, 0.6336014703579107, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6829713961928041, 0.33490150930777884, -0.31870620897722085, -0.06086527389602097, -0.019048513672435645, 0.22850936277067382, -0.2935568728152024, -0.42987380015186744, -0.12900227078669652, -0.18117418210016872, 0.005835181815599982, -0.5477008585884006, 0.4504215487579033], -45.75168121583343, 4, DynamicHMC.DoubledTurn, 0.9717239810986293, 15), NUTS_Transition{Array{Float64,1},Float64}([0.45599915063953994, 0.3395506089223559, -0.3197549074345818, 0.042187275538510635, 0.0487041155209352, 0.4923185099371827, -0.052926273159282534, -0.7976590707145518, 0.07362193618651794, -0.15206581604114322, 0.2852731712842279, -0.2836449586662184, 0.7154467370135142], -42.79627244537959, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0343672858811364, 0.2518385135058446, -0.21777254317401318, 0.2473750959134634, 0.143581923442952, 0.2823670693321807, 0.12517268661967673, -0.629750445565106, 0.05808156547051563, -0.18338895582557746, 0.12423218068625434, -0.002701267949308986, 0.49299854739625004], -52.49146236096513, 4, DynamicHMC.DoubledTurn, 0.46964409123977097, 15), NUTS_Transition{Array{Float64,1},Float64}([1.224205831561626, 0.22224742843164602, 0.128162511499573, -0.042115015892454935, 0.1434292724843626, 0.3765397590331911, 0.2751122319029168, -0.1100113736528643, 0.055765150268037245, -0.29355760048263013, 0.5009958074553681, 0.034182057279970375, 0.5274234081239426], -49.325994828385966, 4, DynamicHMC.DoubledTurn, 0.9845542609176028, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9621630838454033, 0.295626030381343, -0.45997708185377834, 0.13088101746534198, -0.20356835825794956, 0.4407186271075233, -0.17760968332583046, -0.7370156100220697, 0.35281502467059445, -0.28966434933182345, 0.21201672064736116, -0.11709175856483695, 0.6073660219746293], -50.146393858923624, 4, DynamicHMC.DoubledTurn, 0.9718424052542695, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0446131935564666, 0.25692266063487684, -0.4924505861563552, 0.16557255170289684, -0.33987228812408227, 0.3753670044327746, -0.0854235608492382, -0.6953972032966467, 0.2943566291687586, -0.3274026467983294, 0.1686123886744835, -0.10073704078083938, 0.620000983888367], -45.2285144219818, 4, DynamicHMC.AdjacentTurn, 0.999276720480659, 31), NUTS_Transition{Array{Float64,1},Float64}([1.6219172060979177, 0.19350967445342052, -0.2507032339251309, 0.17164348740771895, -0.24770250955628975, 0.03415992214795176, -0.06787794578544744, -0.26557225154710973, 0.17317305418162615, -0.15150447789295146, 0.36264679253806215, -0.0794437278898537, 0.4302139365733262], -47.144215652019675, 4, DynamicHMC.DoubledTurn, 0.9858105803128251, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.7100846166466699, 0.19723967942819196, -0.29386072260442864, 0.04817153945105246, -0.1893855670297453, 0.3012888067983078, 0.00660998660028464, 0.07228302696813353, 0.44939573091208795, -0.10347451590047285, 0.2594579001227898, 0.04694894166447637, 0.4878645825276529], -44.59746423749917, 4, DynamicHMC.DoubledTurn, 0.9274398732769071, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9053738994519365, 0.14742308654793176, -0.18821933954351627, -0.1197160652069172, 0.13082105160289056, 0.42803365815018546, 0.30592011100508504, -0.18547391201970798, 0.49095232525650395, -0.09767599286323697, 0.4143490345304485, 0.309444872325892, 0.6937743771702144], -47.80053085207957, 4, DynamicHMC.DoubledTurn, 0.6941697888752832, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5383739304053822, 0.33619974672439384, -0.3067161767377774, 0.2330749124519529, -0.13838225084283562, 0.4856298447631177, -0.21432750220906122, -0.45783931202246164, -0.044168974299238446, -0.47055710796153044, 0.2590846824176932, -0.42434753372889655, 0.6455830905998362], -51.13818290411467, 4, DynamicHMC.DoubledTurn, 0.9237343357022615, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8999054575927745, 0.26970569363415126, -0.1683923807140738, 0.12199015211633214, -0.11834049943554202, 0.4100321336723289, 0.3876987219760333, -0.5663711924115161, 0.32840825728534395, -0.042233536600564545, 0.31133558866527994, 0.02016993776333057, 0.5653741670421765], -45.37366494287694, 4, DynamicHMC.DoubledTurn, 0.9880833724155196, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3862290832417918, 0.2315558208548069, -0.5358043962062629, 0.065364788874622, -0.09064243361365051, 0.3771208941242293, -0.031886925368720676, -0.69751098581265, 0.22643614368993653, -0.4016877038006324, 0.39905165788125924, -0.061746141143470074, 0.6953975198133475], -43.59553277038847, 4, DynamicHMC.DoubledTurn, 0.9592812577500601, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3051636910996671, 0.24142245856041608, -0.345590998138933, -0.10569431067720822, 0.07764282945700116, 0.31485032166413296, 0.017934448144091644, -0.6637965631254358, 0.3072947780690592, -0.29902541902518454, 0.19276082386286028, -0.04059272371822811, 0.5624438170879273], -42.75978926826849, 4, DynamicHMC.DoubledTurn, 0.9159773874822152, 15), NUTS_Transition{Array{Float64,1},Float64}([1.802735848078507, 0.19865729002956395, -0.058369005991633485, -0.3630781513607711, -0.3034639765294761, 0.05804515417844187, 0.24173143571993072, -0.5210120563332393, 0.20007722078807588, -0.21827990060422825, 0.17039601076751487, -0.1418027345251658, 0.4995085172755303], -45.283013456461966, 4, DynamicHMC.DoubledTurn, 0.9840496526464855, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8204952441759534, 0.17143310577942156, -0.6043746330550086, -0.1274474986955723, 0.08326989066691656, 0.42260142377823506, -0.03794703185830938, -0.1028320756944399, 0.13909654860919546, -0.23852490195483514, 0.49963804742911605, 0.360285643852578, 0.5135889914580817], -43.80814762688383, 4, DynamicHMC.DoubledTurn, 0.9942523678659181, 15), NUTS_Transition{Array{Float64,1},Float64}([0.1890246940472559, 0.35873473830335717, 0.5050608312950622, 0.0021248430861904935, -0.22202812113119547, 0.17062109165049735, 0.12612539657214558, -0.6838749370760562, 0.17765584937600132, -0.16801023320625097, 0.18226112233263086, -0.5652001091965243, 0.6013238055058171], -48.669919675900346, 4, DynamicHMC.DoubledTurn, 0.7471764402759368, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7250113005574967, 0.15531200195361317, -1.2475257829054596, 0.1701759582856111, 0.30758870852764286, 0.7564192517491538, 0.140111876009847, -0.10582344644286173, 0.44717427925279707, -0.17100262001093608, 0.698704313763369, 0.5398461426119325, 0.7363827491663296], -56.23965435629863, 5, DynamicHMC.DoubledTurn, 0.9538812986094376, 31)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.225
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.5955234576973186, 0.06727162752347568, 0.21966719394833886, 0.1979496178819572, 0.1686410173554437, 0.1796118264593601, 0.15997948929459685, 0.18809807671178408, 0.14532584483933328, 0.1801510418066186, 0.16695855228795545, 0.2298846092740498, 0.12314958945308589]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.1021238887971343, 0.2599452482122999, -0.32887313702079635, -0.008320456957493314, -0.07664821988377377, 0.2702575014844522, -0.013330452732407204, -0.48328518165138157, 0.28934931821333537, -0.014460462695395412, 0.27229976607819817, -0.19349233821561684, 0.5611796724377639]  
 [0.9098202219399074, 0.2910909519421912, -0.059292876215534765, 0.003842971342495713, -0.03544477219456155, 0.10312559021094692, 0.013668658879441301, -0.012737384354346083, -0.01309289043128608, -0.19257936520569624, 0.09379842590311413, -0.09040030644602134, 0.26466605767144136]
 [1.0601925085553987, 0.261874931447267, -0.03816523235578875, 0.24554285761069627, -0.05324936837750912, 0.6187675307641406, 0.061493122287866055, -0.5703536013153717, 0.23595320434705783, 0.20569673583377274, 0.3245006227528086, -0.02668203607112696, 0.7341567031850408]          
 [0.6829713961928041, 0.33490150930777884, -0.31870620897722085, -0.06086527389602097, -0.019048513672435645, 0.22850936277067382, -0.2935568728152024, -0.42987380015186744, -0.12900227078669652, -0.18117418210016872, 0.005835181815599982, -0.5477008585884006, 0.4504215487579033]  
 [0.45599915063953994, 0.3395506089223559, -0.3197549074345818, 0.042187275538510635, 0.0487041155209352, 0.4923185099371827, -0.052926273159282534, -0.7976590707145518, 0.07362193618651794, -0.15206581604114322, 0.2852731712842279, -0.2836449586662184, 0.7154467370135142]         </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2759832654373052</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 764.664  774.009  462.915  778.604  …  804.008  762.796  683.47  381.739</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.93, min/25%/median/75%/max: 0.07 0.91 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 13% DoubledTurn =&gt; 87%
  depth: 2 =&gt; 0% 3 =&gt; 4% 4 =&gt; 91% 5 =&gt; 4%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.113984764548993, 0.2595729187919742]                                                                                                                                                                            
  [-0.19914325155856932, 0.043760403715191666, -0.04593517323616758, 0.3073456719928789, 0.0462562660045745, -0.30101923188867086, 0.1432174406502292, -0.15724119226710556, 0.26806462633636186, -0.094305971424489]
 0.2759832654373052                                                                                                                                                                                                  </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
