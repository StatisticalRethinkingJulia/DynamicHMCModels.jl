<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-1929.6166101741114</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.1215032497098962,0.26065447742200487, ...]
 * Minimum: -1.290858e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 1.90e-10 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -2.64e-07 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 1.87e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 957225071
 * Gradient Calls: 957225071</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.1215032497098962    
  0.26065447742200487   
 -7.911057714288753e-13 
  4.260056440541242e-14 
 -4.1885989686457354e-13
  1.5046556552404268e-12
 -1.224143098350089e-13 
 -1.8361459520261685e-12
  4.210942275943731e-13 
 -1.4474547839581598e-12
  1.210340163984706e-12 
 -1.9048104044677982e-11
  0.00010695240327451507</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.05420170686665381, 0.38748784604278885, 0.05298342126008281, 0.2577294683690942, -0.01800781057970168, 0.1984718726728291, 0.08052524256431945, -0.14194343611758634, 0.021730610802624416, -0.08375129616555703, 0.10904327992630233, -0.6432463851923229, -0.5021392093238989], -40.105380460710386, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.916911926658712, 0.18922528557345458, -0.7256915218440357, -0.0888519743175698, -0.28674718771630914, 0.0041127819193591125, -0.24749801281770153, -0.5306601466038303, 0.10527980287243514, -0.07142739299134215, 0.31684998782597296, 0.07790466742592811, -0.6467815222379769], -43.45935752659531, 4, DynamicHMC.DoubledTurn, 0.9439599419607801, 15), NUTS_Transition{Array{Float64,1},Float64}([2.2419420182548295, 0.1597795513830484, -0.7982569019813507, -0.21388379062454516, -0.46190588172557545, 0.14863921887254472, -0.26385168641587864, -0.7893871702171401, 0.025924278102091705, -0.4583220882883342, 0.23389235982413997, 0.009999550544061035, -0.6351770897635794], -45.131832184110124, 4, DynamicHMC.DoubledTurn, 0.9795087212335262, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4466661791195614, 0.2066766918238503, -0.002839917946138526, 0.03702684047528247, 0.09189171817863215, 0.35801858402906184, 0.10182813042103918, 0.17397545961455668, 0.4214749260057781, -0.1679449737709699, 0.49817878261948545, -0.05739434483123586, -0.5418235718041753], -47.86329964732443, 4, DynamicHMC.DoubledTurn, 0.9068766137082797, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5635265397175127, 0.3075014454551313, 0.11856588550163662, 0.218448656136792, 0.16815718078862912, 0.6875146478325344, 0.26010434798296733, -0.3939715364730173, 0.14448465667569932, -0.3319224507862465, 0.18549438354267928, -0.20973781089077784, -0.6399247371720442], -45.921465750364085, 4, DynamicHMC.DoubledTurn, 0.9988477060174991, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8366413844730793, 0.2706146749429189, 0.26170799704939735, 0.28435400722307397, 0.03823099451340257, 0.4753691931203424, 0.18832048469794913, -0.23457051058444822, 0.26520163502331934, 0.06839085768406103, 0.35076982338794055, -0.03944273289435611, -0.4666523992721888], -42.624665022115536, 4, DynamicHMC.DoubledTurn, 0.9902608853456422, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5007874791893051, 0.32178985892826534, -0.13483867341789363, 0.0349148050099508, -0.13608849586864313, 0.36394742678547304, 0.34463788526782824, -0.3435079614367817, 0.4642019635444366, -0.0749813182438349, 0.33203773884618215, -0.2835404597127624, -0.6387336181696633], -45.272883766610875, 4, DynamicHMC.DoubledTurn, 0.9584590623146537, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2447718897167444, 0.25178023384518083, 0.11192725730923835, -0.1458207760900132, -0.1859721644485416, 0.38654110284454735, 0.17716028715705948, -0.29258362952925066, -0.02596742203525844, -0.3553247492544616, 0.08167223843658371, -0.19688496297932753, -0.389115240443654], -45.06061498114142, 4, DynamicHMC.DoubledTurn, 0.9847463308646558, 15), NUTS_Transition{Array{Float64,1},Float64}([2.0068917936742228, 0.16002972945895458, -0.6899867356984707, 0.16667330280570347, 0.1290974945669903, 0.13449966511364514, -0.1428419198551726, -0.279129475363805, 0.3931934042234556, 0.011209191387287664, 0.4038091797302741, 0.23656733882765144, -0.6560559607988722], -44.76404588309843, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.712842669142609, 0.19360328319245954, -0.4052288735609888, -0.12134814316225767, -0.39138287690740886, 0.33040688524610334, -0.08297346113150397, -0.2503333328864914, 0.39722780521083834, 0.19494130939516008, 0.46988003302649356, 0.06860040308574186, -0.5930475048070061], -47.98016316429107, 4, DynamicHMC.DoubledTurn, 0.9840764081899939, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.9479280872429798, 0.2635415635104413, 0.0819765119933433, 0.09594907319766516, 0.23633594246817077, 0.32447280347137236, -0.13520107126648895, -0.13924817509226584, 0.08421808712006645, 0.004328649405004541, 0.3819549803493328, -0.009120932127008027, -0.3979548521626044], -39.41613475737111, 4, DynamicHMC.DoubledTurn, 0.9970183291806104, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2402200956608176, 0.24539481459508672, -0.3701236493479282, 0.002407583389608784, -0.24685604513020154, 0.23032941145940994, 0.228988073247003, -0.45760270757517346, 0.11907613972363554, -0.3092882919749729, 0.17056820517371446, -0.11329882741051758, -0.5044924209922035], -43.763474969385996, 4, DynamicHMC.DoubledTurn, 0.8751126643866288, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6715239439282017, 0.30090437264261033, 0.04024086497115235, 0.29394933193702505, 0.17533018902216924, 0.7179656052816313, 0.031895918374852957, -0.22294598543229802, 0.18833288405320925, -0.024557847186552767, 0.3330823863145194, -0.11756529697219076, -0.5603259956407227], -42.007497715441815, 4, DynamicHMC.DoubledTurn, 0.9861609307665102, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7883045736638297, 0.1941083797997251, -0.24655057563932692, -0.33311840601512566, -0.160791568011904, 0.001076197609413982, 0.005728056354228527, -0.2828743840711434, 0.06080836501167403, -0.15491541704849418, 0.1437878900372462, -0.08373134655736889, -0.43134181572553754], -41.018070135056796, 4, DynamicHMC.DoubledTurn, 0.9989191829123273, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6880936491261769, 0.28660768239363604, -0.24351436713413166, 0.3239554349788343, 0.053867850785344555, 0.5071226014468347, 0.10373482514975874, -0.21788759154992074, 0.1624241840315257, -0.07820845868738271, 0.4140004041019979, 0.05605256015929938, -0.4878889251229369], -38.92363327483235, 4, DynamicHMC.DoubledTurn, 0.9768602578056049, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8783725725142442, 0.30783936993075794, -0.5353336376513017, -0.11827531386681019, -0.09712345204262941, 0.12409616098950545, 0.0517586246993937, -0.6814962873253434, -0.1400708376493607, -0.4137580349885909, 0.2719328215744303, -0.28575961793988514, -0.5405424312331062], -43.16842983223645, 4, DynamicHMC.DoubledTurn, 0.9104098109771414, 15), NUTS_Transition{Array{Float64,1},Float64}([0.3272272846611425, 0.31773892553647404, 0.12608401824007, 0.26471738179471066, 0.263025859260291, 0.6033542735588273, 0.26702701445011134, -0.19888377286059916, 0.4803711800354327, 0.1255022992973581, 0.5182429660559502, -0.062168540684942306, -0.4869688135757394], -44.830521100257876, 4, DynamicHMC.DoubledTurn, 0.8793575631945083, 15), NUTS_Transition{Array{Float64,1},Float64}([1.813094169241191, 0.22129636773588338, -0.6853335589114931, -0.21600847805941012, -0.28238906855447776, 0.04189118185204373, -0.13522859230688283, -0.686094249953536, -6.824443941902403e-5, -0.6521709156503688, -0.04620714800700946, -0.28105658729889094, -0.5940660958634547], -44.2386803774911, 4, DynamicHMC.DoubledTurn, 0.9450318477371022, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7638091972791747, 0.195220020429274, -0.6214926207321767, -0.22623163697892487, -0.14081053191153445, 0.41693648663087374, 0.010562368414486364, -0.4999476431783792, -0.04203398197481911, -0.4122160257804671, 0.06756491683175506, 0.257217357434151, -0.7602997274874889], -46.45217379009132, 4, DynamicHMC.DoubledTurn, 0.903850876309329, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5944488719104433, 0.21793239785627377, -0.4546452032077101, -0.1842277017557039, -0.08193261726462217, 0.4660926179606367, -0.09519085054219857, -0.4219442550593519, -0.04841479780963957, -0.36896967415246357, 0.0057554064104722545, 0.014637677002689378, -0.7776054079047952], -46.58308257712861, 4, DynamicHMC.DoubledTurn, 0.9955369914250309, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.241
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6235698970501109, 0.07074885136303757, 0.23428495293662005, 0.18458732334570765, 0.18425569561169763, 0.18658147949252213, 0.1543363747016796, 0.22115373927918527, 0.16329906838458966, 0.17120282737322462, 0.15414772026747478, 0.2539444748405903, 0.11348344109188782]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.05420170686665381, 0.38748784604278885, 0.05298342126008281, 0.2577294683690942, -0.01800781057970168, 0.1984718726728291, 0.08052524256431945, -0.14194343611758634, 0.021730610802624416, -0.08375129616555703, 0.10904327992630233, -0.6432463851923229, -0.5021392093238989] 
 [1.916911926658712, 0.18922528557345458, -0.7256915218440357, -0.0888519743175698, -0.28674718771630914, 0.0041127819193591125, -0.24749801281770153, -0.5306601466038303, 0.10527980287243514, -0.07142739299134215, 0.31684998782597296, 0.07790466742592811, -0.6467815222379769]
 [2.2419420182548295, 0.1597795513830484, -0.7982569019813507, -0.21388379062454516, -0.46190588172557545, 0.14863921887254472, -0.26385168641587864, -0.7893871702171401, 0.025924278102091705, -0.4583220882883342, 0.23389235982413997, 0.009999550544061035, -0.6351770897635794]
 [1.4466661791195614, 0.2066766918238503, -0.002839917946138526, 0.03702684047528247, 0.09189171817863215, 0.35801858402906184, 0.10182813042103918, 0.17397545961455668, 0.4214749260057781, -0.1679449737709699, 0.49817878261948545, -0.05739434483123586, -0.5418235718041753]   
 [0.5635265397175127, 0.3075014454551313, 0.11856588550163662, 0.218448656136792, 0.16815718078862912, 0.6875146478325344, 0.26010434798296733, -0.3939715364730173, 0.14448465667569932, -0.3319224507862465, 0.18549438354267928, -0.20973781089077784, -0.6399247371720442]       </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2794752488562482</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 731.901  712.854  999.689  760.133  …  989.191  638.844  757.364  280.777</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.93, min/25%/median/75%/max: 0.49 0.9 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 6% DoubledTurn =&gt; 94%
  depth: 3 =&gt; 6% 4 =&gt; 93% 5 =&gt; 1%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1281561179494373, 0.25835262852627744]                                                                                                                                                                           
  [-0.19660325037602278, 0.03634279237710626, -0.04355890368537846, 0.3119655026683882, 0.041745122224650176, -0.3146117579364323, 0.14151272785736593, -0.16882788871769092, 0.2628912702062237, -0.0903223611623134]
 0.2794752488562482                                                                                                                                                                                                   </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
