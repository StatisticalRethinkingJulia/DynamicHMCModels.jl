<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformTuple{NamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}}((β = TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), α = TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), s = TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-5061.169857491764</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.064098771179799,0.2664228147561436, ...]
 * Minimum: -1.371559e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 3.16e-10 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -6.50e-07 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 2.83e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 57389734
 * Gradient Calls: 57389734</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.064098771179799     
  0.2664228147561436    
  7.804211208066502e-14 
 -2.880073873877694e-14 
  1.5916302095111047e-14
 -2.293994960745299e-13 
 -4.022806467870085e-14 
  1.6946918689676604e-13
 -1.1626686167819937e-13
  9.715416183072993e-14 
 -2.5314203953397314e-13
 -1.015401257150162e-12 
  7.091445042701248e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.4538092454288885, 0.21436153917971487, -0.16892473733818578, -0.2311992253015588, -0.08788145889025714, 0.3149784914832512, 0.16003165618481355, -0.3675301951717981, 0.39253170551719696, -0.10333504683540665, 0.4021889349068233, -0.0021395289847102525, 0.4952805404277711], -39.86656148174464, 4, DynamicHMC.DoubledTurn, 0.9991789403989747, 15), NUTS_Transition{Array{Float64,1},Float64}([0.45115286573447794, 0.33457448926848654, 0.031523995918724984, 0.31996575625644674, 0.15998731694701296, 0.2696493592757751, -0.16341540057237797, -0.09908807529109685, 0.019853391263067677, -0.20911777063092313, 0.13032310458149607, -0.18720181941417083, 0.44358719467316604], -39.824778875280415, 4, DynamicHMC.DoubledTurn, 0.989131547279492, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5777245808612577, 0.2093472780727981, -0.18145236602345954, -0.012583345518592498, -0.0010638685052829083, 0.10673143687893286, 0.01552007212203144, -0.16770068604143124, 0.0752120035291121, -0.06542242623945553, 0.13525673651243972, 0.19021559441361513, 0.34319805607824483], -37.72597462194574, 4, DynamicHMC.AdjacentTurn, 0.9988581983189648, 31), NUTS_Transition{Array{Float64,1},Float64}([1.3235705925150925, 0.24184369846817505, 0.01026510121036324, 0.029033235823400817, -0.043886435874152065, 0.2740008776699199, 0.04050252236460923, -0.15622094509817663, 0.037341925510384046, -0.1319359509292922, 0.30100496686815154, -0.19142535166174512, 0.49275106626074816], -37.5213680412818, 4, DynamicHMC.DoubledTurn, 0.8866979423048221, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9232913032842176, 0.1693875521058551, -0.24108062577343006, 0.07437664114692684, -0.13815449433280214, 0.2085635926291614, 0.09347694071395246, -0.22475961291453558, 0.03689706041049069, -0.07126438095708516, 0.17746789580611635, 0.05078601855940978, 0.35290053448020703], -37.37235155288216, 4, DynamicHMC.DoubledTurn, 0.8910959543359023, 15), NUTS_Transition{Array{Float64,1},Float64}([1.356184759832579, 0.24567983321164746, -0.1840353959958868, -0.1392338444273216, -0.08915937037658439, 0.1287347495848691, -0.10253975824760805, -0.11469261223007891, 0.15304159533884026, -0.22726572784220872, 0.2970672523616802, -0.09506299421560664, 0.5096575252742788], -42.171943731254125, 4, DynamicHMC.DoubledTurn, 0.9758116635246715, 15), NUTS_Transition{Array{Float64,1},Float64}([1.65763633243087, 0.18664239765513027, -0.2308562493426927, 0.08630833379781666, 0.0026760454318256813, 0.41150474070909815, 0.11200841432364449, -0.49633351448342733, 0.19588497652762155, 0.01012157612106579, 0.2853987354704902, 0.17739402455528697, 0.592296730330747], -40.84534045973207, 4, DynamicHMC.DoubledTurn, 0.9792609705171066, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7205725977080473, 0.19596485966879126, -0.09329474100655136, 0.10238756343494415, -0.12768737504306413, 0.31130054097976406, -0.031503010195811317, -0.27815179374350546, 0.20556893423036757, -0.23160518732070312, 0.192588317291148, -0.09145622741876203, 0.40564363610741555], -41.951867006703246, 4, DynamicHMC.DoubledTurn, 0.9677208740132506, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9757779175020826, 0.16776053584021375, -0.1387872984732333, 0.045857633137545414, -0.18485619083358057, 0.2865195274313143, 0.013020476941111005, -0.30184234921819797, 0.18285898801645759, -0.24675453077091014, 0.29417714797902, 0.02830988513025938, 0.4158086912971459], -42.19004029825135, 4, DynamicHMC.DoubledTurn, 0.9329951821736674, 15), NUTS_Transition{Array{Float64,1},Float64}([1.217503901060266, 0.23972811075517186, -0.39925920818789984, 0.09779264901162316, -0.314797382516453, 0.2439933763897862, 0.050574960940914494, -0.05402156702981193, 0.11353623381268294, -0.055010156484929476, 0.23869373840415825, -0.07585102007197489, 0.5160487428726144], -41.05724959571551, 4, DynamicHMC.DoubledTurn, 0.799035285804208, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.4944540987851331, 0.24335868025537416, -0.21304245649335907, -0.04803674508884177, -0.0016315921852981716, -0.01897396620728425, -0.11617565977218007, -0.3580965119274994, -0.012763790295618145, -0.21908445485827524, 0.08872563561122286, -0.09451149441260309, 0.4044643419613839], -38.97895823959661, 4, DynamicHMC.DoubledTurn, 0.8408056723124235, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2593239404056986, 0.20960872211883325, 0.021093357622548464, 0.10445663323405138, -0.022873697544233046, 0.6759999640522977, 0.30440876115305493, -0.1286642415142833, 0.38897975794650336, -0.001605316590117565, 0.341455719187625, 0.19709386534204776, 0.5394442201192201], -45.03504773977347, 4, DynamicHMC.DoubledTurn, 0.8446315242388887, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3884558704511072, 0.24410992110040014, -0.10212727099472926, 0.14880798729752293, -0.019787959557070987, 0.020882490216081812, 0.016523925933350135, -0.26207251137771176, 0.010255968067659868, -0.09787547873164812, 0.31099697982195884, -0.2632505061356732, 0.5247007195382261], -46.388065778802655, 4, DynamicHMC.DoubledTurn, 0.9925580402578533, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5566428249878324, 0.2134831192669027, -0.3360071730172235, 0.06325466795093335, 0.08099014648094802, 0.17697109139579412, 0.007669631762076469, -0.34238626305316133, 0.09014800103495516, -0.16447607560907415, 0.3372798876823233, -0.16882729704135066, 0.5931845470610865], -40.88013042741254, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1839966309008236, 0.23219205841906587, -0.18257295727918343, -0.01614838950242664, -0.13724911718217195, 0.5653568983528099, 0.1592982274946461, -0.3067222986479179, 0.21397859227548696, 0.057786162374684036, 0.2624866605895412, 0.2658190783804981, 0.5841682613645754], -43.578600556820746, 4, DynamicHMC.DoubledTurn, 0.9916811858568221, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1819595032224097, 0.24674481296817827, -0.2270985270159634, -0.07347546673398905, -0.18570719242409378, 0.6009770149363354, 0.14624997245249982, -0.35101005074746533, 0.17144935526152602, 0.09537378691895049, 0.2688894959517858, 0.26294478792370335, 0.5554658068625234], -47.99578251014219, 4, DynamicHMC.DoubledTurn, 0.7773321830138201, 15), NUTS_Transition{Array{Float64,1},Float64}([2.20872780752478, 0.14491103024814886, -0.39366277030550173, -0.36679085899063396, -0.08006606380445011, 0.17417330865527958, -0.09442784132468915, -0.6502268288610372, 0.15277854435121102, -0.2127932749770897, 0.41333107190200896, 0.1432624353509291, 0.5620950836925552], -43.782544306596236, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3492812808146841, 0.22567072671994015, -0.1270490359811577, -0.1704113107366994, 0.0798690409464417, 0.23584631948092372, 0.01756456143546306, -0.36019191922715343, 0.13189481416357807, 0.058002742740429235, 0.4427516158470031, 0.08719556788569023, 0.48485339375447956], -39.849323671739484, 4, DynamicHMC.DoubledTurn, 0.9919054462148281, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6495111653438717, 0.3137177990618371, -0.2154447616353537, -0.16826972325382894, 0.030588001978053874, 0.1406737208540315, 0.23417056142040338, -0.1833473833033536, 0.08197088720987117, -0.32017641134137215, 0.1364459629491015, -0.3029167348754274, 0.4219618634078049], -40.03565495387732, 4, DynamicHMC.DoubledTurn, 0.9958347655660964, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8256056073171524, 0.27950674650107826, -0.022760707257023012, -0.11264343288079601, 0.3017463457731202, 0.2290225877340877, 0.344548577566481, -0.1029616871911746, 0.25274863351655336, -0.29832159734710517, 0.20037225926154845, 0.19353285318457536, 0.4963586018019197], -45.12444055803714, 4, DynamicHMC.DoubledTurn, 0.959335517661652, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.221
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.7345584463477041, 0.08220509580909388, 0.2305788818396497, 0.21564094481520124, 0.1854060812465663, 0.19906680397226645, 0.1779422268170513, 0.1985835284838877, 0.1669204887907335, 0.18925030288480726, 0.17534025557260088, 0.2891074445847362, 0.11337319897868003]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.4538092454288885, 0.21436153917971487, -0.16892473733818578, -0.2311992253015588, -0.08788145889025714, 0.3149784914832512, 0.16003165618481355, -0.3675301951717981, 0.39253170551719696, -0.10333504683540665, 0.4021889349068233, -0.0021395289847102525, 0.4952805404277711]   
 [0.45115286573447794, 0.33457448926848654, 0.031523995918724984, 0.31996575625644674, 0.15998731694701296, 0.2696493592757751, -0.16341540057237797, -0.09908807529109685, 0.019853391263067677, -0.20911777063092313, 0.13032310458149607, -0.18720181941417083, 0.44358719467316604]
 [1.5777245808612577, 0.2093472780727981, -0.18145236602345954, -0.012583345518592498, -0.0010638685052829083, 0.10673143687893286, 0.01552007212203144, -0.16770068604143124, 0.0752120035291121, -0.06542242623945553, 0.13525673651243972, 0.19021559441361513, 0.34319805607824483]
 [1.3235705925150925, 0.24184369846817505, 0.01026510121036324, 0.029033235823400817, -0.043886435874152065, 0.2740008776699199, 0.04050252236460923, -0.15622094509817663, 0.037341925510384046, -0.1319359509292922, 0.30100496686815154, -0.19142535166174512, 0.49275106626074816] 
 [1.9232913032842176, 0.1693875521058551, -0.24108062577343006, 0.07437664114692684, -0.13815449433280214, 0.2085635926291614, 0.09347694071395246, -0.22475961291453558, 0.03689706041049069, -0.07126438095708516, 0.17746789580611635, 0.05078601855940978, 0.35290053448020703]    </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.279836867172287</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 870.989  853.175  621.419  953.514  …  595.596  505.243  713.424  245.319</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.93, min/25%/median/75%/max: 0.0 0.91 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 10% DoubledTurn =&gt; 90%
  depth: 2 =&gt; 0% 3 =&gt; 5% 4 =&gt; 92% 5 =&gt; 3%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.100955143065432, 0.26108520879834196]                                                                                                                                                                           
  [-0.1948224721972771, 0.04179220836150166, -0.03485106019462716, 0.3164782807198387, 0.04449881719283344, -0.3032526036941145, 0.13779513167005936, -0.17014634146751817, 0.2676517457400572, -0.08968738812293099]
 0.279836867172287                                                                                                                                                                                                   </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
