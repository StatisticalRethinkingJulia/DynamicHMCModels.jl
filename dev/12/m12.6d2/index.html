<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><div><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre></div><p>New col logpop, set log() for population data</p><div><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table></div><p>Define problem data structure</p><div><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre></div><p>Make the type callable with the parameters <em>as a single argument</em>.</p><div><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre></div><p>Instantiate the model with data and inits.</p><div><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre></div><p>Function convert from a single vector of parms to parks NamedTuple</p><div><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre></div><p>Define input parameter vector</p><div><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-3209.799784614442</code></pre></div><p>Maximum<em>a</em>posterior</p><div><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0856035922555012,0.2642624095295003, ...]
 * Minimum: -1.494961e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false
     |x - x&#39;| = 3.25e-09
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -1.13e-05 |f(x)|
   * |g(x)| ≤ 1.0e-08: false
     |g(x)| = 5.26e+05
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 787084228
 * Gradient Calls: 787084228</code></pre></div><p>Minimum gives MAP estimate:</p><div><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0856035922555012
  0.2642624095295003
 -6.951006876756589e-16
  9.881459451980191e-17
 -3.10727052365397e-16
  1.5207283596382766e-15
  1.1884117766343261e-17
 -1.6011212023759994e-15
  5.451157959026032e-16
 -1.1793711111770016e-15
  1.3822110184599532e-15
 -1.2826266066810395e-14
  3.83766631271496e-5</code></pre></div><p>Write a function to return properly dimensioned transformation.</p><div><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre></div><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><div><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre></div><p>Tune and sample.</p><div><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">MCMC, adapting ϵ (75 steps)
0.0043 s/step ...done
MCMC, adapting ϵ (25 steps)
0.0052 s/step ...done
MCMC, adapting ϵ (50 steps)
0.0058 s/step ...done
MCMC, adapting ϵ (100 steps)
0.0017 s/step ...done
MCMC, adapting ϵ (200 steps)
0.0012 s/step ...done
MCMC, adapting ϵ (400 steps)
0.00078 s/step ...done
MCMC, adapting ϵ (50 steps)
0.0011 s/step ...done
MCMC (1000 steps)
0.00062 s/step ...done
(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.3475373981056502, 0.26165536545673546, -0.42166946996026927, -0.06732417244600267, 0.163129429028732, 0.15762411127840723, -0.3082191122725277, -0.5810968989146915, 0.10674350689582754, -0.37417955926126195, 0.11726286779000494, -0.3562236706472424, -0.5768555497482746], -48.003073711905685, 4, DynamicHMC.DoubledTurn, 0.977976882907029, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3253915790892254, 0.21392879243384275, 0.009529904738937653, -0.12018326939443333, 0.03150109733598354, 0.46778496215326193, 0.24735339424966102, -0.2885427768322619, 0.10634813790146533, -0.10112878981771846, 0.4507296596279871, 0.34490447290955195, -0.510144738619539], -44.98530379492431, 4, DynamicHMC.DoubledTurn, 0.9964436390659618, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4328269072350073, 0.2254314477253642, -0.10312949180739314, -0.031442630691028144, -0.11932043333224371, 0.2651388236012813, 0.03246647079142308, -0.5919836425239398, 0.18822184093688643, 0.039993923047977845, 0.2283260545490537, -0.024973188532583984, -0.5654621554787741], -40.74512912465705, 4, DynamicHMC.DoubledTurn, 0.9798031854231141, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3981217598458697, 0.23409670835044274, -0.2472650809198477, 0.019852708458348158, 0.02328079342990326, 0.24165258970878029, 0.017791461567243247, -0.0217948152130076, 0.011632804608926624, -0.3356397792823851, 0.21088470075064553, -0.01295740071126146, -0.37747063721785973], -39.802145060131664, 4, DynamicHMC.DoubledTurn, 0.9732951967255995, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8314138887770561, 0.2910513817369974, -0.06122878307433989, 0.015396011072399525, -0.12465666328994521, 0.44127027882120634, 0.047094288732236235, -0.3166408908747518, 0.275231287035504, -0.1734790024733499, 0.14689418741596857, -0.09351483349198345, -0.5034615399716854], -37.44845789082982, 4, DynamicHMC.DoubledTurn, 0.9462935334114033, 15), NUTS_Transition{Array{Float64,1},Float64}([2.3103669623532617, 0.13761286891636448, -0.21345600673913842, -0.31581844033766493, 0.0410117962393958, -0.03571180932184967, -0.20186089138892546, -0.3072276527192159, -0.07688810813951844, -0.09699595541864121, 0.3544007355852183, 0.11987574768797653, -0.4563850763007191], -40.39801987275919, 4, DynamicHMC.DoubledTurn, 0.9473754774462029, 15), NUTS_Transition{Array{Float64,1},Float64}([-2.706571659650222, 0.6478625835953542, 0.22344590228002395, 1.210740894725383, 0.08767210821627726, 1.075402432360534, 0.6075383131293713, -0.2707963410679526, 0.5018203366341132, -0.27168131409121526, 0.3208909954628726, -1.1017801216994418, -0.7726714285438424], -51.26871547775627, 4, DynamicHMC.DoubledTurn, 0.7684507859979417, 15), NUTS_Transition{Array{Float64,1},Float64}([0.13565435302594947, 0.3735831527163679, 0.4697950682081573, -0.04714259515788993, 0.3748807320963472, 0.07063834415348114, -0.21213019413168444, -0.29808342620552025, 0.11017621048188875, -0.05338065425776787, 0.05604446626996222, -0.6097716116397701, -0.5916026853459972], -52.29720780868207, 4, DynamicHMC.DoubledTurn, 0.9735774192117153, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1590948037919935, 0.2613983212413221, -0.758116095180218, 0.18853664702823622, -0.5135944257201082, 0.4558754055247169, 0.23278053748299354, -0.5075062810133247, -0.028635385100997397, -0.5475818641154978, 0.33749583470042116, -0.05591455542170638, -0.48352338059764055], -52.96357869320752, 4, DynamicHMC.DoubledTurn, 0.9856331564886077, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9215951127191656, 0.29610103712073416, -0.27297849063387963, 0.01195030936715355, -0.015497070362052237, 0.3681934545768603, -0.2662657140293828, -0.4710422624388731, 0.14462724756977224, -0.1479408878806469, 0.1344822067091729, -0.16514271719052984, -0.8485125090897628], -56.23237076375917, 4, DynamicHMC.DoubledTurn, 0.6815913338314114, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.21585652410147785, 0.3410327020131435, -0.1608194629319645, -0.1564865574484594, 0.11303427337612065, 0.37172759521873316, 0.3703905175170418, -0.14253351448504586, 0.44068286138497476, -0.13915058219742107, 0.05510296552009129, -0.3528777313604652, -0.4860740938648335], -46.15779875269355, 4, DynamicHMC.DoubledTurn, 0.7465511768020835, 15), NUTS_Transition{Array{Float64,1},Float64}([1.540097144658154, 0.2088166362665389, -0.17188286859279067, 0.4903187340624652, 0.03034223578891651, 0.19894989486448023, -0.10892307234796529, -0.40428481610833145, 0.13076073528842141, 0.05161237656000785, 0.536579136895197, 0.04655733766088435, -0.6127707705314626], -49.428255380140946, 4, DynamicHMC.DoubledTurn, 0.994171989397151, 15), NUTS_Transition{Array{Float64,1},Float64}([2.0072202604686242, 0.1616276213583687, -0.10904304294977854, -0.22380775003500514, 0.07689416114021516, 0.145538868526109, 0.12252741458778704, -0.2534915257921643, 0.25317446209653194, -0.009574821674495422, 0.20340315966245184, 0.2566281134597182, -0.48425263925645695], -43.80231744983596, 4, DynamicHMC.DoubledTurn, 0.9956008269609772, 15), NUTS_Transition{Array{Float64,1},Float64}([0.11011480066617785, 0.36527436268556257, -0.23927704068509573, 0.29843013685415826, -0.15025458355901886, 0.39864308521176944, 0.24502702944237784, -0.49908096133451085, 0.12714081705913657, -0.24506198742508856, 0.4335248041487788, -0.4028200318684127, -0.5032491108911463], -40.99572136545546, 4, DynamicHMC.DoubledTurn, 0.9856816818816366, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7046895147710066, 0.1940718702632493, -0.0858762880650951, -0.09739282222210235, 0.13916676045390017, 0.2963999571290204, -0.21264091812902303, -0.14990479067460669, 0.20327185185808436, -0.0831324228468765, 0.19815335441722637, 0.1040603220711111, -0.7334886362715998], -46.02271601011556, 4, DynamicHMC.DoubledTurn, 0.8604702311940976, 15), NUTS_Transition{Array{Float64,1},Float64}([0.41209705457602475, 0.33478835570474585, -0.2108201877763151, 0.206822023357432, -0.1815689393359008, 0.3966496745919495, 0.33158367640985004, -0.41966633502997, 0.19135090257590284, -0.4892915181973003, 0.3263406410261181, -0.19961296250639804, -0.5248635695562744], -47.35821556708999, 4, DynamicHMC.DoubledTurn, 0.9807858303445471, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9395881068065537, 0.28350827693875985, -0.18167338517411355, 0.16533646766385326, 0.0052368608788889645, 0.16503564393919237, 0.015063838889972647, -0.1107760881222988, -0.009720710515214032, 0.004554505048533997, 0.10047049124742242, -0.1492816502499263, -0.32605065862310917], -43.40274196060847, 4, DynamicHMC.DoubledTurn, 0.9572681818345147, 15), NUTS_Transition{Array{Float64,1},Float64}([1.2343171003032418, 0.24581616159766656, -0.12325780088740443, -0.06697933545814679, 0.028487012373792663, 0.1873747194037058, 0.14532070242975464, -0.25130328057509377, -0.03610329635702349, 0.0002366118661560803, 0.07044179661148553, 0.009197197384495356, -0.33808702196025653], -34.40971763758949, 3, DynamicHMC.DoubledTurn, 0.9521901867291006, 7), NUTS_Transition{Array{Float64,1},Float64}([1.4831095071458875, 0.23044506783568863, -0.05287683832906921, -0.013151852870565, -0.2311969990662819, 0.14670135105466367, -0.1779247266148129, -0.24051943550793303, 0.12755921226336073, -0.19777612603219025, 0.2508858643799968, -0.10543774313452901, -0.3750547064323809], -36.984502342748264, 4, DynamicHMC.DoubledTurn, 0.9500599343883664, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1168255030524157, 0.26318018138518207, -0.31127030136246275, -0.08587477653009268, -0.022452293321521752, 0.15477467111221005, 0.12756921798898213, -0.3117598096905683, -0.009954820146769794, -0.13271623062621077, 0.11386226709122772, -0.1172130311378491, -0.38342138139123805], -37.35108573242651, 4, DynamicHMC.DoubledTurn, 0.9502703743390396, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.258
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.7081729839735348, 0.07893506411108599, 0.23027673669799278, 0.23614804543453274, 0.19386768166842636, 0.18476393423913012, 0.18171360830779865, 0.19126759026589377, 0.16698137448701397, 0.16359114982262007, 0.16325571523235602, 0.2701501356486156, 0.10982970635691629]
)</code></pre></div><p>We use the transformation to obtain the posterior from the chain.</p><div><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.3475373981056502, 0.26165536545673546, -0.42166946996026927, -0.06732417244600267, 0.163129429028732, 0.15762411127840723, -0.3082191122725277, -0.5810968989146915, 0.10674350689582754, -0.37417955926126195, 0.11726286779000494, -0.3562236706472424, -0.5768555497482746]
 [1.3253915790892254, 0.21392879243384275, 0.009529904738937653, -0.12018326939443333, 0.03150109733598354, 0.46778496215326193, 0.24735339424966102, -0.2885427768322619, 0.10634813790146533, -0.10112878981771846, 0.4507296596279871, 0.34490447290955195, -0.510144738619539]
 [1.4328269072350073, 0.2254314477253642, -0.10312949180739314, -0.031442630691028144, -0.11932043333224371, 0.2651388236012813, 0.03246647079142308, -0.5919836425239398, 0.18822184093688643, 0.039993923047977845, 0.2283260545490537, -0.024973188532583984, -0.5654621554787741]
 [1.3981217598458697, 0.23409670835044274, -0.2472650809198477, 0.019852708458348158, 0.02328079342990326, 0.24165258970878029, 0.017791461567243247, -0.0217948152130076, 0.011632804608926624, -0.3356397792823851, 0.21088470075064553, -0.01295740071126146, -0.37747063721785973]
 [0.8314138887770561, 0.2910513817369974, -0.06122878307433989, 0.015396011072399525, -0.12465666328994521, 0.44127027882120634, 0.047094288732236235, -0.3166408908747518, 0.275231287035504, -0.1734790024733499, 0.14689418741596857, -0.09351483349198345, -0.5034615399716854]</code></pre></div><p>Extract the parameter posterior means.</p><div><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2699422700984705</code></pre></div><p>Effective sample sizes (of untransformed draws)</p><div><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 897.423  860.268  1000.0  709.893  …  884.21  595.555  786.755  291.021</code></pre></div><p>NUTS-specific statistics</p><div><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.91, min/25%/median/75%/max: 0.06 0.88 0.96 0.99 1.0
  termination: AdjacentTurn =&gt; 7% DoubledTurn =&gt; 93%
  depth: 2 =&gt; 0% 3 =&gt; 12% 4 =&gt; 88%</code></pre></div><p>CmdStan result</p><div><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre></div><p>Show means</p><div><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.0865211154997432, 0.2625929538924856]
  [-0.1842249798933151, 0.043511627570307285, -0.038665406371449676, 0.3190527584420682, 0.04031437429726666, -0.2989110691588203, 0.13817475091196474, -0.16327882929795695, 0.2619185826375756, -0.09647837263717685]
 0.2699422700984705</code></pre></div><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
