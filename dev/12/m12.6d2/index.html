<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-3965.6142780731057</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.07727109746291,0.26510023174438346, ...]
 * Minimum: -1.290289e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 5.96e-10 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -8.64e-07 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 1.88e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 910077552
 * Gradient Calls: 910077552</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.07727109746291      
  0.26510023174438346   
  5.185594669091258e-13 
 -1.8684226866485082e-13
  1.0397549149863707e-13
 -1.515586831136812e-12 
 -2.7276857176895846e-13
  1.1086833496736813e-12
 -7.770604426155743e-13 
  6.234178917505493e-13 
 -1.6932882778257073e-12
 -8.77022700923725e-12  
  0.00010666422336796035</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.39304686372592723, 0.31576833591992093, 0.05729859179682763, 0.34027543454203174, 0.1157948290661332, 0.2880050216690596, 0.4002481361533479, -0.27686156832787456, 0.323105524608982, -0.11563004610539673, 0.4643491956066499, -0.06533944994740963, -0.4951314334758295], -43.481660036490794, 4, DynamicHMC.DoubledTurn, 0.9225485891163624, 15), NUTS_Transition{Array{Float64,1},Float64}([2.4656427786290207, 0.11806042026155836, -0.25045062813836677, -0.20686034367159287, -0.062489880624341056, 0.2620235149133987, -0.2035787806817778, -0.43047370565668075, -0.025401056379965724, -0.27699485561102427, 0.19769159520984653, 0.07898988420751722, -0.47306516923120256], -45.33606996589138, 4, DynamicHMC.DoubledTurn, 0.7775064906038183, 15), NUTS_Transition{Array{Float64,1},Float64}([0.843229869008299, 0.27157452761968565, 0.01707865703959036, 0.21241103710731726, 0.03681168262275622, 0.2397577932766199, 0.3177035972831954, -0.14666444328681813, 0.26555571648763665, -0.06809326426708909, 0.40012826837052184, -0.12547125036162854, -0.41625833059338846], -42.5628459712768, 4, DynamicHMC.DoubledTurn, 0.9604841880261386, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1530916533221474, 0.2571805002463109, -0.3186150719852878, 0.09361756229765075, -0.10431415135175279, 0.5291923132332658, 0.023295152881883413, -0.22936248136680273, -0.11014747860068419, -0.2302937364375376, 0.09812456737738123, -0.009808736359453533, -0.5142235977271673], -41.33802015211362, 4, DynamicHMC.DoubledTurn, 0.9915624706982812, 15), NUTS_Transition{Array{Float64,1},Float64}([3.3601471832658714, 0.013739272769210975, -0.7400113995569825, -0.2730839739239437, -0.21849453470634958, -0.1651055236613177, 0.13631973702427067, -0.4029124909496747, 0.3914801981864239, -0.16589260756266205, 0.4922421009988642, 0.7162101353598519, -0.6344625118261978], -47.36072515679059, 4, DynamicHMC.DoubledTurn, 0.9368588068916511, 15), NUTS_Transition{Array{Float64,1},Float64}([3.3621039019860794, 0.005223905364697754, -0.7237195554885119, -0.16319603183406567, -0.29904439613847855, 0.07630410765170524, 0.2091532899970623, -0.5577582760555178, 0.4955891717317167, -0.16073581011074498, 0.5889264300715293, 0.7707011978044451, -0.7936050299649893], -46.09864512003966, 4, DynamicHMC.DoubledTurn, 0.9524573831773473, 15), NUTS_Transition{Array{Float64,1},Float64}([2.230575436189559, 0.13810048604277708, -0.2884988711589824, -0.1600154687131125, -0.21027279111282923, 0.17405694110996592, 0.2907191440807869, -0.6776286266513255, 0.2272235972906715, -0.21713197425184796, 0.19067566241230163, 0.35108721422030226, -0.4882597533291476], -47.50136364987784, 4, DynamicHMC.DoubledTurn, 0.9833396912240249, 15), NUTS_Transition{Array{Float64,1},Float64}([0.09024905410354905, 0.38184512720135866, -0.04643602258676525, 0.14950703464563309, 0.011819369616936512, 0.24630846443530988, -0.20185199299025752, 0.0218369921654316, -0.028440960282491816, -0.19724788488181078, 0.2361793324296423, -0.5810754541935674, -0.6155413584447575], -46.87489373277823, 4, DynamicHMC.DoubledTurn, 0.9815161689517424, 15), NUTS_Transition{Array{Float64,1},Float64}([2.5243891615671776, 0.08145974224362476, -0.4850514649639506, 0.04150356913431161, 0.09047159156081719, 0.6717714426286542, 0.44135115449303913, -0.74402854996148, 0.5168482119664185, 0.11715558130660905, 0.5783234832557521, 0.726327461546955, -0.6467014118471104], -49.95739139878709, 4, DynamicHMC.AdjacentTurn, 0.9470080530637727, 31), NUTS_Transition{Array{Float64,1},Float64}([0.8936802408203344, 0.2611345570616871, -0.09636339745475206, 0.2808541074018012, 0.19361881992894275, 0.41129522734866225, -0.008897574949157869, 0.17381010235327538, 0.12671281600065354, 0.001744058948608955, 0.5738998155824642, 0.09704299479029796, -0.5803169076813421], -47.11229255988534, 4, DynamicHMC.DoubledTurn, 0.997409033614412, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([2.075498599369494, 0.14783048706711388, -0.16558750156852237, 0.07493087071837679, 0.011268819264890574, 0.07802518024682878, 0.15508759326963562, -0.06375839735184254, 0.007637119962842661, -0.03834782265769633, 0.29626457970801956, 0.2880801925509206, -0.39311587424856853], -40.93928459479689, 4, DynamicHMC.DoubledTurn, 0.8983026654443002, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8642471645654648, 0.29641385076475485, -0.08317675575790924, -0.017032501298403335, 0.09614939818882152, 0.41074031233285624, -0.030291978776553943, -0.31012990645454896, 0.02980349005797887, -0.15327415509035627, 0.054494318808706754, -0.5090001972082808, -0.4674613345373598], -42.65691729418293, 4, DynamicHMC.DoubledTurn, 0.9606613056256135, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1732156718604474, 0.2746579662350634, -0.46583709221262026, -0.10730814151273035, -0.12164658988492533, 0.3370638166147971, -0.06633303414961404, -0.321829371565188, -0.05611369506937119, -0.14515581579997636, 0.3428364863584135, -0.4100960852235908, -0.5262804719732876], -41.983491016424125, 4, DynamicHMC.DoubledTurn, 0.9138891084607913, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7104189480013952, 0.31645385017335315, -0.19707380807569927, -0.22790377638199363, -0.05580769956207908, 0.34036018893006326, 0.00814868261671334, -0.43903609575104097, 0.11966557360587649, -0.17586999161506234, 0.11611462356629734, -0.5495654196286424, -0.6081453197647763], -42.101089341182025, 4, DynamicHMC.DoubledTurn, 0.9520703751257967, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9526600136448493, 0.17373189545190146, -0.43602199190619473, -0.0072539181852947915, -0.4057194087481442, 0.31715618062744244, -0.09424210413530205, -0.3805557124773991, -0.033015976496564216, -0.5543587094563686, 0.26390219717056984, 0.2552434283762923, -0.8275263852816936], -47.95699684411377, 4, DynamicHMC.DoubledTurn, 0.9503516681084853, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7734878113483756, 0.21687855639620068, -0.29394927822912736, -0.15447194591626728, -0.5143580706873884, -0.0978970584598322, -0.253463330775723, -0.6502266243764027, 0.11854651133171906, -0.5205625424296404, 0.03795081879923643, -0.2860001280027398, -0.5770862006215155], -46.08587455588935, 4, DynamicHMC.DoubledTurn, 0.9877745672590419, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3823874843835524, 0.23849417460170427, -0.2593724952374195, -0.06357169216845697, -0.16978390046411113, 0.004152067627491929, 0.005642762506849988, -0.41176926271832953, 0.14281264226753598, -0.05989317628061437, 0.16983325064108837, -0.1133000209778369, -0.6370392317795466], -43.32536804678199, 4, DynamicHMC.DoubledTurn, 0.9598369035397504, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4997980370586534, 0.22021265555047234, -0.30616543308573685, -0.05253988622075663, -0.07318584184489955, 0.46344495216522646, 0.02708498146212899, -0.2613482391920297, 0.09024531022884556, -0.21871576055052203, 0.3943800275975041, 0.08741357341621572, -0.47501829522131], -41.31437290446491, 4, DynamicHMC.DoubledTurn, 0.9591229400945267, 15), NUTS_Transition{Array{Float64,1},Float64}([1.87566419922856, 0.1877108626128389, -0.43626687256061286, 0.2917036907129613, -0.37342500617820373, 0.2050274782636913, 0.3813540572569122, -0.4177091894339813, 0.17893674872713777, -0.575550289556488, 0.384288359289235, -0.047088133899750764, -0.8062418404463827], -53.385853312604915, 4, DynamicHMC.DoubledTurn, 0.7766155049336663, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4973802491522035, 0.21079344134509279, -0.25445602484577146, 0.23445437226709182, -0.3804625161696741, 0.35634914859626, 0.35195831152744467, -0.4119141649205385, 0.2836200870338526, -0.5744069694806327, 0.4729219470471198, -0.010381853724196904, -0.8326718089732936], -53.549116559870924, 4, DynamicHMC.DoubledTurn, 0.9589908483614321, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.282
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.5968419619023351, 0.06666740809611522, 0.17454709349276892, 0.192104630280106, 0.16246299797800262, 0.17055057374509353, 0.16616812246646115, 0.21225298294444953, 0.1486619893147159, 0.16299386820893247, 0.1570655028831791, 0.22174806142662198, 0.10969866823505965]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.39304686372592723, 0.31576833591992093, 0.05729859179682763, 0.34027543454203174, 0.1157948290661332, 0.2880050216690596, 0.4002481361533479, -0.27686156832787456, 0.323105524608982, -0.11563004610539673, 0.4643491956066499, -0.06533944994740963, -0.4951314334758295]          
 [2.4656427786290207, 0.11806042026155836, -0.25045062813836677, -0.20686034367159287, -0.062489880624341056, 0.2620235149133987, -0.2035787806817778, -0.43047370565668075, -0.025401056379965724, -0.27699485561102427, 0.19769159520984653, 0.07898988420751722, -0.47306516923120256]
 [0.843229869008299, 0.27157452761968565, 0.01707865703959036, 0.21241103710731726, 0.03681168262275622, 0.2397577932766199, 0.3177035972831954, -0.14666444328681813, 0.26555571648763665, -0.06809326426708909, 0.40012826837052184, -0.12547125036162854, -0.41625833059338846]       
 [1.1530916533221474, 0.2571805002463109, -0.3186150719852878, 0.09361756229765075, -0.10431415135175279, 0.5291923132332658, 0.023295152881883413, -0.22936248136680273, -0.11014747860068419, -0.2302937364375376, 0.09812456737738123, -0.009808736359453533, -0.5142235977271673]    
 [3.3601471832658714, 0.013739272769210975, -0.7400113995569825, -0.2730839739239437, -0.21849453470634958, -0.1651055236613177, 0.13631973702427067, -0.4029124909496747, 0.3914801981864239, -0.16589260756266205, 0.4922421009988642, 0.7162101353598519, -0.6344625118261978]        </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.28182123139846016</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 434.815  591.795  547.391  738.571  …  616.831  625.203  558.011  296.661</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.92, min/25%/median/75%/max: 0.05 0.88 0.96 0.99 1.0
  termination: AdjacentTurn =&gt; 5% DoubledTurn =&gt; 95%
  depth: 2 =&gt; 0% 3 =&gt; 10% 4 =&gt; 90% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1338419957068393, 0.2589317706936651]                                                                                                                                                                             
  [-0.20662987448490078, 0.028099525287275787, -0.057097307412241505, 0.30121941138371333, 0.03854044593359178, -0.3211454030596914, 0.1350521713247547, -0.18153018388406816, 0.25616034798738385, -0.099830149639304]
 0.28182123139846016                                                                                                                                                                                                   </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
