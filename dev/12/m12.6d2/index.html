<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-4032.2311433379227</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.068318155817811,0.26599775337495185, ...]
 * Minimum: -1.518043e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 6.42e-13 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -3.37e-09 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 5.93e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 376491488
 * Gradient Calls: 376491488</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.068318155817811     
  0.26599775337495185   
  4.128929712991712e-14 
 -1.4703103516368892e-14
  8.803000584246017e-15 
 -1.1981848021578702e-13
 -2.0585060998817453e-14
  8.939870859394968e-14 
 -6.0450922476773e-14   
  5.153381003567585e-14 
 -1.321935690829113e-13 
 -4.457264263062332e-13 
  3.411246877617646e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([2.0684724862738273, 0.15184109276806912, -0.2058832518659917, 0.016511946506521054, -0.07066453814639162, 0.1103122996432554, 0.2178589959537254, -0.32251302354381084, 0.15658832515650545, 0.02734483554021558, 0.5297832478782477, 0.2406347957956077, -0.6541307750747162], -45.54570446399596, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8216725914379122, 0.29197516924034944, 0.027796272996733713, -0.08453376399470129, -0.1771291904002713, 0.17220940433415627, 0.07740070396138578, -0.38325476557367605, 0.002754948200838268, -0.17222092236939576, 0.2832983136549162, -0.16401690054502346, -0.3910476492646023], -42.306074725195764, 4, DynamicHMC.DoubledTurn, 0.8401666229130095, 15), NUTS_Transition{Array{Float64,1},Float64}([1.253840449072823, 0.23832543203148848, -0.28799718737519714, -0.0233488999177576, 0.3078122008189381, 0.44498559691485173, -0.04864178069784842, -0.08840302413224803, 0.27410906915270183, -0.2535824873622932, 0.3560576181674648, 0.14395609598191994, -0.6177587033141696], -41.86398795741808, 4, DynamicHMC.DoubledTurn, 0.8275504039973522, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8916956988972485, 0.2938824681162748, -0.13495317722599243, -0.2736252219529093, -0.10433343074854612, 0.22358716261074174, 0.1546819457992605, -0.3702726899838654, 0.2004632437911368, -0.15919651229924164, 0.2865885715879077, -0.2954379021546414, -0.48811352031754285], -43.50877236987937, 4, DynamicHMC.DoubledTurn, 0.9518018698720542, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0277129536549898, 0.25855104720066757, 0.014961857875289405, -0.09469557597081141, -0.13624618468547808, 0.5287334264166638, 0.37654314131243216, -0.4042307561250939, 0.19543791152696982, -0.1208354429823249, 0.390678066592081, -0.11560716269936189, -0.5644896394778811], -40.34122816931023, 4, DynamicHMC.DoubledTurn, 0.9864607640647038, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0077761949485953, 0.28158380207423794, -0.15530570684816028, 0.2047308564082886, 0.08960940510988143, 0.061314784386970245, -0.09746561132631057, 0.019356892140993842, 0.11001807671635264, -0.07873357430206887, 0.041372748766416625, -0.10991711348474939, -0.35927266080498926], -48.01964249606605, 3, DynamicHMC.AdjacentTurn, 0.5388653600343327, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6493606441484496, 0.20622936451669835, -0.1840167593746056, 0.09288674674635372, -0.05799737018386508, 0.33846881608399215, 0.30176191488767606, -0.38282423703440677, 0.010393175813168495, -0.13621023193691426, 0.21811005535807276, -0.09715699116853646, -0.42241539249606325], -46.069747882679046, 4, DynamicHMC.DoubledTurn, 0.9207704348976383, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8106622696029409, 0.29757940430688146, -0.036011263701994, -0.10051133685697011, 0.03252067776888034, 0.07924563510096952, -0.2730146919979117, -0.013730121030594886, 0.15331601977628792, -0.11065653198745365, 0.21464892648017658, -0.10466999054211482, -0.36478642754829665], -39.10223628383201, 3, DynamicHMC.AdjacentTurn, 0.975152707754017, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7314723374954977, 0.21469332516298553, -0.12634472370526578, 0.008531939871925957, -0.14162018329297815, 0.24366535169476347, 0.14285508312725567, -0.062291385069099425, -0.1315603077229491, 0.0037563527606214696, 0.07064308173411779, -0.08821776540193829, -0.4046861784714466], -42.76454698984461, 4, DynamicHMC.DoubledTurn, 0.6348456219300438, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0132406627702188, 0.24697964542931072, -0.12312412858049553, 0.11551032965517917, 0.12103409776441794, 0.23038780133718384, -0.024728220740734143, -0.3318393064675806, 0.32502083685325533, -0.1849902191224052, 0.37923631577641914, 0.030523096681334256, -0.44258496902751465], -44.07504214227042, 4, DynamicHMC.DoubledTurn, 0.9756048979278348, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.446870638595954, 0.21413867712310128, -0.21415079900781755, -0.07335206772523975, -0.00992279550593303, 0.3904250050042783, 0.02328253017293473, 0.019757208394559717, 0.19649034182808606, 0.04915882697601483, 0.2232239515514115, -0.0009172536454395142, -0.41680175766083116], -42.19624894985984, 4, DynamicHMC.DoubledTurn, 0.9861213466450001, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6923783997191031, 0.31895513712114026, -0.31994426018697747, -0.034256504747738774, -0.13545367166026534, 0.17250260719741076, 0.03915864069345275, -0.2900423107506871, 0.11279274152951835, -0.31062985286965583, 0.2560592029805264, -0.45261602411209295, -0.47067012752585013], -39.72900982825798, 4, DynamicHMC.DoubledTurn, 0.7381754397131678, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3132202811118974, 0.22841170853976234, -0.07663823844824762, 0.10952425170711319, 0.10324872689061337, 0.35244019357936585, 0.012508022419911724, -0.24510471727323652, 0.024282726018738147, 0.0483847605575461, 0.22725654830146613, 0.1108337135621619, -0.5267093982206156], -39.3184245057992, 4, DynamicHMC.DoubledTurn, 0.8250125051838284, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.5023795399838146, 0.4523214293611354, -0.0600355951737484, 0.29935628159498495, -0.15023603914412018, 0.3309670057892964, 0.07834292910881892, -0.19323008442109824, 0.26459887888604616, -0.5913490571860996, 0.2406681094871227, -0.8063382060382666, -0.6401319810837757], -43.575144507516015, 4, DynamicHMC.DoubledTurn, 0.7564199401377683, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.21458327553426249, 0.41139157288940614, -0.05836815149899279, 0.251933017044407, -0.19794255965136637, 0.33545117595163904, 0.1493642425773169, -0.2595690413687383, 0.32610962499596935, -0.5696552410439781, 0.27765888439736397, -0.6462666379156998, -0.6780233305181864], -47.97205601820598, 4, DynamicHMC.DoubledTurn, 0.9840227901859838, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4736655289634881, 0.19769627854555225, -0.09170588637147095, 0.20009328840959553, 0.23257738317827667, 0.7046870724405959, 0.09682682796647601, -0.24334539006877431, 0.2681101928992954, 0.2849300624808069, 0.4823895840473054, 0.3806494597906002, -0.6222709931395296], -45.71604077334091, 4, DynamicHMC.DoubledTurn, 0.9218869612986929, 15), NUTS_Transition{Array{Float64,1},Float64}([0.4216969481177554, 0.3476623962997046, -0.07689061571587806, 0.15335781877792692, -0.1615751586937093, 0.2296714896037519, -0.04846062180521518, -0.45997998000581786, 0.0470902504889387, -0.6159613910527431, 0.2773027548959031, -0.5934165340732873, -0.5325210665077575], -45.76024005600367, 4, DynamicHMC.DoubledTurn, 0.9897678942463247, 15), NUTS_Transition{Array{Float64,1},Float64}([1.576806651945585, 0.20387470682673897, -0.3334281201817533, -0.10366161135986045, -0.034956987711109035, 0.3054906868257554, 0.013897287903681235, -0.25118731750831674, 0.10618221649774966, 0.13601741755292707, 0.10301321486226957, 0.08046530477468325, -0.47478930299217953], -40.79735460777369, 4, DynamicHMC.DoubledTurn, 0.9644894329133907, 15), NUTS_Transition{Array{Float64,1},Float64}([0.15721616153581958, 0.3592132776017742, 0.0391512217834144, 0.10189489268145759, 0.10347440546413526, 0.19587783064927328, 0.03774637655765878, -0.3187667749759394, 0.061228582411773966, -0.2605179922785559, 0.25581847677993336, -0.23489825468185035, -0.40828689784375927], -40.13130456665431, 4, DynamicHMC.DoubledTurn, 0.9795675333475221, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8081373869121271, 0.3030412721654324, -0.16617050697140334, -0.2755841422446052, 0.026035858656660055, 0.2799275733288342, -0.047005589005542414, -0.40316734746175453, 0.0700379285915305, -0.070058769767804, 0.20187113629001868, -0.2287582750249547, -0.5442833651128204], -42.989357063299664, 3, DynamicHMC.AdjacentTurn, 0.7921887002526904, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.277
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.7102352415812252, 0.07994564887656047, 0.21791934022038062, 0.2087214080171193, 0.18519944114818376, 0.1926500064834349, 0.1692923427062552, 0.20116140475852282, 0.16192618106423737, 0.17635135826283518, 0.16493090812424538, 0.28190678491061033, 0.11416168806918599]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [2.0684724862738273, 0.15184109276806912, -0.2058832518659917, 0.016511946506521054, -0.07066453814639162, 0.1103122996432554, 0.2178589959537254, -0.32251302354381084, 0.15658832515650545, 0.02734483554021558, 0.5297832478782477, 0.2406347957956077, -0.6541307750747162]      
 [0.8216725914379122, 0.29197516924034944, 0.027796272996733713, -0.08453376399470129, -0.1771291904002713, 0.17220940433415627, 0.07740070396138578, -0.38325476557367605, 0.002754948200838268, -0.17222092236939576, 0.2832983136549162, -0.16401690054502346, -0.3910476492646023]
 [1.253840449072823, 0.23832543203148848, -0.28799718737519714, -0.0233488999177576, 0.3078122008189381, 0.44498559691485173, -0.04864178069784842, -0.08840302413224803, 0.27410906915270183, -0.2535824873622932, 0.3560576181674648, 0.14395609598191994, -0.6177587033141696]     
 [0.8916956988972485, 0.2938824681162748, -0.13495317722599243, -0.2736252219529093, -0.10433343074854612, 0.22358716261074174, 0.1546819457992605, -0.3702726899838654, 0.2004632437911368, -0.15919651229924164, 0.2865885715879077, -0.2954379021546414, -0.48811352031754285]     
 [1.0277129536549898, 0.25855104720066757, 0.014961857875289405, -0.09469557597081141, -0.13624618468547808, 0.5287334264166638, 0.37654314131243216, -0.4042307561250939, 0.19543791152696982, -0.1208354429823249, 0.390678066592081, -0.11560716269936189, -0.5644896394778811]    </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2767294477408799</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 597.946  579.183  496.159  1000.0  …  1000.0  831.042  603.854  290.033</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.9, min/25%/median/75%/max: 0.14 0.85 0.94 0.98 1.0
  termination: AdjacentTurn =&gt; 8% DoubledTurn =&gt; 92%
  depth: 1 =&gt; 0% 2 =&gt; 0% 3 =&gt; 15% 4 =&gt; 85%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1513349474460406, 0.25545752585980636]                                                                                                                                                                             
  [-0.19627913994888566, 0.030607734264489928, -0.04310553805954804, 0.31902864342636333, 0.04368679829685784, -0.2945418922256609, 0.14339347759385948, -0.16047504027555923, 0.27202263074419536, -0.0768234666712461]
 0.2767294477408799                                                                                                                                                                                                     </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
