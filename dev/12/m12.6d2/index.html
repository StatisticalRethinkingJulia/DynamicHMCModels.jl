<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-6412.881765146185</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language- 6d2">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language- 6d2">Optim.minimizer(res)</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.651604776923712, 0.33148723152512727, -0.35471360745544417, 0.15404121919639416, -0.3380700907152739, 0.05237886639434978, 0.011069870164147053, -0.21807638094710718, 0.07635204276770516, -0.47836873413610986, 0.09707063989437735, -0.4641313065717221, 0.49477223614914045], -42.29883107196566, 4, DynamicHMC.DoubledTurn, 0.9483598662148075, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6522968722793139, 0.181556343146841, 0.013258265639591059, -0.1287232747646701, 0.24535695944244945, 0.38659681677842705, 0.1605562816727791, -0.24905653518655396, 0.28872161617980324, 0.20574824075694326, 0.32254511223047677, 0.26860989357849674, 0.474072058116557], -41.636191251295436, 4, DynamicHMC.DoubledTurn, 0.9941818784512038, 15), NUTS_Transition{Array{Float64,1},Float64}([0.691303013911351, 0.31298697720476704, -0.284387781210218, -0.03845998126629605, -0.08026358455239675, 0.2736498248122915, -0.08644355875517216, -0.2443374324190381, 0.08202613674090695, -0.17990609597632595, 0.2038034637946307, -0.3876772259660672, 0.46957586708539567], -41.85157357614161, 4, DynamicHMC.DoubledTurn, 0.9379202435057807, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3974375963613261, 0.22633437564007486, -0.05548264017363021, 0.10473730551463685, 0.04803306964083191, 0.12415374025982764, 0.2307116087999128, -0.16214679331474868, 0.16461681203299686, -0.1722650939764454, 0.3136668647703631, 0.1874018868697316, 0.39492252831885627], -36.488471324963555, 4, DynamicHMC.DoubledTurn, 0.9399580254366885, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9970921719324272, 0.2741318402182235, -0.36834732279351434, -0.009475979509802647, -0.1300305000083537, 0.31243936677400286, -0.028780268472067494, -0.18480006465831197, 0.12238646060537453, -0.2076896642870187, 0.24847823121800477, -0.33001622178220713, 0.5342513777954473], -39.33591623869041, 4, DynamicHMC.DoubledTurn, 0.8921998934068647, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5071784346696762, 0.21447179714103448, -0.0727018934625955, 0.18357742125373808, -0.12501890787510345, 0.17438572102202748, 0.020147007376615574, -0.22290759507663405, 0.24821165577127402, -0.21925930448827038, 0.2683775049068202, 0.11320564394157191, 0.38076202931473224], -38.115262113113346, 3, DynamicHMC.AdjacentTurn, 0.9062459420935665, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7342232122779474, 0.30226463970322975, -0.1210585619004301, -0.09922446844552167, 0.16717627005673427, 0.24218278578317376, -0.2271735983231859, -0.07824324318600136, 0.10318151661807717, -0.11580968091307968, 0.23517599407039816, -0.19634189195568602, 0.5044252555625472], -40.11708833816872, 4, DynamicHMC.DoubledTurn, 0.9265610212400504, 15), NUTS_Transition{Array{Float64,1},Float64}([2.164834293139788, 0.1550038537743289, -0.17962469200831171, -0.016791616737523107, 0.04844180523604699, 0.024160951795710067, 0.10724284031933726, -0.27158952257299723, 0.20915497733065092, -0.12060186955615228, 0.21561315528837063, 0.08935077519573012, 0.4962568618754299], -46.096506393572284, 3, DynamicHMC.AdjacentTurn, 0.7767980933114589, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1636991587563692, 0.26114176994871885, -0.02244931369161683, 0.03009006649419232, -0.013773228287975968, 0.05836242221589527, 0.015696829602037027, -0.005788435638386116, 0.012459944679010806, -0.14868414277942793, 0.0934777924252564, -0.0829246497340723, 0.23228659710613445], -38.426578349924704, 3, DynamicHMC.DoubledTurn, 0.8602083499045464, 7), NUTS_Transition{Array{Float64,1},Float64}([1.1636991587563692, 0.26114176994871885, -0.02244931369161683, 0.03009006649419232, -0.013773228287975968, 0.05836242221589527, 0.015696829602037027, -0.005788435638386116, 0.012459944679010806, -0.14868414277942793, 0.0934777924252564, -0.0829246497340723, 0.23228659710613445], -35.47161777588751, 3, DynamicHMC.DoubledTurn, 0.4589878848327063, 7)  …  NUTS_Transition{Array{Float64,1},Float64}([2.390741278553476, 0.12887201281208002, -0.5706949818327782, -0.3143911164365995, -0.20849810992571421, 0.1724353882155711, -0.23321613892120832, -0.5254043602577734, 0.051183150126283626, -0.48893520722643047, 0.3529781869931853, 0.16610678566012077, 0.6386496963679255], -44.46793562372065, 4, DynamicHMC.DoubledTurn, 0.994268102707898, 15), NUTS_Transition{Array{Float64,1},Float64}([2.096445958454602, 0.1674718218827589, -0.2680572030586774, -0.0076508979597021964, -0.007381868241642955, 0.064094891849486, -0.3505247242358064, -0.44929707891270665, 0.13321961475104452, -0.5025389701378425, 0.305862039179656, 0.157788155421616, 0.4852264225366477], -43.28315918510379, 4, DynamicHMC.DoubledTurn, 0.9617311278253984, 15), NUTS_Transition{Array{Float64,1},Float64}([0.2417515722499321, 0.3471858104446221, 0.09171656342366116, 0.059969508954991466, -0.16112339291210612, 0.5996010917413043, 0.32913642343810556, -0.25698979303461594, 0.031473049749821416, 0.17820585867096544, 0.3422183563582397, -0.29169067197039833, 0.5004219510492484], -44.17438159348733, 4, DynamicHMC.DoubledTurn, 0.9504962577054952, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8824748018820017, 0.2862461490350863, -0.2225807778612754, 0.19686242325901238, 0.10093884897379862, 0.10499926863590656, -0.1279309890694686, -0.3619296482970058, 0.3138257002378112, -0.758336521177918, 0.17441176235676414, -0.3131769358208192, 0.6079973553516387], -46.02743329084751, 4, DynamicHMC.DoubledTurn, 0.8320128543679101, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6453043747578175, 0.313366016047331, -0.16262054242137797, 0.2640376982966532, 0.09300900318730196, 0.11526990271479014, -0.16697317491767014, -0.3205676869473942, 0.33237533760547167, -0.7827866675037016, 0.10941124763587391, -0.3209845428556289, 0.5845011892507118], -48.655731824945185, 4, DynamicHMC.DoubledTurn, 0.9910211869373027, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7160323503576316, 0.1897794524559754, -0.3918691685952109, -0.27494947069814535, -0.3110168314768152, 0.24396951366865274, 0.1137139057012104, -0.4362000619355126, -0.12749555728271159, 0.15364964899189093, 0.1426255801732964, -0.013473052057959251, 0.4920056829919261], -48.352776854344256, 4, DynamicHMC.DoubledTurn, 0.8381688444902549, 15), NUTS_Transition{Array{Float64,1},Float64}([1.181970288382832, 0.24656112115979162, -0.27709786189989094, 0.2459120104269316, -0.012795912401281487, 0.39835688029870164, -0.011370193612147746, -0.2748315487972387, 0.2853597577073543, -0.49202105129493795, 0.3829207573500369, 0.0017789453765726382, 0.5666221543790246], -44.22681825379864, 4, DynamicHMC.DoubledTurn, 0.9927170499229774, 15), NUTS_Transition{Array{Float64,1},Float64}([1.01044247779675, 0.26950085609712293, 0.0029203667818817752, -0.03246257710541096, 0.06921162593544192, 0.3597234184168896, 0.07558252825883421, -0.292520531798155, -0.08910265163317722, 0.22421814340376112, 0.24580556591174282, -0.06702153216063943, 0.4625948822041527], -41.91429529620392, 4, DynamicHMC.DoubledTurn, 0.9865394414875754, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3836986495269656, 0.23957248561008757, -0.2169533962215877, -0.04827910744585252, -0.07798087285161674, 0.11715823717335612, -0.04515141284236093, -0.3458485703410827, 0.15451935727037827, -0.165841569600323, 0.2687473157785251, -0.16491406408167578, 0.40886732549500904], -38.14536753502142, 4, DynamicHMC.DoubledTurn, 0.9758033076128356, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8156072746206656, 0.2810126992039836, -0.1686882204777343, 0.11497218422361138, 0.042019636152406586, 0.4823269137333083, 0.002743061934326746, -0.06313869119978165, 0.04726350764471338, -0.05454522682142704, 0.5235432205330544, -0.08740732796040014, 0.49909984744711455], -39.14908569879639, 4, DynamicHMC.DoubledTurn, 0.8274724321191428, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.291
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6597334414253785, 0.07399756862848147, 0.22176014006559638, 0.21186018745936808, 0.19268503454179423, 0.17354108567989285, 0.17785416701544357, 0.19287862060962432, 0.16047456631094076, 0.15886424776074623, 0.1565160271837656, 0.24935410289324522, 0.10630546142043275]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.651604776923712, 0.33148723152512727, -0.35471360745544417, 0.15404121919639416, -0.3380700907152739, 0.05237886639434978, 0.011069870164147053, -0.21807638094710718, 0.07635204276770516, -0.47836873413610986, 0.09707063989437735, -0.4641313065717221, 0.49477223614914045]  
 [1.6522968722793139, 0.181556343146841, 0.013258265639591059, -0.1287232747646701, 0.24535695944244945, 0.38659681677842705, 0.1605562816727791, -0.24905653518655396, 0.28872161617980324, 0.20574824075694326, 0.32254511223047677, 0.26860989357849674, 0.474072058116557]        
 [0.691303013911351, 0.31298697720476704, -0.284387781210218, -0.03845998126629605, -0.08026358455239675, 0.2736498248122915, -0.08644355875517216, -0.2443374324190381, 0.08202613674090695, -0.17990609597632595, 0.2038034637946307, -0.3876772259660672, 0.46957586708539567]     
 [1.3974375963613261, 0.22633437564007486, -0.05548264017363021, 0.10473730551463685, 0.04803306964083191, 0.12415374025982764, 0.2307116087999128, -0.16214679331474868, 0.16461681203299686, -0.1722650939764454, 0.3136668647703631, 0.1874018868697316, 0.39492252831885627]      
 [0.9970921719324272, 0.2741318402182235, -0.36834732279351434, -0.009475979509802647, -0.1300305000083537, 0.31243936677400286, -0.028780268472067494, -0.18480006465831197, 0.12238646060537453, -0.2076896642870187, 0.24847823121800477, -0.33001622178220713, 0.5342513777954473]</code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2724991843529614</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 996.791  1000.0  765.383  1000.0  1000.0  …  1000.0  1000.0  982.56  389.632</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.9, min/25%/median/75%/max: 0.15 0.86 0.94 0.98 1.0
  termination: AdjacentTurn =&gt; 7% DoubledTurn =&gt; 93%
  depth: 2 =&gt; 0% 3 =&gt; 15% 4 =&gt; 85% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.101171730367206, 0.261747963586676]                                                                                                                                                                             
  [-0.1998412869313326, 0.03860743006545881, -0.042643694181804206, 0.3102824520114263, 0.03855135520187342, -0.30720859567786635, 0.1303448645099198, -0.1584261219754951, 0.2620835794749736, -0.09915987637426384]
 0.2724991843529614                                                                                                                                                                                                  </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
