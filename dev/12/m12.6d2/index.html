<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><div><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre></div><p>New col logpop, set log() for population data</p><div><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table></div><p>Define problem data structure</p><div><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre></div><p>Make the type callable with the parameters <em>as a single argument</em>.</p><div><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre></div><p>Instantiate the model with data and inits.</p><div><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre></div><p>Function convert from a single vector of parms to parks NamedTuple</p><div><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre></div><p>Define input parameter vector</p><div><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-1928.1092923292701</code></pre></div><p>Maximum<em>a</em>posterior</p><div><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0957409405612475,0.2632639555697999, ...]
 * Minimum: -1.398745e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false
     |x - x&#39;| = 2.29e-11
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -3.02e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false
     |g(x)| = 5.63e+05
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 434995126
 * Gradient Calls: 434995126</code></pre></div><p>Minimum gives MAP estimate:</p><div><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0957409405612475
  0.2632639555697999
  3.769613999405659e-13
 -3.121931890955612e-14
  1.9377407238565798e-13
 -7.476955743937297e-13
  4.713402639050756e-14
  8.850874864278836e-13
 -2.1961847277947227e-13
  6.920088782335392e-13
 -6.108746723124199e-13
  8.40843840477286e-12
  6.216831870707766e-5</code></pre></div><p>Write a function to return properly dimensioned transformation.</p><div><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre></div><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><div><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre></div><p>Tune and sample.</p><div><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">MCMC, adapting ϵ (75 steps)
0.0051 s/step ...done
MCMC, adapting ϵ (25 steps)
0.0085 s/step ...done
MCMC, adapting ϵ (50 steps)
0.0055 s/step ...done
MCMC, adapting ϵ (100 steps)
0.0026 s/step ...done
MCMC, adapting ϵ (200 steps)
0.002 s/step ...done
MCMC, adapting ϵ (400 steps)
0.0012 s/step ...done
MCMC, adapting ϵ (50 steps)
0.0016 s/step ...done
MCMC (1000 steps)
0.00096 s/step ...done
(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.7574876055848975, 0.28876012055278616, -0.08292372146139362, 0.2473391457170499, -0.08234771606391098, 0.37878118842267294, 0.04418141279249071, -0.40106637230875375, 0.15274182890160168, -0.2675222088169358, 0.23988352583955125, -0.018360322493931172, -0.48645207065344487], -40.28009112942564, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.9030329946108553, 0.18581875263446684, -0.30303321431839786, -0.011255449019433997, -0.032206716418631216, 0.05940413300088496, 0.029846373403607625, -0.33404623263937194, 0.08483618645035618, -0.1833624602019156, 0.15380821118602914, -0.08215845672177237, -0.46937796769658807], -39.80004204336607, 4, DynamicHMC.DoubledTurn, 0.9006852739660952, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7703067664435532, 0.30345606531205216, 0.21873164209608661, 0.13613943198956993, -0.16931232852527486, 0.35914397817818877, -0.09690890109084392, -0.23865219256888456, 0.016635457514259863, -0.059551308473370757, 0.20419715791801646, -0.21647169203154995, -0.4343768927654408], -38.68672068613448, 4, DynamicHMC.DoubledTurn, 0.954246652314913, 15), NUTS_Transition{Array{Float64,1},Float64}([1.300732460827049, 0.23606372665117892, -0.005906047060382405, 0.05477248845567785, -0.1432357885263284, 0.33042006814103136, 0.03348666793558386, -0.3151709867815981, 0.07221981339714117, -0.0904436235607734, 0.39594462130471086, 0.07256874328391733, -0.4351401679717007], -38.46487567754499, 3, DynamicHMC.DoubledTurn, 0.9711994002275739, 7), NUTS_Transition{Array{Float64,1},Float64}([1.209715131749184, 0.255251817650635, -0.39173578637538214, 0.019723195373105934, 0.10605275947567291, 0.19134472415037015, 0.15718080433503434, -0.1973802326326233, 0.05037552502082893, 0.2309391490385186, 0.09285731318249042, -0.3030481573048436, -0.4681961086617896], -43.70615348241409, 4, DynamicHMC.DoubledTurn, 0.8748530900877122, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0924628192049355, 0.24619127696722432, -7.369434899147202e-5, 0.1546659733055361, -0.24391822375782904, 0.6109174487960102, 0.01537171523190562, -0.40465965161156703, 0.17122742969518992, -0.5554780999082984, 0.5166161521751306, 0.19408850894980148, -0.6263448055440353], -49.242749714370376, 4, DynamicHMC.DoubledTurn, 0.8877359480032656, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3611059541199655, 0.24782404835434993, -0.4062357701126418, 0.11277337163239884, 0.12262063076900234, 0.17817814629644557, -0.14705647676482997, -0.13806598976198706, 0.1496515782215027, -0.050129585099744384, 0.10274113235523603, -0.13040319420050525, -0.3768631131390297], -45.696346208865656, 4, DynamicHMC.DoubledTurn, 0.9354248602893452, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8363506384270043, 0.18264434641670318, -0.03065834301754486, 0.017144708838727242, -0.14225405013839248, 0.4384167987562495, 0.07178137570199278, -0.328875055559628, 0.1430588966599749, -0.1048988143731383, 0.07788695744986027, 0.04972489668426312, -0.45158924921106935], -43.93251705094909, 4, DynamicHMC.DoubledTurn, 0.9642170503248931, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4088313356464859, 0.22737939785985015, -0.21569776485541037, 0.30685979310455197, -0.1302394919023684, 0.32103470577385196, 0.1558415301612343, -0.21066202400105125, 0.09717102071015689, -0.17791769640730307, 0.1890467262553876, -0.003984955478606757, -0.4840534297209553], -38.01544321404931, 4, DynamicHMC.DoubledTurn, 0.9989548710860215, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3454942501583378, 0.23164782115636798, -0.16377405807335801, 0.3986972127060313, -0.11837140098662748, 0.3617041628389472, 0.23546338088526642, -0.172273333319509, 0.16214284407344998, -0.15087219250150516, 0.22625545256409785, 0.02247879081098277, -0.4909774286753712], -39.86647157109179, 4, DynamicHMC.DoubledTurn, 0.9653434482828727, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.01989672570106363, 0.37953848191061984, 0.002391255745486114, 0.481547602787545, 0.07586357007240949, 0.19978647123859006, 0.09870831605329232, -0.251337211023999, 0.24367609762454964, -0.11418638029640844, 0.1624391295984354, -0.37635067346822654, -0.5684610979846634], -41.14901664250036, 4, DynamicHMC.DoubledTurn, 0.9804706995979273, 15), NUTS_Transition{Array{Float64,1},Float64}([1.8151614020355855, 0.2053342997806186, -0.22678726381970918, -0.18065497481727472, 0.04611827391239258, 0.23726281732808296, -0.12317773265091377, -0.5528173386145357, 0.12730497279042996, -0.4946754489935228, 0.11926768747869917, -0.1617615137791636, -0.5623096756715547], -45.541584509686416, 4, DynamicHMC.DoubledTurn, 0.8576493589587018, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6994928428455276, 0.20238023416196768, -0.17608883455496768, 0.05932084233934653, -0.31930820242391017, 0.2525152956236058, -0.15159006029562333, -0.46506305229682465, 0.18876006451417876, -0.10032206026969705, 0.32180538713601187, -0.07861855137672545, -0.5132224616318052], -42.05726436510095, 4, DynamicHMC.DoubledTurn, 0.9962516734762245, 15), NUTS_Transition{Array{Float64,1},Float64}([2.100057777393656, 0.14504589166483942, -0.12124497969988879, 0.1340196522452898, -0.14265220841852005, 0.5616622408587306, -0.128544742862062, -0.3277685778816909, 0.30704921300088284, 0.07000526778515506, 0.5614082753844257, 0.10322620399814794, -0.5151741416673036], -43.04730206358948, 4, DynamicHMC.DoubledTurn, 0.9681791271623618, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0173587169073488, 0.2738456545926401, -0.33519787458706973, -0.16944227539088902, 0.04157381431596781, 0.14451565172932435, 0.20569744726265607, -0.20131303779536128, 0.08213493648402191, -0.3038668793028858, 0.06081831638699765, -0.2085604328718798, -0.44077394760121863], -45.31446724579688, 4, DynamicHMC.DoubledTurn, 0.964718112298509, 15), NUTS_Transition{Array{Float64,1},Float64}([0.942687842529885, 0.26327002832637014, -0.19571083591550065, -0.212427231484743, -0.0018751666529854705, 0.6478737840206783, 0.3680466860798631, -0.33893236300441654, 0.36434370165911406, 0.10347775753244144, 0.3462840075398026, -0.2374628929898542, -0.6496763968716046], -45.95667862320012, 4, DynamicHMC.DoubledTurn, 0.9670138974333826, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1047065672480156, 0.25347773947984037, -0.19144382065903626, 0.42284430697467174, -0.08962893426056032, 0.48820842671768805, 0.1406151902410438, -0.08288565688829107, 0.2124090330251075, -0.2146087667573368, 0.30818942979017006, 0.1376501593265973, -0.5030828261306606], -48.99142204463633, 4, DynamicHMC.DoubledTurn, 0.8985194462040137, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8258391175987931, 0.2919220743980829, -0.3134877461096618, 0.39561537303974603, -0.07713795757335257, 0.5484046728605841, 0.23669878659680538, -0.19168742995595495, 0.39902890378090555, -0.22985218252785342, 0.2764010016449854, -0.08928327958790552, -0.5781296797273539], -42.73978602160414, 4, DynamicHMC.DoubledTurn, 0.7520238813212348, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0511504505978124, 0.25833565906797284, -0.17041926509488078, 0.17904265375232137, -0.19370853867546403, 0.6205070384117773, 0.24343488721027853, -0.3995044440042829, 0.19444360604111194, -0.18842350851471304, 0.26580382781563805, -0.1464468198833297, -0.5050570228605917], -43.26252517478193, 4, DynamicHMC.DoubledTurn, 0.9172504172060854, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5008241136269544, 0.169107523398824, 0.023054880037835117, 0.3063994627590721, 0.15863837107406803, 0.9866034979328304, 0.5504235928034481, -0.27864896029225167, 0.5362212768144177, 0.20904009242165184, 0.8104564930359149, 0.5673528704432149, -0.7389097766789456], -46.86680075852592, 4, DynamicHMC.DoubledTurn, 0.8951763548373357, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.218
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.7116923637983619, 0.08022447604792787, 0.21109321415871665, 0.2259233934839009, 0.18049318533709605, 0.16846607275934486, 0.16396334495969964, 0.18857588270191386, 0.18987118700765476, 0.18111628677507546, 0.17116379404871962, 0.284649382567324, 0.10468863761239465]
)</code></pre></div><p>We use the transformation to obtain the posterior from the chain.</p><div><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.7574876055848975, 0.28876012055278616, -0.08292372146139362, 0.2473391457170499, -0.08234771606391098, 0.37878118842267294, 0.04418141279249071, -0.40106637230875375, 0.15274182890160168, -0.2675222088169358, 0.23988352583955125, -0.018360322493931172, -0.48645207065344487]
 [1.9030329946108553, 0.18581875263446684, -0.30303321431839786, -0.011255449019433997, -0.032206716418631216, 0.05940413300088496, 0.029846373403607625, -0.33404623263937194, 0.08483618645035618, -0.1833624602019156, 0.15380821118602914, -0.08215845672177237, -0.46937796769658807]
 [0.7703067664435532, 0.30345606531205216, 0.21873164209608661, 0.13613943198956993, -0.16931232852527486, 0.35914397817818877, -0.09690890109084392, -0.23865219256888456, 0.016635457514259863, -0.059551308473370757, 0.20419715791801646, -0.21647169203154995, -0.4343768927654408]
 [1.300732460827049, 0.23606372665117892, -0.005906047060382405, 0.05477248845567785, -0.1432357885263284, 0.33042006814103136, 0.03348666793558386, -0.3151709867815981, 0.07221981339714117, -0.0904436235607734, 0.39594462130471086, 0.07256874328391733, -0.4351401679717007]
 [1.209715131749184, 0.255251817650635, -0.39173578637538214, 0.019723195373105934, 0.10605275947567291, 0.19134472415037015, 0.15718080433503434, -0.1973802326326233, 0.05037552502082893, 0.2309391490385186, 0.09285731318249042, -0.3030481573048436, -0.4681961086617896]</code></pre></div><p>Extract the parameter posterior means.</p><div><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.28175428701004457</code></pre></div><p>Effective sample sizes (of untransformed draws)</p><div><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 747.447  744.559  708.486  975.655  …  910.966  569.938  564.635  112.86</code></pre></div><p>NUTS-specific statistics</p><div><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.94, min/25%/median/75%/max: 0.0 0.93 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 9% DoubledTurn =&gt; 91%
  depth: 2 =&gt; 0% 3 =&gt; 6% 4 =&gt; 90% 5 =&gt; 3%</code></pre></div><p>CmdStan result</p><div><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre></div><p>Show means</p><div><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1590382465690847, 0.2540871096609337]
  [-0.2135602445280987, 0.0433671132950074, -0.04099186704994139, 0.31217754450458784, 0.04344086523957081, -0.29914243260776846, 0.14939832611374115, -0.16367116670208504, 0.26545201642640115, -0.06620362838657098]
 0.28175428701004457</code></pre></div><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
