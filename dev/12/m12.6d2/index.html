<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-3530.6466248121224</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0716411761451508,0.2656562820590874, ...]
 * Minimum: -1.381443e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 1.70e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -2.66e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 2.97e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 863225642
 * Gradient Calls: 863225642</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0716411761451508    
  0.2656562820590874    
 -3.193015512125698e-13 
  5.408032460624978e-14 
 -1.35680683173019e-13  
  7.255300663046496e-13 
  2.0007048589686328e-14
 -7.365837244228483e-13 
  2.723243349916489e-13 
 -5.329236121076736e-13 
  6.748471128590417e-13 
 -5.63363578384997e-12  
  6.756793774899579e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([1.648485413388625, 0.20029530577528706, -0.18845517246748847, 0.10384235819546009, -0.19945091220474365, 0.3548013294421954, 0.1320810559719496, -0.20562232658473034, -0.18518888582258367, -0.17369018431878996, 0.32251527722517515, 0.14528717899142501, -0.5471736468228244], -45.19197735787051, 4, DynamicHMC.DoubledTurn, 0.9972473097069976, 15), NUTS_Transition{Array{Float64,1},Float64}([1.134979907938589, 0.26217503091825983, 0.10701798987316469, 0.07744330774440135, -0.22845026758498077, 0.3689192475217983, 0.024794790508398327, -0.11462889545026951, -0.1417784347779379, -0.3454246773794661, 0.28962949294959106, -0.2827672680963751, -0.4330736637973395], -45.11121959003028, 3, DynamicHMC.DoubledTurn, 0.9475358120504555, 7), NUTS_Transition{Array{Float64,1},Float64}([2.105035411197066, 0.16585531838861878, -0.17853478992009597, -0.021595720454770477, -0.2366283524815999, 0.3871271059097029, -0.1984377752847366, -0.2690045576282876, -0.0769210590087761, -0.4489970372956296, 0.28862601793516574, 0.029430040223352744, -0.5038759210293537], -43.330152513154324, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5978155470203221, 0.1913612949510157, -0.4947406841497428, -0.027261228048476208, 0.033432233356688976, 0.31038406244910444, 0.18292906197679706, -0.34560536787524093, 0.056645898744085585, 0.17538211837654705, 0.193675482241843, 0.016455768342642563, -0.5327796684293353], -47.599073777284055, 4, DynamicHMC.DoubledTurn, 0.6597475056663302, 15), NUTS_Transition{Array{Float64,1},Float64}([2.0174955433810475, 0.13592043002243795, -0.45613651216326556, -0.13148183506296016, -0.0875124997593578, 0.4051941923073958, 0.22755997477954884, -0.37525178726667796, 0.2538478610813278, -0.027840928597612537, 0.47355571084473225, 0.4003759212110958, -0.6094904379195005], -43.599839751101925, 4, DynamicHMC.DoubledTurn, 0.9962671938135198, 15), NUTS_Transition{Array{Float64,1},Float64}([0.4798961957363246, 0.34136930877445265, -0.05002008491103376, 0.15080470190797632, -0.0901748688409863, 0.22649213530854595, -0.07129266818473605, -0.20149111916229445, 0.17241848346818436, -0.1637217455696417, 0.1395228950182142, -0.44789630633860716, -0.4552948786508507], -42.28835879590278, 4, DynamicHMC.DoubledTurn, 0.9679635334689642, 15), NUTS_Transition{Array{Float64,1},Float64}([2.154008124645821, 0.1380954601973655, -0.42703182521600563, -0.25146821981955714, -0.03669449372248207, 0.5043386522057649, 0.1869417780092767, -0.2657936888125434, 0.17010716391190084, -0.16974497118232582, 0.48736842721305046, 0.4167294576780685, -0.6312428623345376], -43.253778987385154, 4, DynamicHMC.DoubledTurn, 0.8892419671857777, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6170765313746105, 0.20302801501825885, -0.38515300725471846, -0.005662387555414886, -0.0038983799326234416, 0.39308169079057587, 0.02466441948008382, -0.25984336477731124, 0.06290077414600237, -0.20416496287041525, 0.2246642781729239, 0.01027276138700245, -0.5166756632839068], -39.16781298564657, 3, DynamicHMC.AdjacentTurn, 0.6344043306345792, 15), NUTS_Transition{Array{Float64,1},Float64}([1.596561155653757, 0.20865114713166136, -0.2515602553610641, 0.08376928101722972, -0.08269965385463392, 0.3753798023157584, -0.051216368794859524, -0.2581534965316773, 0.06525304417330073, -0.0637657391048215, 0.2729335149242211, 0.07353211575587841, -0.5159179413248743], -38.16576120511985, 3, DynamicHMC.AdjacentTurn, 0.995898429289844, 15), NUTS_Transition{Array{Float64,1},Float64}([0.3567834441494355, 0.3332547950190803, 0.06464911276311679, 0.08575955914411415, -0.12287320985317718, 0.5975292920212267, 0.06427761060421985, -0.21128498196840217, 0.08226858851134462, -0.010542150555126344, 0.10358606241515969, -0.3219744419787265, -0.49850603253636294], -39.48671828729941, 4, DynamicHMC.DoubledTurn, 0.8725160048677535, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.0944747529090848, 0.274224477119244, 0.0029354674079361143, 0.008650951467290214, -0.11560647030622664, 0.33193289179505714, -0.06689035564178115, -0.4152674517526394, -0.10075930183940011, -0.2086712080765496, 0.1372842309816627, -0.03284010998900953, -0.46595919409253206], -38.30109848066088, 4, DynamicHMC.DoubledTurn, 0.9319150980367764, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4765823855762217, 0.22171888105195164, -0.3181554682110672, -0.059732219089596, 0.018826822153277224, 0.15058707281319603, 0.1972425629160187, -0.09715130960894332, 0.22844427177224355, -0.04086749585998589, 0.4633799734649962, -0.0629229395555792, -0.4714106081619635], -40.72140552976213, 4, DynamicHMC.DoubledTurn, 0.9935029670426069, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8189557062902634, 0.2938928558741572, 0.04012949678224347, 0.017107065030251237, 0.01291963064391663, 0.2486647187098894, 0.0222993877082799, -0.48742652057629676, 0.0007786467229014271, -0.2034392740123472, -0.09557624091715158, -0.08794644053816641, -0.39991156220522295], -44.44769335091127, 4, DynamicHMC.DoubledTurn, 0.9584294224569312, 15), NUTS_Transition{Array{Float64,1},Float64}([1.6457432657293367, 0.20397109624723211, -0.5932896886470658, -0.08750828277034481, -0.08532381083897662, 0.2692693856577967, -0.062341659807727434, -0.23220677146454471, 0.3024878062825339, -0.14930481301193055, 0.4992805040411199, -0.05162251461063154, -0.61526899932655], -47.88586593942844, 4, DynamicHMC.DoubledTurn, 0.5345696806627321, 15), NUTS_Transition{Array{Float64,1},Float64}([2.236024646873381, 0.12327270502703214, -0.09132731772348662, -0.4072730228043305, -0.050231672392608714, 0.2008787023208792, 0.2023806343194379, -0.04259985327875361, 0.2109175286880926, 0.0384581463230406, 0.20403642010103318, 0.1808009636007667, -0.4642449581486562], -50.694929939830615, 4, DynamicHMC.DoubledTurn, 0.6303651869335647, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9874624140758644, 0.27172115957232906, -0.1164561807894047, 0.2554765695818647, -0.029958648376719285, 0.31317643315214, -0.029756657294328144, -0.36574913752177274, -0.0019249517003706307, -0.41429024203471765, 0.4002301413339808, -0.26355446556196477, -0.5192509046594667], -46.29322699347302, 4, DynamicHMC.DoubledTurn, 0.9935167099914918, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0045494713370255, 0.28387565397872555, -0.13476863549462864, 0.18100646162987788, 0.14425852970952402, 0.16858802994000247, -0.10806424945446609, -0.2766245904964147, -0.17979439030465308, -0.3085255944913344, 0.3690728627854108, -0.15870865546986004, -0.3689180467958871], -43.84223493988036, 3, DynamicHMC.DoubledTurn, 0.9659325588147302, 7), NUTS_Transition{Array{Float64,1},Float64}([1.1726573870683137, 0.2412183222505554, -0.11506647909289544, -0.29857687842947433, -0.2645901989417858, 0.45888782476561285, 0.2733578581279102, -0.3411633158601434, 0.5576538337335192, 0.10391937406964566, 0.2286042831398254, -0.02983020685458146, -0.6669108659568158], -46.14554646812519, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6568373982074321, 0.3121905271409356, 0.10940358153019833, -0.2975375072387954, -0.17383726398038774, 0.3095925746499466, -0.08669688018731046, -0.5317950449782202, -0.13213413223435944, 0.07751718506202729, 0.19143217812704616, -0.2812129302402493, -0.5641504527557173], -50.81377043955007, 4, DynamicHMC.DoubledTurn, 0.8984613986115398, 15), NUTS_Transition{Array{Float64,1},Float64}([1.515011618872897, 0.20445804665669845, -0.213743285476863, 0.2912664656027904, 0.06189481261048042, 0.15108940639480722, 0.046911720779452215, 0.00994208587643184, 0.24650118345018707, -0.3504640123307812, 0.22365086826176334, 0.09522744096613012, -0.35082874539190895], -48.13687399336523, 4, DynamicHMC.DoubledTurn, 0.9008483597054815, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.256
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6670343804452409, 0.07598737521841589, 0.21038603892467214, 0.19010194060480043, 0.17983106782114286, 0.18738199318284898, 0.16654489517697363, 0.19619526139225651, 0.16415571890629213, 0.17160352035608784, 0.17077082483466124, 0.28157796823624054, 0.10318969649442006]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [1.648485413388625, 0.20029530577528706, -0.18845517246748847, 0.10384235819546009, -0.19945091220474365, 0.3548013294421954, 0.1320810559719496, -0.20562232658473034, -0.18518888582258367, -0.17369018431878996, 0.32251527722517515, 0.14528717899142501, -0.5471736468228244] 
 [1.134979907938589, 0.26217503091825983, 0.10701798987316469, 0.07744330774440135, -0.22845026758498077, 0.3689192475217983, 0.024794790508398327, -0.11462889545026951, -0.1417784347779379, -0.3454246773794661, 0.28962949294959106, -0.2827672680963751, -0.4330736637973395]  
 [2.105035411197066, 0.16585531838861878, -0.17853478992009597, -0.021595720454770477, -0.2366283524815999, 0.3871271059097029, -0.1984377752847366, -0.2690045576282876, -0.0769210590087761, -0.4489970372956296, 0.28862601793516574, 0.029430040223352744, -0.5038759210293537] 
 [1.5978155470203221, 0.1913612949510157, -0.4947406841497428, -0.027261228048476208, 0.033432233356688976, 0.31038406244910444, 0.18292906197679706, -0.34560536787524093, 0.056645898744085585, 0.17538211837654705, 0.193675482241843, 0.016455768342642563, -0.5327796684293353]
 [2.0174955433810475, 0.13592043002243795, -0.45613651216326556, -0.13148183506296016, -0.0875124997593578, 0.4051941923073958, 0.22755997477954884, -0.37525178726667796, 0.2538478610813278, -0.027840928597612537, 0.47355571084473225, 0.4003759212110958, -0.6094904379195005] </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.26712982382733363</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 964.588  967.696  1000.0  864.0  …  838.999  960.746  1000.0  424.165</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.93, min/25%/median/75%/max: 0.07 0.9 0.97 0.99 1.0
  termination: AdjacentTurn =&gt; 6% DoubledTurn =&gt; 94%
  depth: 2 =&gt; 0% 3 =&gt; 8% 4 =&gt; 91% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.0924818507076948, 0.2614048987721194]                                                                                                                                                                              
  [-0.1738547821047417, 0.04855654282065614, -0.03636779233327278, 0.31633086884917966, 0.049227540559241424, -0.2943099297701357, 0.13772584878361874, -0.15559052230476464, 0.26545848209341677, -0.08991618891197214]
 0.26712982382733363                                                                                                                                                                                                    </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
