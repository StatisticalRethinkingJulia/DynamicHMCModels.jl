<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-1907.8152502131866</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.1226842965661,0.2605350996177537, ...]
 * Minimum: -1.333748e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 6.43e-09 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -1.12e-05 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 2.32e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 515429870
 * Gradient Calls: 515429870</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.1226842965661       
  0.2605350996177537    
 -5.032954842824091e-14 
  2.2598271216963925e-14
 -2.115654063415488e-15 
  1.65063897398693e-13  
  4.369301956500001e-14 
 -9.561822980129205e-14 
  9.826353514854327e-14 
 -3.7244108001115607e-14
  2.0597845949575092e-13
  1.3523493985932433e-12
  8.632036440977554e-5  </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.8716323050058108, 0.3085666007406775, -0.15198193977418342, 0.18505614002164164, 0.01649300742079391, 0.12331662618405527, 0.06570483044828812, -0.5332711130643899, 0.045477941434304114, -0.5940837025437221, 0.1698081802300323, -0.4705974096067182, -0.5303288606302978], -42.98669007938172, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.718354628398082, 0.4373836818938006, 0.5582421039758806, 0.5421872873401465, 0.05764151406398193, 0.80514747534534, 0.037872728852368066, 0.016952902027850977, 0.39176879846515644, -0.1284858835959693, 0.22328203235692057, -0.5211342516673053, -0.7918655017027829], -48.28336204554191, 4, DynamicHMC.DoubledTurn, 0.9208410601699702, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.057670842429938016, 0.3699320141667089, 0.388227410738336, 0.2631885572454489, -0.0049987148198688686, 0.6867393716601266, 0.4764742343459367, -0.0898379393619823, 0.36906750577791786, -0.2131843283384013, 0.33431212187096443, -0.5745713719273553, -0.7174541416808572], -49.020963516496515, 4, DynamicHMC.DoubledTurn, 0.9807625927707628, 15), NUTS_Transition{Array{Float64,1},Float64}([0.6380032633391675, 0.3268082147495861, -0.1433672167759053, 0.0956217019805053, -0.10471078256999503, 0.22098489668503013, -0.20736233947167326, -0.14767719077746608, -0.0960296123989186, -0.11076279270543717, 0.12281177584231916, -0.3310309568541428, -0.5322512509054927], -45.87768681215047, 4, DynamicHMC.DoubledTurn, 0.9708818400503586, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1794033189057918, 0.25277164366641386, -0.39307503287219475, 0.04347645555132642, -0.01904274435599082, 0.40075681864338225, -0.03323405537655483, -0.41630910024769924, 0.11857821483854195, -0.48627186404815637, 0.3284996416230563, -0.14361311289804382, -0.4972432624345723], -42.309211237174345, 4, DynamicHMC.DoubledTurn, 0.9947173103789441, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9254980715919775, 0.2707159182228925, 0.04449428917231278, 0.15747916711891832, 0.014897340401589222, 0.3330914590973808, 0.26804830316228967, -0.07752457434720834, -0.03831341885463578, 0.030103717366331453, 0.2931977143960872, -0.01629849444351253, -0.4550287815804398], -39.74121825832414, 4, DynamicHMC.DoubledTurn, 0.9808026061562508, 15), NUTS_Transition{Array{Float64,1},Float64}([1.102515878207004, 0.2856137959979657, -0.18835537088806453, -0.05947231013417309, -0.33485942293394094, 0.27318703563307895, 0.10939960143624196, -0.3719193685730761, -0.19288232596267954, -0.33480674601677046, -0.13988153904269035, -0.5268240512429131, -0.6159010289172504], -43.53455358978753, 4, DynamicHMC.DoubledTurn, 0.9298427733313261, 15), NUTS_Transition{Array{Float64,1},Float64}([0.08023564992975743, 0.37591845958876674, 5.000011084009548e-5, 0.38086983001630875, 0.00270765202318754, 0.6029150203517973, 0.2850865919175942, -0.37019694214209725, 0.0471247856461343, -0.3663940568622809, -0.10876412356819588, -0.5866808487597525, -0.7132063650782975], -45.14165911690438, 4, DynamicHMC.DoubledTurn, 0.9753129062622307, 15), NUTS_Transition{Array{Float64,1},Float64}([-1.4251803458557175, 0.5364244699239521, -0.017751375497894833, 0.7192554795747783, 0.002019164054470012, 0.695365236149332, 0.27285362720111017, -0.37814406926876987, 0.2785403091615334, -0.39135025860115974, -0.17172609317493037, -0.9613717799520051, -0.6826256004602587], -48.986518623826285, 4, DynamicHMC.DoubledTurn, 0.9765090496406619, 15), NUTS_Transition{Array{Float64,1},Float64}([2.7807143829076817, 0.07790246276719728, -0.45556560267652135, -0.588193629857449, -0.12857692164725273, 0.1229842926747276, -0.08050215965299853, -0.3377411965179382, 0.037046850689793936, -0.012524649035742474, 0.6451699962174745, 0.37793150676050813, -0.5614586849468813], -50.80132722524981, 4, DynamicHMC.DoubledTurn, 0.9600690616603383, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([1.003129939101831, 0.2612525244270653, -0.02799117934696771, 0.021810112340391277, 0.014345933262531002, 0.3030234773008753, 0.14151114172223678, -0.07370442444175004, 0.4308269952203729, -0.16394881634502775, 0.5160764505993343, 0.016533950065707403, -0.6227621077052229], -45.72676500451119, 4, DynamicHMC.DoubledTurn, 0.8533022381350166, 15), NUTS_Transition{Array{Float64,1},Float64}([0.09672246196337997, 0.365670633956853, -0.13245930307921966, 0.10802849512610951, 0.10427848047671856, 0.44107300640064684, 0.22037245742894826, -0.8571027466267243, 0.18090406518356505, 0.0464335745886256, 0.24384680140541737, -0.3432418368714057, -0.561765900149122], -45.97716193492958, 4, DynamicHMC.DoubledTurn, 0.985311595855881, 15), NUTS_Transition{Array{Float64,1},Float64}([0.4300678106274801, 0.35083891125229155, -0.22487028704966613, -0.15991822336206946, 0.17606393018562347, 0.482065623461547, 0.018610271201143024, -0.880161761448196, 0.06451691808695281, -0.2572274768085383, 0.2632805623921621, -0.4659101898127778, -0.6634786198652857], -44.78318163583143, 4, DynamicHMC.DoubledTurn, 0.834901056265704, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8464988453693247, 0.2877567721072808, -0.11615384905230133, 0.22638104796722927, -0.12992741414316217, 0.09652993178643038, 0.08836782092718366, -0.6177162040568263, 0.2689939371978088, -0.26895192720414074, 0.13101295105400834, -0.08724605163538487, -0.5487450434505723], -45.54229309487372, 4, DynamicHMC.DoubledTurn, 0.9996285864939561, 15), NUTS_Transition{Array{Float64,1},Float64}([0.45111827737421384, 0.33925748046712867, 0.17510977972282585, 0.26305301178111573, -0.30632735091914093, 0.46276826014676653, 0.1775591331118197, -0.8470592059277526, 0.01095289059199453, -0.058232770182916005, 0.04493491663958509, -0.3261592920348872, -0.5667820163673939], -48.03587928224458, 4, DynamicHMC.DoubledTurn, 0.9392497412533961, 15), NUTS_Transition{Array{Float64,1},Float64}([0.4885833314382858, 0.3218753317051236, -0.05793385428538854, 0.10294886782550355, 0.14567089371912031, 0.5499812911757778, 0.0410106460538063, -0.33906113776973795, 0.3149855564958831, -0.10242704589753462, 0.24528677471475344, -0.20894339169511755, -0.5758715757720757], -43.9442139737492, 4, DynamicHMC.DoubledTurn, 1.0, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.7925644878006282, 0.44409567680843565, 0.4599404180049902, 0.37921481465064744, 0.3207957257716285, 0.6399244564401078, 0.30180746502375627, -0.2617533738062748, 0.5765678513209407, -0.03302912807202575, 0.23085053628868402, -0.2875766468295295, -0.5878065851839953], -43.82896269740471, 3, DynamicHMC.DoubledTurn, 0.8890911172067941, 7), NUTS_Transition{Array{Float64,1},Float64}([3.190616803354757, 0.029262357531636585, -0.29987719627957016, 0.08619982604525003, -0.4474206351862628, 0.40667548855109803, -0.15419105199717975, -0.13345601251319364, -0.018775708392697196, -0.2219328773445783, 0.7394309002576603, 0.46550195141878975, -0.5966612859119353], -51.84973762770059, 4, DynamicHMC.DoubledTurn, 0.9833026804246913, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.3549254615477485, 0.4375421629164092, -0.22399497772071117, -0.48147351381930054, 0.10530968601242313, 0.31839689367137564, 0.06310322403620304, -0.9091525488687331, 0.11550988197820156, -0.2663793563605611, -0.26605479511067415, -0.7424227224985364, -0.575357835861875], -52.53626640423511, 4, DynamicHMC.DoubledTurn, 0.9756284186887659, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5134314776525977, 0.2060089589081239, -0.0576229889415374, 0.5286341887354454, -0.012023997639895447, 0.3264846758352352, 0.16349072620537006, -0.1086339249818219, 0.15647093146911215, -0.20124811881167678, 0.523665763687678, 0.13323526492152776, -0.5092580402801884], -50.52085247816572, 4, DynamicHMC.DoubledTurn, 0.9898260838149656, 15)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.258
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.7049315992806313, 0.07625988232534067, 0.2527483663947292, 0.2667312890693057, 0.22850677797360086, 0.17266113901334262, 0.18037315318020816, 0.22006582898972651, 0.18215716366552806, 0.18238044094882008, 0.15470370053464927, 0.2365988654418466, 0.11418362916770328]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.8716323050058108, 0.3085666007406775, -0.15198193977418342, 0.18505614002164164, 0.01649300742079391, 0.12331662618405527, 0.06570483044828812, -0.5332711130643899, 0.045477941434304114, -0.5940837025437221, 0.1698081802300323, -0.4705974096067182, -0.5303288606302978]     
 [-0.718354628398082, 0.4373836818938006, 0.5582421039758806, 0.5421872873401465, 0.05764151406398193, 0.80514747534534, 0.037872728852368066, 0.016952902027850977, 0.39176879846515644, -0.1284858835959693, 0.22328203235692057, -0.5211342516673053, -0.7918655017027829]         
 [-0.057670842429938016, 0.3699320141667089, 0.388227410738336, 0.2631885572454489, -0.0049987148198688686, 0.6867393716601266, 0.4764742343459367, -0.0898379393619823, 0.36906750577791786, -0.2131843283384013, 0.33431212187096443, -0.5745713719273553, -0.7174541416808572]     
 [0.6380032633391675, 0.3268082147495861, -0.1433672167759053, 0.0956217019805053, -0.10471078256999503, 0.22098489668503013, -0.20736233947167326, -0.14767719077746608, -0.0960296123989186, -0.11076279270543717, 0.12281177584231916, -0.3310309568541428, -0.5322512509054927]   
 [1.1794033189057918, 0.25277164366641386, -0.39307503287219475, 0.04347645555132642, -0.01904274435599082, 0.40075681864338225, -0.03323405537655483, -0.41630910024769924, 0.11857821483854195, -0.48627186404815637, 0.3284996416230563, -0.14361311289804382, -0.4972432624345723]</code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2738478288436965</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 549.418  537.025  844.888  879.272  …  660.028  601.277  548.835  365.781</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.91, min/25%/median/75%/max: 0.0 0.89 0.96 0.99 1.0
  termination: AdjacentDivergent =&gt; 0% AdjacentTurn =&gt; 6% DoubledTurn =&gt; 94%
  depth: 2 =&gt; 0% 3 =&gt; 10% 4 =&gt; 90% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1257222364608799, 0.2589145070058516]                                                                                                                                                                           
  [-0.1854305732343278, 0.04062823678809484, -0.04836011228671894, 0.304653963838844, 0.03631307440788576, -0.3057042533709754, 0.13299866703249624, -0.16738722629716013, 0.26027380023130586, -0.09614931417219733]
 0.2738478288436965                                                                                                                                                                                                  </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
