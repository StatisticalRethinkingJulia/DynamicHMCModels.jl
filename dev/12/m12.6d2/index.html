<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-4112.846155896905</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.0861621124916807,0.26420695628067237, ...]
 * Minimum: -1.316705e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 2.48e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -3.91e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 2.14e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 922554866
 * Gradient Calls: 922554866</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.0861621124916807    
  0.26420695628067237   
  1.467491232099851e-13 
 -4.8990181313599965e-14
  3.266749988265849e-14 
 -4.169964009903023e-13 
 -7.080659438438397e-14 
  3.133449031668043e-13 
 -2.104499398603671e-13 
  1.7995252779970365e-13
 -4.628868771176487e-13 
 -2.6538814622179302e-12
  9.35785785205402e-5   </code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.46273932038779886, 0.3307775021542491, 0.05685667573620409, 0.12419426962907155, -0.007843045147898776, 0.3803217821396628, 0.032150629725933993, -0.01749498041000317, 0.016540354904567837, 0.05791188198686932, 0.37206690384437713, -0.3890331814060135, 0.5533544151313021], -44.121120248960096, 4, DynamicHMC.DoubledTurn, 0.9471351482159353, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1498611114564117, 0.24956053032957481, 0.2219246745217159, -0.06372686555903591, 0.22529216861431797, 0.37160336712532116, 0.4224744902933563, -0.29201373326388025, 0.4367908673311704, -0.2589765808041175, 0.4162428217558803, -0.15897303350122272, 0.552812778814923], -46.40903485606717, 4, DynamicHMC.DoubledTurn, 0.974285939346148, 15), NUTS_Transition{Array{Float64,1},Float64}([0.7973895924965395, 0.28836175275130177, -0.291412932338688, 0.3721769570840552, -0.10162920956516616, 0.49079966121326357, -0.15809879952874906, -0.13115652090520538, -0.06135052690339127, 0.026640422679086576, 0.2631348041815625, 0.037108878845631015, 0.4533759512181817], -48.91349344490277, 4, DynamicHMC.DoubledTurn, 0.9826888949863534, 15), NUTS_Transition{Array{Float64,1},Float64}([1.4524791135168045, 0.2312815067097845, -0.19679438020123838, -0.0012291757785612145, -0.034933485092742154, 0.08021369309265913, 0.08316551568351749, -0.35735256284839495, 0.1992561597801349, -0.15805650318667816, 0.17554465126685792, 0.023110597956949114, 0.4615330857343009], -42.394465065052756, 3, DynamicHMC.AdjacentTurn, 0.8074868246778649, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8816400738055654, 0.2874547741826166, -0.10799708648241915, 0.0036762112506695363, 0.06749314936827105, 0.2900648054551248, 0.014278480470069532, -0.3106343647926656, 0.15524649337281027, -0.15089846406814156, 0.27359898321703197, -0.16617362091421545, 0.38220337102134816], -34.83390151650473, 3, DynamicHMC.DoubledTurn, 0.9824102453718816, 7), NUTS_Transition{Array{Float64,1},Float64}([1.6550366285941973, 0.1992462813671232, -0.31703435878287617, -0.09537839150554524, -0.02937168947175283, 0.2419448757882288, -0.0159559713584887, -0.27766910336688827, 0.10225532148851744, 0.026332945356947884, 0.37467667718537295, 0.06360954590167778, 0.4043812722576528], -37.74721397002143, 4, DynamicHMC.DoubledTurn, 0.8631462344680787, 15), NUTS_Transition{Array{Float64,1},Float64}([-0.08748142462068803, 0.3930022129316478, 0.06022644356117999, 0.16879335367357248, 0.09162150570073674, 0.14620757093794212, 0.026944858858915587, -0.10850076490069144, 0.032663083891679864, -0.30074823350008184, 0.0964746726636298, -0.3625720662246097, 0.4689008504899081], -41.31000379655871, 4, DynamicHMC.DoubledTurn, 0.9133228267957959, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1256476221913254, 0.25285501186606646, -0.442469710827047, 0.1484854671242903, -0.12206697765087325, 0.5422938544145991, 0.12685872380404453, -0.20300459233806578, 0.07897383744172662, 0.1206398254757856, 0.3745784199068098, -0.11552779876876038, 0.5773490119753247], -42.25766835610245, 4, DynamicHMC.DoubledTurn, 0.9891459660291223, 15), NUTS_Transition{Array{Float64,1},Float64}([1.7650785061725436, 0.19735214102490659, 0.044202704724228596, -0.042287778078872254, 0.024604204804265305, -0.07972136409036122, -0.0641428805032975, -0.14384236011928506, 0.09125874333377831, -0.2646364919967932, 0.11227309373264256, 0.05210883120991903, 0.30950205341712833], -40.353101076741964, 4, DynamicHMC.DoubledTurn, 0.9190291146541173, 15), NUTS_Transition{Array{Float64,1},Float64}([0.8033706117422265, 0.28702736364436227, -0.46090148225742184, -0.019741439116177442, -0.19817498130570838, 0.5806947947395951, 0.023530686305543336, -0.3708500699227732, 0.08674052040366663, 0.057206609280979606, 0.22446559927097073, -0.1403814982661812, 0.5733636933644018], -41.8030691124463, 4, DynamicHMC.DoubledTurn, 0.9412701934439126, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.9562971084565786, 0.26234523583994057, -0.1656668919115387, 0.029003147936719344, -0.09302946110642638, 0.30024219343641784, 0.09582912933367366, -0.19818429706467136, 0.036343896295207595, 0.07322388204920419, 0.14886228228520493, 0.056997339917441533, 0.41659033181428], -43.22532115403195, 2, DynamicHMC.AdjacentTurn, 0.5560245418484315, 7), NUTS_Transition{Array{Float64,1},Float64}([0.9944159087947739, 0.2750895494721815, -0.06696458982283873, -0.021151549611024265, -0.0416517947721924, 0.20895747281307706, -0.02498681737235072, -0.17336353607444294, -0.0012764319365992371, -0.16306935556350177, 0.16545908437016194, -0.21156885660479988, 0.4032878290485767], -40.283082524769796, 3, DynamicHMC.DoubledTurn, 0.9518166422878025, 7), NUTS_Transition{Array{Float64,1},Float64}([1.425458154196459, 0.21884095660768876, -0.07682619551797111, 0.07320376499403815, -0.1368095533644174, 0.2150217993861129, -0.10767728815161377, -0.40387653999784817, 0.18263951007767396, -0.003485506812731516, 0.30905299744744386, 0.11664088078533606, 0.4136361164158951], -34.94524091610256, 4, DynamicHMC.DoubledTurn, 0.9914630286186923, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0390833175023058, 0.2655486076078969, 0.1183025757021595, -0.016221400781280548, -0.04285389252651697, 0.32899098828321816, 0.06723583862114349, -0.10384555916169859, 0.2624567109694304, -0.012615047754907977, 0.2779152629280902, -0.013683075515082022, 0.37878192349258394], -39.064160295352764, 4, DynamicHMC.DoubledTurn, 0.9785932582384166, 15), NUTS_Transition{Array{Float64,1},Float64}([1.0760245445227643, 0.25797681379739806, 0.15988399447006663, -0.08242619601066611, -0.002817787753377682, 0.3054638683875982, 0.015489629543438813, -0.13739590861508874, 0.2311566993702211, 0.013003118661228313, 0.24561823222923274, -0.03611267655534996, 0.4043543718578375], -37.84657424818631, 4, DynamicHMC.DoubledTurn, 0.966193111333794, 15), NUTS_Transition{Array{Float64,1},Float64}([1.434076214375282, 0.22959400107334071, -0.6198350849828511, 0.25519492761531065, -0.04842048514885671, 0.25385644667633683, -0.001869446022703898, -0.3557613668676231, 0.18795718341876383, -0.1962676306174446, 0.09085712548407582, -0.07419413793970368, 0.5398158977033637], -41.72069022167778, 4, DynamicHMC.DoubledTurn, 0.7597477033582455, 15), NUTS_Transition{Array{Float64,1},Float64}([1.225667279796045, 0.26797425974270206, -0.5466880625092153, -0.206427043929447, -0.29889765941971536, 0.2211470017902779, -0.5137179443222657, -0.4083106588104576, 0.13499790182516935, -0.253179611797017, 0.1914947194410371, -0.15607946689726893, 0.6475191712585436], -43.40160078531394, 4, DynamicHMC.DoubledTurn, 0.9199539585872204, 15), NUTS_Transition{Array{Float64,1},Float64}([0.930013298522892, 0.27794715127160036, -0.15727807545, 0.011657764824003304, 0.27303033799619975, 0.35933508914894896, 0.11000916387623394, 0.011990055104876489, 0.15898880882940727, 0.11830504036671981, 0.2655452340379913, -0.05434740227378759, 0.5344486542260438], -47.274035442712645, 4, DynamicHMC.DoubledTurn, 0.7801806721196042, 15), NUTS_Transition{Array{Float64,1},Float64}([0.5973473795670241, 0.32624065556925685, -0.2965706115256812, -0.1492384106151937, -0.0974286132376351, 0.08827103659801029, -0.1593913931581931, -0.12146327871675605, 0.1748558841980465, -0.07384454205225466, 0.03654160722347827, -0.3582479842502373, 0.34049019572647427], -47.14089817966032, 4, DynamicHMC.DoubledTurn, 0.9929835357264444, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9585076906221919, 0.27088325375625205, -0.09183500946832536, -0.15658966633108465, -0.04080908966206299, 0.28038851411311144, 0.11401822333850842, -0.2593626420606646, 0.29033946435914626, -0.18425503315628355, 0.17886079224820176, 0.024180996834600038, 0.4512977486570934], -43.90276812970761, 3, DynamicHMC.DoubledTurn, 1.0, 7)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.273
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.6363959849937165, 0.0703986994764258, 0.21455927605439207, 0.1929292628232017, 0.17637616861402283, 0.19062833704847695, 0.17431410765684127, 0.1822914138651921, 0.15790609616577547, 0.17536014709594105, 0.15576725651637796, 0.24087709963884102, 0.09515559838184288]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.46273932038779886, 0.3307775021542491, 0.05685667573620409, 0.12419426962907155, -0.007843045147898776, 0.3803217821396628, 0.032150629725933993, -0.01749498041000317, 0.016540354904567837, 0.05791188198686932, 0.37206690384437713, -0.3890331814060135, 0.5533544151313021]   
 [1.1498611114564117, 0.24956053032957481, 0.2219246745217159, -0.06372686555903591, 0.22529216861431797, 0.37160336712532116, 0.4224744902933563, -0.29201373326388025, 0.4367908673311704, -0.2589765808041175, 0.4162428217558803, -0.15897303350122272, 0.552812778814923]         
 [0.7973895924965395, 0.28836175275130177, -0.291412932338688, 0.3721769570840552, -0.10162920956516616, 0.49079966121326357, -0.15809879952874906, -0.13115652090520538, -0.06135052690339127, 0.026640422679086576, 0.2631348041815625, 0.037108878845631015, 0.4533759512181817]    
 [1.4524791135168045, 0.2312815067097845, -0.19679438020123838, -0.0012291757785612145, -0.034933485092742154, 0.08021369309265913, 0.08316551568351749, -0.35735256284839495, 0.1992561597801349, -0.15805650318667816, 0.17554465126685792, 0.023110597956949114, 0.4615330857343009]
 [0.8816400738055654, 0.2874547741826166, -0.10799708648241915, 0.0036762112506695363, 0.06749314936827105, 0.2900648054551248, 0.014278480470069532, -0.3106343647926656, 0.15524649337281027, -0.15089846406814156, 0.27359898321703197, -0.16617362091421545, 0.38220337102134816]  </code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2663503167749338</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 532.354  523.796  810.542  825.711  …  841.971  762.883  579.318  299.692</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.91, min/25%/median/75%/max: 0.0 0.88 0.96 0.99 1.0
  termination: AdjacentTurn =&gt; 7% DoubledTurn =&gt; 93%
  depth: 2 =&gt; 1% 3 =&gt; 14% 4 =&gt; 85% 5 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.0965850877008756, 0.2619655959656983]                                                                                                                                                                             
  [-0.17882372249306838, 0.038034061171399354, -0.039453888267134175, 0.3008485788221232, 0.03330368327196677, -0.292662809502019, 0.1372947094207584, -0.16696800310049717, 0.24832861388344718, -0.09420596522964986]
 0.2663503167749338                                                                                                                                                                                                    </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
