<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>m12.6d2 · DynamicHMCModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DynamicHMCModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/m2.1d/">m2.1d</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../../04/m4.1d/">m4.1d</a></li><li><a class="toctext" href="../../04/m4.2d/">m4.2d</a></li><li><a class="toctext" href="../../04/m4.5d/">m4.5d</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1d1/">m5.1d1</a></li><li><a class="toctext" href="../../05/m5.3d/">m5.3d</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li></ul></li><li><span class="toctext">Chapter 10</span><ul><li><a class="toctext" href="../../10/m10.02d/">m10.02d</a></li><li><a class="toctext" href="../../10/m10.02d1/">m10.02d1</a></li><li><a class="toctext" href="../../10/m10.04d/">m10.04d</a></li><li><a class="toctext" href="../../10/m10.04d1/">m10.04d1</a></li><li><a class="toctext" href="../../10/m10.04d2/">m10.04d2</a></li></ul></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../m12.6d/">m12.6d</a></li><li><a class="toctext" href="../m12.6d1/">m12.6d1</a></li><li class="current"><a class="toctext" href>m12.6d2</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 12</li><li><a href>m12.6d2</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/DynamicHMCModels.jl/blob/master/scripts/12/m12.6d2.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>m12.6d2</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-julia">using DynamicHMCModels

ProjDir = rel_path_d(&quot;..&quot;, &quot;scripts&quot;, &quot;12&quot;)

df = CSV.read(rel_path( &quot;..&quot;, &quot;data&quot;,  &quot;Kline.csv&quot;), delim=&#39;;&#39;);
size(df) # Should be 10x5</code></pre><pre><code class="language-none">(10, 5)</code></pre><p>New col logpop, set log() for population data</p><pre><code class="language-julia">df[:society] = 1:10;
df[:logpop] = map((x) -&gt; log(x), df[:population]);
#df[:total_tools] = convert(Vector{Int64}, df[:total_tools])
first(df[[:total_tools, :logpop, :society]], 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>total_tools</th><th>logpop</th><th>society</th></tr><tr><th></th><th>Int64⍰</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>5 rows × 3 columns</p><tr><th>1</th><td>13</td><td>7.00307</td><td>1</td></tr><tr><th>2</th><td>22</td><td>7.31322</td><td>2</td></tr><tr><th>3</th><td>24</td><td>8.18869</td><td>3</td></tr><tr><th>4</th><td>43</td><td>8.47449</td><td>4</td></tr><tr><th>5</th><td>33</td><td>8.90924</td><td>5</td></tr></tbody></table><p>Define problem data structure</p><pre><code class="language-julia">struct m_12_06d{TY &lt;: AbstractVector, TX &lt;: AbstractMatrix,
  TS &lt;: AbstractVector}
    &quot;Observations (total_tools).&quot;
    y::TY
    &quot;Covariates (logpop)&quot;
    X::TX
    &quot;Society&quot;
    S::TS
    &quot;Number of observations (10)&quot;
    N::Int
    &quot;Number of societies (also 10)&quot;
    N_societies::Int
end;</code></pre><p>Make the type callable with the parameters <em>as a single argument</em>.</p><pre><code class="language-julia">function (problem::m_12_06d)(θ)
    @unpack y, X, S, N, N_societies = problem   # extract the data
    @unpack β, α, s = trans(θ)  # β : a, bp, α : a_society, s
    σ = s[1]^2
    ll = 0.0
    ll += logpdf(Cauchy(0, 1), σ) # sigma
    ll += sum(logpdf.(Normal(0, σ), α)) # α[1:10]
    ll += logpdf.(Normal(0, 10), β[1]) # a
    ll += logpdf.(Normal(0, 1), β[2]) # bp
    ll += sum(
      [loglikelihood(Poisson(exp(α[S[i]] + dot(X[i, :], β))), [y[i]]) for i in 1:N]
    )
end</code></pre><p>Instantiate the model with data and inits.</p><pre><code class="language-julia">N = size(df, 1)
N_societies = length(unique(df[:society]))
X = hcat(ones(Int64, N), df[:logpop]);
S = df[:society];
y = df[:total_tools];
γ = (β = [1.0, 0.25], α = rand(Normal(0, 1), N_societies), s = [0.2]);
p = m_12_06d(y, X, S, N, N_societies);</code></pre><pre><code class="language-none">Main.ex-m12.6d2.m_12_06d{Array{Union{Missing, Int64},1},Array{Float64,2},Array{Int64,1}}(Union{Missing, Int64}[13, 22, 24, 43, 33, 19, 40, 28, 55, 71], [1.0 7.003065458786462; 1.0 7.313220387090301; … ; 1.0 9.769956159911606; 1.0 12.524526376648708], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 10, 10)</code></pre><p>Function convert from a single vector of parms to parks NamedTuple</p><pre><code class="language-julia">trans = as((β = as(Array, 2), α = as(Array, 10), s = as(Array, 1)));</code></pre><pre><code class="language-none">TransformVariables.TransformNamedTuple{(:β, :α, :s),Tuple{TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1},TransformVariables.ArrayTransform{TransformVariables.Identity,1}}}((TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (2,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (10,)), TransformVariables.ArrayTransform{TransformVariables.Identity,1}(TransformVariables.Identity(), (1,))), 13)</code></pre><p>Define input parameter vector</p><pre><code class="language-julia">θ = inverse(trans, γ);
p(θ)</code></pre><pre><code class="language-none">-2757.477262661729</code></pre><p>Maximum<em>a</em>posterior</p><pre><code class="language-julia">using Optim

x0 = θ;
lower = vcat([0.0, 0.0], -3ones(10), [0.0]);
upper = vcat([2.0, 1.0], 3ones(10), [5.0]);
ll(x) = -p(x);

inner_optimizer = GradientDescent()

res = optimize(ll, lower, upper, x0, Fminbox(inner_optimizer));
res</code></pre><pre><code class="language-none">Results of Optimization Algorithm
 * Algorithm: Fminbox with Gradient Descent
 * Starting Point: [1.0,0.25, ...]
 * Minimizer: [1.114394806696868,0.2613573257559183, ...]
 * Minimum: -1.300194e+02
 * Iterations: 1000
 * Convergence: false
   * |x - x&#39;| ≤ 0.0e+00: false 
     |x - x&#39;| = 1.73e-11 
   * |f(x) - f(x&#39;)| ≤ 0.0e+00 |f(x)|: false
     |f(x) - f(x&#39;)| = -3.14e-08 |f(x)|
   * |g(x)| ≤ 1.0e-08: false 
     |g(x)| = 1.96e+05 
   * Stopped by an increasing objective: false
   * Reached Maximum Number of Iterations: false
 * Objective Calls: 845758097
 * Gradient Calls: 845758097</code></pre><p>Minimum gives MAP estimate:</p><pre><code class="language-julia">Optim.minimizer(res)</code></pre><pre><code class="language-none">13-element Array{Float64,1}:
  1.114394806696868     
  0.2613573257559183    
 -3.6496409496686056e-13
  1.384794456497212e-13 
 -5.0272275890011097e-14
  1.1059868420572644e-12
  2.43633679416912e-13  
 -7.31224048129755e-13  
  6.130828636791044e-13 
 -3.544365957403375e-13 
  1.31698894249946e-12  
  8.571472457627797e-12 
  0.00010199072737120281</code></pre><p>Write a function to return properly dimensioned transformation.</p><pre><code class="language-julia">problem_transformation(p::m_12_06d) =
  as( Vector, length(θ) )</code></pre><p>Wrap the problem with a transformation, then use ForwardDiff for the gradient.</p><pre><code class="language-julia">P = TransformedLogDensity(problem_transformation(p), p)
∇P = LogDensityRejectErrors(ADgradient(:ForwardDiff, P));
#∇P = ADgradient(:ForwardDiff, P);</code></pre><p>Tune and sample.</p><pre><code class="language-julia">chain, NUTS_tuned = NUTS_init_tune_mcmc(∇P, 1000);</code></pre><pre><code class="language-none">(NUTS_Transition{Array{Float64,1},Float64}[NUTS_Transition{Array{Float64,1},Float64}([0.8390110320369838, 0.2953629100588751, 0.015142209489578382, 0.025729496317581126, 0.026976865668593523, 0.10524551552875548, 0.008673466498168067, -0.18016270512473387, 0.026279957095881178, -0.01922968939048697, 0.0956238925690598, -0.09490777979209786, 0.31518484714277595], -34.362012332084184, 4, DynamicHMC.DoubledTurn, 0.9882952285322578, 15), NUTS_Transition{Array{Float64,1},Float64}([1.3051610134179974, 0.24314678280545407, -0.014240429862779794, 0.06323899864424833, 0.03687918821519368, 0.026022301397149752, 0.023823480229773437, 0.09962927299292455, 0.007616741575145321, -0.0023286516780750104, -0.02183164884202901, -0.025068306883904927, 0.19828001145311355], -32.993735359068, 4, DynamicHMC.DoubledTurn, 0.9561711193973202, 15), NUTS_Transition{Array{Float64,1},Float64}([1.1584426287713647, 0.25424392869483253, 0.04390910890035206, 0.039459465998049906, -0.03689027394197539, 0.06307573337129115, -0.0078016572688544075, -0.08363661386477711, 0.06103162326136479, -0.05629716975364422, 0.046653172680692655, 0.05357219609948755, 0.233196982174594], -32.16494494918859, 5, DynamicHMC.AdjacentTurn, 1.0, 47), NUTS_Transition{Array{Float64,1},Float64}([0.7938672243047535, 0.3005984178247618, 0.010519839844750953, 0.03428362348075177, -0.026636691583605175, 0.025527132869082286, -0.05498034618024884, -0.03707978952089092, 0.011137777812607778, 0.026673514931534793, 0.028087403207698328, -0.031477988031323595, 0.20181088614358875], -33.30336950474242, 3, DynamicHMC.DoubledTurn, 0.8923884655402896, 7), NUTS_Transition{Array{Float64,1},Float64}([0.8959937545439725, 0.2817816845736662, -0.024533040992968057, -0.06883563532499577, -0.07316549368042917, 0.018412978620964228, 0.02157739806672984, -0.018169509137923465, -0.006601733223356797, -0.048197897847085586, -0.03946429600156483, -0.020268751119429555, 0.20104949019527296], -32.59731458434025, 4, DynamicHMC.AdjacentTurn, 0.5736437166798466, 31), NUTS_Transition{Array{Float64,1},Float64}([0.3232245116143653, 0.34079641365900026, -0.09878939037549617, 0.07165312643130173, 0.09723935790493227, 0.04691933405333526, -0.0014655416119211035, -0.004449423413303843, 0.18822228242164174, 0.03233559977952998, 0.09892533630795775, -0.05652055368247529, 0.3162091826103877], -37.953731725807025, 4, DynamicHMC.DoubledTurn, 0.6700367215525566, 15), NUTS_Transition{Array{Float64,1},Float64}([1.5839504424763904, 0.20864720136690768, -0.08843432849544391, 0.15950846311617156, 0.07144097692080188, 0.5162619394966242, 0.08053081095605358, -0.4819378858423033, 0.15946698390840128, -0.3035908527008025, 0.3476165105684624, -0.028041652777297366, 0.5378318625104569], -40.23624103817726, 5, DynamicHMC.DoubledTurn, 0.9726070073515187, 31), NUTS_Transition{Array{Float64,1},Float64}([0.6008148267314017, 0.3128818105656066, 0.0638842169382758, -0.03685603934602411, -0.08069395899980591, 0.12047547689786721, 0.12867711085278563, -0.05623887360095535, -0.16120708994416622, -0.06620862724269323, 0.2841756262727827, -0.053951251216059586, 0.39083918809843754], -41.276822314056695, 5, DynamicHMC.DoubledTurn, 0.9985745714966018, 31), NUTS_Transition{Array{Float64,1},Float64}([0.7089949449247945, 0.30362131886691873, 0.013782650583476913, -0.22854939971736132, -0.07107557397221634, 0.06797319493068729, 0.10405347451141289, 0.04478663998478349, -0.15192913458112842, -0.063066323306843, 0.2056088349935554, -0.11209753585063309, 0.387730144031104], -43.73156323398171, 4, DynamicHMC.DoubledTurn, 0.9031668946045889, 15), NUTS_Transition{Array{Float64,1},Float64}([0.9495242979908354, 0.2767386290270375, -0.19485040246346505, 0.12090324137560832, -0.024452455800308352, 0.2060484765578804, -0.05439974749133432, -0.1804555607180063, 0.12725525105791233, -0.044990144030849125, -0.026575541460717028, 0.07584363655171983, 0.28793774756459445], -44.22151752049586, 4, DynamicHMC.DoubledTurn, 0.9985093018999922, 15)  …  NUTS_Transition{Array{Float64,1},Float64}([0.20203492287172675, 0.34228407901830143, -0.04064830578733313, 0.23117462534792727, -0.32332744808123665, 0.5132770541636127, 0.06055805691956851, -0.45290142194400335, 0.01709648399930383, -0.30021050257426063, 0.3492582871652311, -0.43947064917389145, 0.5559672002107167], -53.361222484097446, 5, DynamicHMC.DoubledTurn, 0.952255745005199, 31), NUTS_Transition{Array{Float64,1},Float64}([1.8777158432494265, 0.1595691721622663, -0.17628257705773365, 0.14604188594938264, 0.0172383427298364, 0.3749082317008424, 0.29571105443952533, -0.16553029798289798, 0.20949414430592114, 0.05883940384015028, 0.30577420893265456, 0.2272225636385858, 0.46739044930257506], -46.13864579681627, 5, DynamicHMC.DoubledTurn, 0.9978431619004721, 31), NUTS_Transition{Array{Float64,1},Float64}([1.1630052075241935, 0.26158972271004827, -0.32665288898099654, -0.02260094175067541, -0.02583606566704634, 0.29511766314770366, -0.24637403989230025, -0.3163165558033285, -0.08388807748457834, -0.23287724582283445, 0.11621936009950122, -0.2327301975692259, 0.4243897099924355], -38.16805541588566, 5, DynamicHMC.DoubledTurn, 0.999772475589084, 31), NUTS_Transition{Array{Float64,1},Float64}([1.0768378724354752, 0.28633112639908903, -0.2267060562278229, 0.0715610367555155, -0.019835903562114024, 0.2807770757651604, -0.25382573601785, -0.2014887383309399, -0.07356670323796605, -0.2348368253158539, 0.1492168957402152, -0.29385778316376465, 0.411906116775584], -39.325444570698124, 5, DynamicHMC.DoubledTurn, 0.9790508203746783, 31), NUTS_Transition{Array{Float64,1},Float64}([0.7889882958162128, 0.28095826882953473, -0.12127775333346734, -0.048739650795208284, 0.049000502258866756, 0.5733539598041882, 0.25146688396773753, -0.19769038168023362, 0.24825569415001064, 0.014631675254779177, 0.4841839513730882, -0.24128603992703818, 0.5339674066436542], -46.11206854656924, 5, DynamicHMC.DoubledTurn, 0.9356310291474971, 31), NUTS_Transition{Array{Float64,1},Float64}([0.7700354262693567, 0.3007999776712216, 0.15489985209950177, -0.1365120018843336, -0.2169593806924119, 0.420829715992824, 0.13820978247178498, -0.1577773112909546, 0.14038127413476675, -0.056406716663532044, 0.19508779540590743, -0.27229030756106487, 0.40914066783099595], -42.97739778457168, 5, DynamicHMC.DoubledTurn, 0.9953148362873494, 31), NUTS_Transition{Array{Float64,1},Float64}([1.0360330598844762, 0.2587968094677196, -0.49505293866353767, 0.16608955393086905, 0.27017001924738715, 0.05292997298553134, -0.059196742528857337, -0.14796293671873256, 0.0931722117692311, -0.21501976514053772, 0.09363993001364283, 0.07740200456199878, 0.482747649808088], -46.89491787041318, 5, DynamicHMC.DoubledTurn, 0.9634082534169677, 31), NUTS_Transition{Array{Float64,1},Float64}([1.1301720610526955, 0.26905245388613347, -0.5947909457454239, 0.2146044030740913, -0.13307420054523988, 0.07582600329691808, -0.264157316325233, -0.26862191678555325, 0.10231548356202955, -0.08654510319482575, 0.2267279530035889, -0.05412212461859031, 0.5174972979029654], -48.08583118434237, 5, DynamicHMC.DoubledTurn, 0.9925882601093837, 31), NUTS_Transition{Array{Float64,1},Float64}([0.9492204280852283, 0.2682404972594145, 0.1299349004845068, -0.077506011769063, 0.09992189176330701, 0.3853505159103504, 0.3070310068606191, -0.3472261214500928, 0.2680623948260374, -0.18614527341936982, 0.419736032443172, -0.20099437107754922, 0.5786048669498173], -45.59211288060897, 5, DynamicHMC.DoubledTurn, 0.9655250326383185, 31), NUTS_Transition{Array{Float64,1},Float64}([0.8653587205799282, 0.29020442779506883, 0.19442568137454241, -0.07842099838578162, 0.160656367678222, 0.20892554945289965, 0.3419716966982223, -0.33308105589599946, 0.24065718482603618, -0.2941465883899129, 0.28518955872224677, -0.3498736547625997, 0.6190494757368611], -44.45749602227441, 5, DynamicHMC.DoubledTurn, 0.9969663652418874, 31)], NUTS sampler in 13 dimensions
  stepsize (ϵ) ≈ 0.123
  maximum depth = 10
  Gaussian kinetic energy, √diag(M⁻¹): [0.688930167321227, 0.07681382366250489, 0.20153197179539517, 0.21095744019057794, 0.19531289100066557, 0.18213567646984385, 0.18655879598395375, 0.17564841991810143, 0.1826589175820733, 0.17699368524010675, 0.15370390971464065, 0.25839462809977065, 0.10139163173874693]
)</code></pre><p>We use the transformation to obtain the posterior from the chain.</p><pre><code class="language-julia">posterior = TransformVariables.transform.(Ref(problem_transformation(p)), get_position.(chain));
posterior[1:5]</code></pre><pre><code class="language-none">5-element Array{Array{Float64,1},1}:
 [0.8390110320369838, 0.2953629100588751, 0.015142209489578382, 0.025729496317581126, 0.026976865668593523, 0.10524551552875548, 0.008673466498168067, -0.18016270512473387, 0.026279957095881178, -0.01922968939048697, 0.0956238925690598, -0.09490777979209786, 0.31518484714277595]       
 [1.3051610134179974, 0.24314678280545407, -0.014240429862779794, 0.06323899864424833, 0.03687918821519368, 0.026022301397149752, 0.023823480229773437, 0.09962927299292455, 0.007616741575145321, -0.0023286516780750104, -0.02183164884202901, -0.025068306883904927, 0.19828001145311355]  
 [1.1584426287713647, 0.25424392869483253, 0.04390910890035206, 0.039459465998049906, -0.03689027394197539, 0.06307573337129115, -0.0078016572688544075, -0.08363661386477711, 0.06103162326136479, -0.05629716975364422, 0.046653172680692655, 0.05357219609948755, 0.233196982174594]       
 [0.7938672243047535, 0.3005984178247618, 0.010519839844750953, 0.03428362348075177, -0.026636691583605175, 0.025527132869082286, -0.05498034618024884, -0.03707978952089092, 0.011137777812607778, 0.026673514931534793, 0.028087403207698328, -0.031477988031323595, 0.20181088614358875]   
 [0.8959937545439725, 0.2817816845736662, -0.024533040992968057, -0.06883563532499577, -0.07316549368042917, 0.018412978620964228, 0.02157739806672984, -0.018169509137923465, -0.006601733223356797, -0.048197897847085586, -0.03946429600156483, -0.020268751119429555, 0.20104949019527296]</code></pre><p>Extract the parameter posterior means.</p><pre><code class="language-julia">posterior_β = mean(trans(posterior[i]).β for i in 1:length(posterior))
posterior_α = mean(trans(posterior[i]).α for i in 1:length(posterior))
posterior_σ = mean(trans(posterior[i]).s for i in 1:length(posterior))[1]^2</code></pre><pre><code class="language-none">0.2644788397449111</code></pre><p>Effective sample sizes (of untransformed draws)</p><pre><code class="language-julia">ess = mapslices(effective_sample_size, get_position_matrix(chain); dims = 1)
ess</code></pre><pre><code class="language-none">1×13 Array{Float64,2}:
 692.326  646.65  338.9  692.738  …  364.386  161.888  481.027  21.5727</code></pre><p>NUTS-specific statistics</p><pre><code class="language-julia">NUTS_statistics(chain)</code></pre><pre><code class="language-none">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.97, min/25%/median/75%/max: 0.0 0.98 0.99 1.0 1.0
  termination: AdjacentDivergent =&gt; 0% AdjacentTurn =&gt; 8% DoubledTurn =&gt; 92%
  depth: 2 =&gt; 0% 3 =&gt; 3% 4 =&gt; 13% 5 =&gt; 84% 6 =&gt; 0%
</code></pre><p>CmdStan result</p><pre><code class="language-julia">m_12_6_result = &quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
                            Mean                SD               Naive SE             MCSE            ESS
            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000
           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000
  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000
  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000
  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000
  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080
  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000
  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000
  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000
  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000
  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501
 a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000
sigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461
&quot;;</code></pre><pre><code class="language-none">&quot;\nIterations = 1:1000\nThinning interval = 1\nChains = 1,2,3,4\nSamples per chain = 1000\n\nEmpirical Posterior Estimates:\n                            Mean                SD               Naive SE             MCSE            ESS\n            a          1.076167468  0.7704872560 0.01218247319 0.0210530022 1000.000000\n           bp         0.263056273  0.0823415805 0.00130193470 0.0022645077 1000.000000\n  a_society.1   -0.191723568  0.2421382537 0.00382854195 0.0060563054 1000.000000\n  a_society.2    0.054569029  0.2278506876 0.00360263570 0.0051693148 1000.000000\n  a_society.3   -0.035935050  0.1926364647 0.00304584994 0.0039948433 1000.000000\n  a_society.4    0.334355037  0.1929971201 0.00305155241 0.0063871707  913.029080\n  a_society.5    0.049747513  0.1801287716 0.00284808595 0.0043631095 1000.000000\n  a_society.6   -0.311903245  0.2096126337 0.00331426674 0.0053000536 1000.000000\n  a_society.7    0.148637507  0.1744680594 0.00275858223 0.0047660246 1000.000000\n  a_society.8   -0.164567976  0.1821341074 0.00287979309 0.0034297298 1000.000000\n  a_society.9    0.277066965  0.1758237250 0.00278001719 0.0055844175  991.286501\n a_society.10   -0.094149204  0.2846206232 0.00450024719 0.0080735022 1000.000000\nsigma_society    0.310352849  0.1374834682 0.00217380450 0.0057325226  575.187461\n&quot;</code></pre><p>Show means</p><pre><code class="language-julia">[posterior_β, posterior_α, posterior_σ]</code></pre><pre><code class="language-none">3-element Array{Any,1}:
  [1.1432903976890072, 0.25697591535993286]                                                                                                                                                                               
  [-0.18690064524592334, 0.030430771353075484, -0.04607182776203838, 0.29872527374025215, 0.040348496440871816, -0.29837657747670515, 0.1313218124791589, -0.15878961569838518, 0.25197119551838026, -0.07840337111515937]
 0.2644788397449111                                                                                                                                                                                                       </code></pre><p>End of m12.6d1.jl</p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../m12.6d1/"><span class="direction">Previous</span><span class="title">m12.6d1</span></a><a class="next" href="../../"><span class="direction">Next</span><span class="title">Functions</span></a></footer></article></body></html>
